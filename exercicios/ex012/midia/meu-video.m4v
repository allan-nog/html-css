null,1,null,je)),i.yb(10,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,We)),i.yb(12,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Be)),i.yb(14,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,ze)),i.yb(16,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,Ve)),i.yb(18,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,He)),i.yb(20,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(e()(),i.ib(16777216,null,null,1,null,qe)),i.yb(22,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,5,0,!n.noGutter,n.noGutter);e(t,4,0,i),e(t,7,0,n.createOnHomeEnabled),e(t,10,0,!n.recommendedReact),e(t,12,0,n.recommendedReact),e(t,14,0,n.learningShelfEnabled),e(t,16,0,(n.initialDocsAvailable||n.showZeroExperience)&&!n.edgeworthEnabled),e(t,18,0,n.edgeworthEnabled&&!n.edgeworthReactEnabled&&!n.quickAccessEnabled),e(t,20,0,n.edgeworthEnabled&&n.quickAccessEnabled),e(t,22,0,n.edgeworthEnabled&&n.edgeworthReactEnabled&&!n.quickAccessEnabled)}),(function(e,t){var n=t.component;e(t,0,0,n.sectionLandmarkAriaLabel),e(t,2,0,n.sectionLandmarkAriaLabel)}))}function Qe(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"div",[["class","mru-component"]],null,null,null,null,null)),i.yb(1,278528,null,0,p.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"section--first":0}),(e()(),i.ib(16777216,null,null,1,null,Ge)),i.yb(4,16384,null,0,p.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.firstSection&&(!n.leftNavReact||n.isConsumer));e(t,1,0,"mru-component",i),e(t,4,0,n.initialDocsAvailable||n.showZeroExperience||n.hasRecommendedDocs||n.edgeworthEnabled)}),null)}i.vb("ohp-documents-component",De.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-documents-component",[],null,null,null,Qe,Ue)),i.yb(1,245760,null,0,De.a,[g.a,T.a,x.a,S.a,J.a,U.a,Re.a,me.a,Me.a,xe.a,s.b,s.b,Le.a,w.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{firstSection:"firstSection",fileType:"fileType",headless:"headless",maxInitialDocs:"maxInitialDocs",maxTotalDocs:"maxTotalDocs",isSuggestedActions:"isSuggestedActions"},{mruStateChanged:"mruStateChanged"},[])},R0N1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("/I02");var i=function(){function e(e){this.contextService=e}return e.prototype.ngOnInit=function(){this.target=this.contextService.sharedContext.defaultLinkTarget},e}()},R7NL:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("QjXU"),r=n("9h0M"),o=n("tyUq"),a=n("GMuP"),s=n("ciUQ"),c=n("+2OL"),l=n("Ft/N"),u=n("JWB6"),d=n("3GGT"),p=n("wwmn"),f=n("Uqr9"),h=n("BMb5"),m=n("cgnd"),b=n("/I02"),g=n("hhzZ"),v=n("keVe"),y=n("5MEU"),S=function(){function e(e){this.promise=e}return Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"Promise"},enumerable:!0,configurable:!0}),e.prototype.instrument=function(e){return this.instrumentCallback=e,this},e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.catch=function(e){return this.promise.catch(e)},e.prototype.finally=function(e){return this.promise.finally(e)},e}(),w=function(){function e(e,t,n,i,r,o,a,s,c){this.httpClient=e,this.contextService=t,this.startupConfigService=n,this.instrumentationService=i,this.windowService=r,this.serviceWorkerStateService=a,this.serviceWorkerConfigService=s,this.workloadQueryParameterValue=c,this.officeHomeApiConfig=o.config}return e.prototype.request=function(t,n,i,c,l,u,p,h){var m=this,b=f.a.now(),v=0,y="cache-only"===c,w=new Promise((function(t,n){if(y){var o=m.serviceWorkerConfigService.config.enabled;if(!o||"Controlled"!==m.serviceWorkerStateService.currentState)return void n(e.failedResponseWithCode(d.a.NotImplemented,i,y,"Cache is not available. Service Worker is in "+(o?m.serviceWorkerStateService.currentState:"disabled")+" state"))}m.prepareRequest(i,c);var a={};i.headers&&i.headers.forEach((function(e,t){a[t]=e}));var f=!!l||!!u,b=f?"events":"response",g={headers:new r.i(a),params:new r.j({fromObject:i.params}),method:i.method,reportProgress:f,responseType:i.responseType,observe:b},v=new r.k(i.method,i.url,i.body,g),S=function(e){var t;return e instanceof r.l?t=e.body:e instanceof r.f&&(t=e.error),{data:t,status:e.status,headers:e.headers,config:i,ok:e.ok,statusText:e.statusText,fromCache:y}},w=m.httpClient.request(v).pipe(Object(s.a)(h||m.officeHomeApiConfig.defaultTimeoutInMs)).subscribe((function(e){e instanceof r.l?t(S(e)):e.type===r.g.UploadProgress&&l?l(e):e.type===r.g.DownloadProgress&&u&&u(e)}),(function(t){if("TimeoutError"!==t.name){var r=m.windowService.nativeWindow.navigator;n(!r||"boolean"!=typeof r.onLine||r.onLine?S(t):e.failedResponseWithCode(d.a.Offline,i,y))}else n(e.failedResponseWithCode(d.a.Timeout,i,y))}));p&&p.onCancel((function(){return w.unsubscribe()}))})),C=new S(w),I=function(i){if(!i.fromCache||i.ok||i.status!==d.a.NotImplemented){v=Math.ceil(f.a.now()-b);var r=i.status;null==r&&(r=e.unknownStatusCode);var s,c=i.statusText,l=c;null==c?(s=e.unknownError,l=e.unknownError):s="ok"===c.toLowerCase()?c:new g.d(c);var u={};C.instrumentCallback&&C.instrumentCallback(i,u),u.hasOwnProperty("HttpCode")&&(r=u.HttpCode,delete u.HttpCode),Object(o.a)({eventName:n,error:l,latency:v,fromCache:i.fromCache,httpCode:r}),0!==Object.keys(u).length&&Object(a.a)({eventName:n,params:u}),m.instrumentationService.generateRequestEvent(t,r,v,s,i.fromCache,u).record()}},T=p?p.onCancel((function(){return Promise.resolve(e.failedResponseWithCode(d.a.Cancelled,i,y))})):new Promise((function(){}));return Promise.race([w,T]).then(I,I),C},e.prototype.get=function(e,t,n,r,o,a,s,c){var l=Object(i.__assign)({},r);return l.url=n,l.method="GET",this.request(e,t,l,o,null,a,s,c)},e.prototype.post=function(e,t,n,r,o,a,s,c,l,u){void 0===o&&(o={});var d=Object(i.__assign)({},o);return d.url=n,d.method="POST",d.body=r,this.request(e,t,d,u||"network-only",a,s,c,l)},e.prototype.put=function(e,t,n,r,o,a,s,c,l){void 0===o&&(o={});var u=Object(i.__assign)({},o);return u.url=n,u.method="PUT",u.body=r,this.request(e,t,u,"network-only",a,s,c,l)},e.prototype.delete=function(e,t,n,r,o,a,s){void 0===o&&(o={});var c=Object(i.__assign)({},o);return c.url=n,c.method="DELETE",c.body=r,this.request(e,t,c,"network-only",null,null,a,s)},e.prototype.patch=function(e,t,n,r,o,a,s,c,l){void 0===o&&(o={});var u=Object(i.__assign)({},o);return u.url=n,u.method="PATCH",u.body=r,this.request(e,t,u,"network-only",a,s,c,l)},e.failedResponseWithCode=function(e,t,n,i){return{data:null,status:e,headers:new r.i,config:t,ok:!1,statusText:i||d.a[e],fromCache:n}},e.prototype.prepareRequest=function(e,t){var n=this;if("Controlled"===this.serviceWorkerStateService.currentState&&this.serviceWorkerConfigService.config.enabled&&(e.headers?e.headers.forEach((function(t,i){if(void 0===t){e.headers.set(i,"");var r={ItemCategory:"Malformed Request"};r.Error="Undefined header passed to Service Worker: "+i,n.instrumentationService.logGenericEvent("Unhandled_Exception",r)}})):e.headers=new Map,e.headers.set(l.a,t)),0===e.url.lastIndexOf(this.contextService.sharedContext.officeHomeApiRoot+"/",0)){e.headers||(e.headers=new Map);var i=this.officeHomeApiConfig,r=this.startupConfigService.config;i.correlationIdHeader&&r.sharedClientStartupContext.correlationId&&e.headers.set(i.correlationIdHeader,r.sharedClientStartupContext.correlationId),i.userIdHeader&&r.puid&&e.headers.set(i.userIdHeader,r.puid),i.tenantIdHeader&&r.tenantId&&e.headers.set(i.tenantIdHeader,r.tenantId),i.authTypeHeader&&r.authTypeString&&e.headers.set(i.authTypeHeader,r.authTypeString),i.authVersionHeader&&r.authVersion&&e.headers.set(i.authVersionHeader,r.authVersion),e.params||(e.params={}),i.workloadQueryParameter&&(e.params[i.workloadQueryParameter]=this.workloadQueryParameterValue),r.sharedClientStartupContext.testTraffic&&i.testTrafficHeader&&e.headers.set(i.testTrafficHeader,"1"),!r.sharedClientStartupContext.corpNet&&i.externalTrafficHeader&&e.headers.set(i.externalTrafficHeader,"1"),(i.flightOverridesParamName&&i.flightOverrides||i.featureOverridesParamName&&i.featureOverrides)&&(i.flightOverridesParamName&&i.flightOverrides&&!e.params.hasOwnProperty(i.flightOverridesParamName)&&(e.params[i.flightOverridesParamName]=i.flightOverrides),i.featureOverridesParamName&&i.featureOverrides&&!e.params.hasOwnProperty(i.featureOverridesParamName)&&(e.params[i.featureOverridesParamName]=i.featureOverrides))}},e.unknownError="NotAvailable",e.unknownStatusCode=-1,e.ɵprov=v.cc({factory:function(){return new e(v.dc(r.c),v.dc(b.a),v.dc(m.b),v.dc(g.a),v.dc(h.b),v.dc(p.a),v.dc(u.a),v.dc(c.a),v.dc(y.a))},token:e,providedIn:"root"}),e}()},RJiy:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),s=n("7ma0"),c=n("kpuN"),l=n("wwmn"),u=n("casz"),d=n("ZtId"),p=n("BMb5"),f=n("4/We"),h=n("cgnd"),m=n("/I02"),b=n("9260"),g=n("keVe"),v=n("TOqr"),y=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d,p,f){this.recommendedDataService=new b.a(e,t,n,i,r,o,a,s,c,l,u,d,p,f)}return e.prototype.getRecommendedService=function(){return this.recommendedDataService},e.ɵprov=g.cc({factory:function(){return new e(g.dc(c.b),g.dc(f.a),g.dc(m.a),g.dc(r.a),g.dc(o.a),g.dc(a.a),g.dc(l.a),g.dc(v.q),g.dc(i.b),g.dc(h.b),g.dc(d.a),g.dc(u.a),g.dc(p.b),g.dc(s.a))},token:e,providedIn:"root"}),e}(),S=function(){function e(){}return e.ɵprov=g.cc({factory:function(){return function(e){return e.getRecommendedService()}(g.dc(y))},token:e,providedIn:"root"}),e}()},"RR/o":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return p}));var i,r=n("QjXU"),o=n("kaEK"),a=n("BaAg"),s=n("o2Lt"),c=n("pOWU"),l=n("CVeG"),u=n("oAX+"),d=n("OyI4");!function(e){e[e.Default=0]="Default",e[e.FrequentlyOpen=1]="FrequentlyOpen",e[e.RecentlyOpen=2]="RecentlyOpen",e[e.WeeklyOpen=3]="WeeklyOpen",e[e.SingleEditYou=4]="SingleEditYou",e[e.MultipleEditYouAndOthers=5]="MultipleEditYouAndOthers",e[e.SingleCommentYou=6]="SingleCommentYou",e[e.MultipleCommentYouAndOthers=7]="MultipleCommentYouAndOthers",e[e.CommentReplyYou=8]="CommentReplyYou",e[e.SharedWithMe=9]="SharedWithMe",e[e.EmailAttachment=10]="EmailAttachment",e[e.SingleMentionYou=11]="SingleMentionYou",e[e.MultipleMentionYouAndOthers=12]="MultipleMentionYouAndOthers",e[e.CommentReplyOthers=13]="CommentReplyOthers",e[e.SnoozeExpiry=14]="SnoozeExpiry",e[e.CommentReplyToYou=15]="CommentReplyToYou",e[e.SingleEditOthers=16]="SingleEditOthers",e[e.MultipleEditOthers=17]="MultipleEditOthers",e[e.SingleCommentOthers=18]="SingleCommentOthers",e[e.MultipleCommentOthers=19]="MultipleCommentOthers",e[e.SingleMentionOthers=20]="SingleMentionOthers",e[e.MultipleMentionOthers=21]="MultipleMentionOthers",e[e.Trending=22]="Trending",e[e.Meeting=23]="Meeting",e[e.PeakMoment=24]="PeakMoment",e[e.HighEngagement=25]="HighEngagement",e[e.SingleMentionedYou=26]="SingleMentionedYou",e[e.MultipleMentionedYou=27]="MultipleMentionedYou",e[e.SingleTaskActivityByYou=28]="SingleTaskActivityByYou",e[e.MultipleTaskActivityByYou=29]="MultipleTaskActivityByYou",e[e.SingleTaskActivityByOthers=30]="SingleTaskActivityByOthers",e[e.MultipleTaskActivityByOthers=31]="MultipleTaskActivityByOthers",e[e.SingleTaskActivityYouAssignee=32]="SingleTaskActivityYouAssignee",e[e.MultipleTaskActivityYouAssignee=33]="MultipleTaskActivityYouAssignee",e[e.SingleTaskActivityYouCreator=34]="SingleTaskActivityYouCreator",e[e.MultipleTaskActivityYouCreator=35]="MultipleTaskActivityYouCreator"}(i||(i={}));var p=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m,b,g){var v=e.call(this,t,n,i,r,o,s,c,l,u,"v2/recent",s.config.supportedFileTypes,f)||this;return v.userContextService=a,v.mruConfigService=s,v.performanceService=d,v.updateContentService=p,v.windowService=h,v.capabilitiesService=m,v.urlAuthenticatorService=b,v.deviceDetector=g,v.fetchRequestIndex=0,v.mruDataStreams=new Map,v.windowService=h,v}return Object(r.__extends)(t,e),t.convertMruActivityToActivityDescription=function(e){for(var n=e.badge.message_format,i=null,r=function(){var t=i[1];n=n.replace(i[0],(function(){return"<c"+t+">"+e.badge.users[t].display_name+"</c"+t+">"}))};null!==(i=t.activityRegex.exec(n));)r();return{formatString:n,plainText:l.a.stripTags(n),people:(e.badge.users||[]).map((function(e,t){return{upn:e.upn,tag:"c"+t,name:e.display_name}})),reasonType:t.convertMruReasonTypeToActivityReason(e.badge.type),timestamp:e.badge.timestamp?new Date(e.badge.timestamp):null}},t.convertMruReasonTypeToActivityReason=function(e){switch(e){case i.FrequentlyOpen:case i.RecentlyOpen:case i.WeeklyOpen:return o.a.Open;case i.SingleEditYou:case i.MultipleEditOthers:case i.MultipleEditYouAndOthers:case i.SingleEditOthers:return o.a.Edit;case i.SingleCommentYou:case i.SingleCommentOthers:case i.MultipleCommentOthers:case i.MultipleCommentYouAndOthers:case i.CommentReplyYou:case i.CommentReplyOthers:case i.CommentReplyToYou:return o.a.Comment;case i.SharedWithMe:return o.a.Share;case i.EmailAttachment:return o.a.Attachment;case i.SingleMentionYou:case i.MultipleMentionYouAndOthers:case i.SingleMentionOthers:case i.MultipleMentionOthers:case i.SingleMentionedYou:case i.MultipleMentionedYou:return o.a.Mention;case i.SnoozeExpiry:return o.a.SnoozeExpiry;case i.Trending:case i.PeakMoment:case i.HighEngagement:return o.a.Trending;case i.Meeting:return o.a.Meeting;case i.SingleTaskActivityByYou:case i.MultipleTaskActivityByYou:case i.SingleTaskActivityByOthers:case i.MultipleTaskActivityByOthers:case i.SingleTaskActivityYouAssignee:case i.MultipleTaskActivityYouAssignee:case i.SingleTaskActivityYouCreator:case i.MultipleTaskActivityYouCreator:return o.a.Task;default:return o.a.Default}},t.prototype.getMruDocuments=function(e){var n,i=this,r=this.getUrl(e),o=!(!e||!e.size);if(this.mruDataStreams.has(r))return this.mruDataStreams.get(r);o&&this.mostRecentUnfilteredDocs&&this.mostRecentUnfilteredDocs.items&&(n=this.mostRecentUnfilteredDocs.items.filter((function(t){return e.has(a.a.fileTypeNameToFileType(t.FileType))})));var s=n&&n.length?Promise.resolve({items:n,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!0}):this.fetchMru(r,"cache-only",o),c=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchMru(o,r):this.fetchMru(r,"network-first",o),l=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(r),(function(){return i.fetchMru(r,"network-first",o)})),d=u.a.createResultsWithCacheObservable(s,c,l,(function(e){return i.mruDataStreams.delete(r)}),{items:[],impressionId:t.mruPlusPlusV2ImpressionId,fromCache:!1});if(this.mruDataStreams.set(r,d),this.mruConfigService.config.silentS2SFlow){var p=this.getS2SUrl(e);this.fetchMru(p,"network-only",o,!0)}return d},t.prototype.updateMruDocuments=function(e){return this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e)))},t.prototype.removeDocument=function(e){var t=this;return new Promise((function(n,i){t.delete("Mru_Delete","Mru_Delete",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url},(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.updatePinnedState=function(e){var t=this;return new Promise((function(n,i){t.post("Mru_Update_Pin","Mru_Update_Pin",t.serviceBaseUrl,{category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,is_pinned:e.IsPinned},(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.writeMruDocument=function(e){var t=this;return new Promise((function(n,i){var r={category:e.Category,type:e.MruV2Type,app:e.Application,mru_id:e.MruId,url:e.Url,extension:a.a.getFileExtensionFromUrl(e.Url),title:e.Title,onedrive_info:{drive_id:e.DriveId,item_id:e.DocId}};t.post("Mru_Write","Mru_Write",t.serviceBaseUrl,r,(function(e){e.instrument((function(e,n){n.RequestId=t.getRequestIdFromResponse(e)})).then((function(){return n(null)}))}),i,t.getNewRequestConfig(!0))}))},t.prototype.handleQueryParam=function(e,t,n){"mockmru"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.isAuthError=function(t){return e.prototype.isAuthError.call(this,t,"MruPlusPlus")||-1===t},t.isPwaProject=function(e){return e.meta_data&&"PJO"===e.meta_data.type&&e.app.toLowerCase()===a.b[a.b.Project].toLowerCase()},t.fileType=function(e){var t=a.a.fileTypeFromExtension(e.extension);return t&&t!==a.b.None||(t="Project"===e.app&&e.meta_data&&"ProjectOperations"===e.meta_data.type?a.b.ProjectOperations:a.a.fileTypeNameToFileType(e.app)),t},t.prototype.getUrl=function(e){if(this.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow)return this.getS2SUrl(e);var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.serviceBaseUrl+"/docs?"+t},t.prototype.getS2SUrl=function(e){var t=this.requestParams(this.mruConfigService.config.mruNumItemsToRequest,e);return this.contextService.sharedContext.officeHomeApiRoot+"/api/mru?"+t},t.prototype.getUpdateStreamKey=function(e){return"mruplusplusv2-"+e},t.prototype.fetchMru=function(e,n,i,r){var o=this;return void 0===r&&(r=!1),new Promise((function(s,l){var u,d,p,f;o.userContextService.user.mruAvailable?(o.startupConfigService.config.sharedClientStartupContext.useMruS2SFlow||r?(u="None",d={},p="Mru_S2S_Request",f="Mru_S2S"):(u="MruPlusPlus",d=o.getNewRequestConfig(!1),p="Mru_Request",f="Mru"),o.get(p,f,e,(function(n){n.instrument((function(n,i){i.RequestId=o.getRequestIdFromResponse(n),i.Index=(o.fetchRequestIndex++).toString(),i.ImpressionId=t.mruPlusPlusV2ImpressionId;var r=n.headers;r&&(i.PartnerGeo=r.get("X-OfficeCluster")),n.data&&n.data.diagnostics_data&&void 0!==n.data.diagnostics_data.total_duration&&(i.MruDuration=n.data.diagnostics_data.total_duration.toString());var s=o.performanceService.getResourceTimingEntries(e);if(s&&s.length){var c=s[s.length-1];c.workerStart&&c.responseStart&&(i.ServiceWorkerProcessingLatency=Math.ceil(c.responseStart-c.workerStart).toFixed())}if(n.ok&&n.data){var l=void 0,u=(l=n.data.documents&&n.data.documents.items?n.data.documents.items:[]).length;o.mruConfigService.config.mruPinEnabled&&o.mruConfigService.config.recommendedEnabled&&l.sort((function(e,t){return new Date(t.time_stamp).getTime()-new Date(e.time_stamp).getTime()})),i.ActualSize=u.toString(),i.Distribution=a.a.distributionFromFileTypes(l.map((function(e){return t.fileType(e)}))),i.MruPlusPlusV2MetaDataDistribution=l.map((function(e){return o.checkMetaData(e)?1:0})).toString(),o.mruConfigService.config.recommendedEnabled&&(i.ResourceIdDistribution=l.slice(0,12).map((function(e){return e.resource_id})).toString())}})).then((function(e){var t=e.data,n=e.fromCache;if(r)s();else{var a=o.processMruData(t,i,n);s(a)}})).catch((function(e){o.globalErrorHandler.handleError(e,"hJU2J")}))}),l,d,n,null,null,null,u)):l(new c.b(null,"User does not have an MRU"))}))},t.prototype.prefetchMru=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchMruDataPromise?new Promise((function(t){n.windowService.nativeWindow.prefetchMruDataPromise.then((function(i){var r=n.processMruData(i,e,!1);t(r)})).catch((function(e){n.globalErrorHandler.handleError(e,"hJU2J")}))})):this.fetchMru(t,"network-first",e)},t.prototype.checkMetaData=function(e){return e.onedrive_info&&!!e.onedrive_info.drive_id&&!!e.onedrive_info.item_id&&e.creation_info&&!!e.creation_info.timestamp&&e.sharepoint_info&&!!e.sharepoint_info.site_url},t.prototype.mruItemFromMruPlusPlusV2Item=function(e){var n=this.mruConfigService.config,i=new Date(e.time_stamp),r=n.swayTransformedFromWordAttributionEnabled;e.onedrive_info=e.onedrive_info||{},e.sharepoint_info=e.sharepoint_info||{},e.creation_info=e.creation_info||{},e.meta_data=e.meta_data||{};var o={DriveId:e.onedrive_info.drive_id,ItemId:e.onedrive_info.item_id,CreatedByUserEmail:e.creation_info.user_info&&e.creation_info.user_info.upn,CreatedByUserName:e.creation_info.user_info&&e.creation_info.user_info.display_name,CreatedDate:e.creation_info.timestamp,SPListId:e.sharepoint_info.list_id,SPListItemUniqueId:e.sharepoint_info.list_item_unique_id,SPSiteId:e.sharepoint_info.site_id,SPSiteUrl:e.sharepoint_info.site_url,SPWebId:e.sharepoint_info.web_id,SwayMetaData:{ThumbnailId:e.meta_data.SwayThumbnail,IsTransformedFromWord:r&&!!e.meta_data.SwayIsTransformedFromWord&&"true"===e.meta_data.SwayIsTransformedFromWord.toString().toLowerCase()},FormsMetaData:{category:e.meta_data.category,form_type:e.meta_data.form_type,owner_id:e.meta_data.owner_id,owner_name:e.meta_data.owner_name,owner_tenant_id:e.meta_data.owner_tenant_id,owner_type:e.meta_data.owner_type,primary_color:e.meta_data.primary_color,background_image:e.meta_data.background_image},PowerBIMetaData:{breadcrumb_url:e.meta_data.breadcrumb_url}},s=n.mruActivityEnabled,c=e.service_info?e.service_info.friendly_service_name:"";c&&(e.display_path=e.display_path||[],e.display_path.unshift(c));var l=!1,u=t.fileType(e);return u!==a.b.MeetingNotes&&u!==a.b.Whiteboard||(l=!0),{DocId:o.ItemId,DriveId:o.DriveId,Extension:e.extension,FileName:e.title,Title:e.title,Url:l?e.web_url:e.url,WebUrl:e.web_url,LastAccessedTime:i,FileType:a.b[u],Provenance:a.f[a.f.OfficeMru],PathArray:e.display_path,IsPinned:e.is_pinned,Application:e.app,ResourceId:e.resource_id,Category:e.category,MruV2Type:e.type,MruId:e.mru_id,UrlAlreadyEncoded:!0,MetaData:o,Activity:e.activity_info&&s?t.convertMruActivityToActivityDescription(e.activity_info):void 0,Sharing:e.sharing_info&&s?e.sharing_info.state:void 0,LifecycleInfo:e.lifecycle_info&&s?!!e.lifecycle_info.flags:void 0,ServiceId:e.service_info?e.service_info.service_id:"",ServerDocId:e.server_doc_id}},t.prototype.convertToMruData=function(e,n){var i=this;void 0===n&&(n=!1);var r=(e.documents&&e.documents.items?e.documents.items:[]).filter((function(e){return("Sway"===e.app||"Portfolio"===e.app||"Project"===e.app||"Forms"===e.app||"Bohemia"===e.app||"Fluid"===e.app||"PowerBI"===e.app||-1===e.url.lastIndexOf("?"))&&!t.isPwaProject(e)})).map((function(e){return i.mruItemFromMruPlusPlusV2Item(e)})),o=this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice();return r.forEach((function(e){a.b[e.FileType]===a.b.Forms&&(e.Url=i.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.Url),o&&(e.Url=e.Url.replace(s.b,s.a)))})),r=r.filter((function(e){var t,n,i;return a.b[e.FileType]!==a.b.Forms||"survey"!==(null===(i=null===(n=null===(t=e.MetaData)||void 0===t?void 0:t.FormsMetaData)||void 0===n?void 0:n.form_type)||void 0===i?void 0:i.toLowerCase())})),this.mruConfigService.config.mruPinEnabled&&r.sort((function(e,t){return t.LastAccessedTime.getTime()-e.LastAccessedTime.getTime()})),{items:r,impressionId:t.mruPlusPlusV2ImpressionId,fromCache:n}},t.prototype.processMruData=function(e,t,n){void 0===n&&(n=!1);var i=this.convertToMruData(e,n);return t||(this.mostRecentUnfilteredDocs=i),i},t.mruPlusPlusV2ImpressionId="MruPlusPlusV2Impression",t.activityRegex=new RegExp("{([0-9]+)}"),t}(d.a)},RitX:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var i=n("keVe"),r=n("TOqr"),o=n("mu6k"),a=n("W3Zz"),s=n("hZW2"),c=n("PBJH"),l=n("BMb5"),u=i.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"openAndClose",definitions:[{type:1,expr:"* => openMobile",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{transform:"translate3d(0, 100%, 0)"},offset:null},{type:4,styles:{type:6,styles:{transform:"translate3d(0, 0, 0)"},offset:null},timings:"{{ slideDuration }} cubic-bezier(0.1, 0.9, 0.2, 1)"}],options:{params:{slideDuration:"300ms"}}},options:null},options:null},{type:1,expr:"* => open",animation:[{type:6,styles:{height:0},offset:null},{type:4,styles:{type:6,styles:{height:"*"},offset:null},timings:"300ms cubic-bezier(.1,.9,.2,1)"}],options:null},{type:1,expr:"open => closing",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function d(e){return i.bc(0,[(e()(),i.ib(0,null,null,0))],null,null)}function p(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),i.ib(16777216,null,null,2,null,d)),i.yb(2,540672,null,0,r.o,[i.O],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),i.Rb(3,{item:0,index:1}),(e()(),i.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,3,0,t.parent.context.$implicit,t.parent.context.index);e(t,2,0,i,n.menuItemTemplate)}),null)}function f(e){return i.bc(0,[(e()(),i.zb(0,0,[[2,0],["menuItem",1]],null,4,"li",[["tabindex","-1"]],[[8,"id",0],[1,"aria-label",0],[1,"aria-describedby",0],[1,"role",0],[1,"data-clicklog",0],[1,"data-area",0],[1,"aria-posinset",0],[1,"aria-setsize",0],[1,"aria-selected",0],[1,"aria-checked",0]],[[null,"click"],[null,"mouseenter"],[null,"keydown"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.onSelectItem(e.context.$implicit,e.context.index,n)&&i),"mouseenter"===t&&(i=!1!==r.setActiveIndex(e.context.index)&&i),"keydown"===t&&(i=!1!==r.handleKey(n)&&i),i}),null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"menu-item--mobile":0}),(e()(),i.ib(16777216,null,null,1,null,p)),i.yb(4,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=i.Gb(1,"menu-item ms-bgc-g40-h ms-bgc-w ms-bgc-g40-f ms-bgc-g40-a ",t.context.$implicit.cssClass,""),o=e(t,2,0,n.mobileMenu);e(t,1,0,r,o),e(t,4,0,n.menuItemTemplate)}),(function(e,t){var n=t.component;e(t,0,0,n.getIdForItem(t.context.$implicit),t.context.$implicit.ariaLabel,t.context.$implicit.ariaDescribedBy,n.ariaRole,n.menuModel.customLogging?"custom":"",n.menuModel.customLogging?"":n.menuModel.hostComponentArea,t.context.index+1,n.menuModel.items.length,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaSelected,n.menuModel.announceItemIsSelected&&t.context.$implicit.ariaChecked)}))}function h(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,"div",[],[[1,"aria-label",0],[24,"@openAndClose",0]],[[null,"@openAndClose.done"]],(function(e,t,n){var i=!0;return"@openAndClose.done"===t&&(i=!1!==e.component.onAnimationCompleted(n)&&i),i}),null,null)),i.yb(1,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),i.Rb(2,{"menu--right":0,"menu--center":1,"menu--bottom":2,"context-menu--mobile":3}),(e()(),i.zb(3,0,null,null,2,"ul",[["aria-haspopup","true"],["class","officeHome-callout-main menu__content ms-bgc-w"]],[[8,"id",0],[1,"role",0],[1,"aria-label",0]],null,null,null,null)),(e()(),i.ib(16777216,null,null,1,null,f)),i.yb(5,278528,null,0,r.j,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,r=i.Gb(1,"menu officeHome-callout ",n.menuModel.cssClass,""),o=e(t,2,0,n.menuModel.rightAligned&&!n.leftAlignedCard,n.menuModel.centerAligned,n.menuModel.bottomAligned,n.mobileMenu);e(t,1,0,r,o),e(t,5,0,n.menuModel.items,n.trackById)}),(function(e,t){var n=t.component;e(t,0,0,n.menuAriaLabel,n.animationState),e(t,3,0,i.Gb(1,"",n.menuModel.id,"-dropdown"),"menuitemcheckbox"===n.ariaRole||"radio"===n.ariaRole?"menu":"listbox",n.menuAriaLabel)}))}function m(e){return i.bc(0,[i.Ub(671088640,1,{menuWrapper:0}),i.Ub(671088640,2,{dropdownItems:1}),(e()(),i.ib(16777216,null,null,1,null,h)),i.yb(3,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.open)}),null)}i.vb("ohp-menu",o.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,2,"ohp-menu",[],null,null,null,m,u)),i.yb(1,4440064,null,1,o.a,[a.b,s.a,i.h,c.a,i.D,i.l,l.b],null,null),i.Ub(603979776,1,{menuItems:1})],(function(e,t){e(t,1,0)}),null)}),{menuModel:"menuModel",animateClose:"animateClose",mobileMenu:"mobileMenu",leftAlignedCard:"leftAlignedCard",multiSelect:"multiSelect",contextAriaLabel:"contextAriaLabel",ariaRole:"ariaRole",selectedIndex:"selectedIndex"},{selectItem:"selectItem",closeMenu:"closeMenu"},[])},RsrG:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("keVe"),r=function(){function e(){}return e.prototype.getSchedulePriority=function(e){switch(e){case"appbar#AppBarModule":case"app-gallery-angular#AppGalleryModule":case"app-gallery-react#AppGalleryReactModule":case"create-on-home#CreateOnHomeModule":case"edgeworth#EdgeworthModule":case"ew-react#EdgeworthReactModule":case"fluent-theme-provider#FluentThemeProviderModule":case"learning-shelf-react#LearningShelfReactModule":case"left-nav-react#LeftNavReactModule":case"mru#MruModule":case"new-consumer-experience#NewConsumerExperienceModule":case"new-user-shelf#NewUserShelfModule":case"quick-access#QuickAccessReactModule":case"recommended-react#RecommendedReactModule":case"workspace-nav#WorkspaceNavModule":return 0;case"auto-suggest#AutoSuggestModule":case"install#InstallModule":case"create-menu#CreateMenuModule":case"first-run#FirstRunModule":case"places#PlacesModule":case"upload-button#UploadButtonModule":case"welcome-badge#WelcomeBadgeReactModule":return 1;case"upload-dialog#UploadDialogModule":case"banner#BannerModule":case"fluid-content#FluidContentModule":case"wac-content#WacContentModule":return 2;default:return 3}},e.ɵprov=i.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},RtYo:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.ActionContextMenuIcon="ActionContextMenuIcon",e.RenderIcon="RenderIcon",e.Url="Url",e.Svg="Svg",e.Brand="Brand",e}({})},Ry9Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("BaAg"),r=n("QOOv"),o=n("m+UP"),a=n("keVe"),s=function(){function e(e,t){this.mruConfigService=e,this.swayService=t}return e.prototype.getAnalytics=function(t,n){return"cache-only"===n&&!this.mruConfigService.config.analyticsCachingEnabled||t.fileType!==i.b.Sway?Promise.resolve(void 0):this.swayService.getAnalytics(t.url,n).then((function(t){return e.convertFromSwayAnalytics(t)}))},e.prototype.prefetchAnalytics=function(e,t){if(!t||this.mruConfigService.config.analyticsCachingEnabled){var n=e.filter((function(e){return e.fileType===i.b.Sway})).map((function(e){return e.url}));this.swayService.prefetchAnalytics(n,t?"cache-only":"network-first")}},e.convertFromSwayAnalytics=function(e){if(e)return{viewCount:e.viewCount,averageTimeSpentMs:e.averageTimeSpent,averageCompletionRatio:e.AverageScrollDistance,glancedReads:e.glancedReads,quickReads:e.quickReads,deepReads:e.deepReads}},e.ɵprov=a.cc({factory:function(){return new e(a.dc(r.a),a.dc(o.a))},token:e,providedIn:"root"}),e}()},"S8t+":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("ICP0"),r=n("NLr0"),o=n("f0qX"),a=n("2q5z"),s=n("uzn7"),c=n("3XMr"),l=n("keVe"),u=function(){function e(e,t){this.localStorageService=e,this.edgeworthDeltaSyncService=t,this.init()}return e.prototype.getLastUiSyncTimestamp=function(){var t=this.localStorageService.get(e.UiSyncTimestampStorageKeyPrefix);return t?new Date(t):null},e.prototype.setLastUiSyncTimestamp=function(t){this.localStorageService.set(e.UiSyncTimestampStorageKeyPrefix,t.toISOString())},e.prototype.init=function(){var e=this;this.uiTimestamp=Object(i.a)(Object(r.a)(this.getLastUiSyncTimestamp()),this.edgeworthDeltaSyncService.syncTimestampUpdated.pipe(Object(o.a)((function(){return new Date})),Object(a.a)((function(t){e.setLastUiSyncTimestamp(t)}))))},e.UiSyncTimestampStorageKeyPrefix="_Edgeworth"+window.ewWorkload+"LastUiSyncTimestamp",e.ɵprov=l.cc({factory:function(){return new e(l.dc(s.a),l.dc(c.a))},token:e,providedIn:"root"}),e}()},SPVw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("AlWG"),r=n("uzn7"),o=n("keVe"),a=function(){function e(e){this.localStorageService=e,this._callouts=new i.a([]),this.callouts=this._callouts.asObservable()}return e.prototype.addCallout=function(e){e.isValid()&&!this.calloutDismissed(e)&&(!e.completed&&this.calloutCompleted(e)&&(e.completed=!0),this._callouts.next(this._callouts.getValue().concat(e)))},e.prototype.addCallouts=function(e){var t=this,n=e.filter((function(e){return!(!e.isValid()||t.calloutDismissed(e)||(!e.completed&&t.calloutCompleted(e)&&(e.completed=!0),0))}));this._callouts.next(this._callouts.getValue().concat(n))},e.prototype.clearCallouts=function(){this._callouts.next([])},e.prototype.dismissCallout=function(e){e.persistCompletion&&this.localStorageService.set(this.getCompletedKey(e.calloutType),!0),e.persistDismissal&&this.localStorageService.set(this.getDismissKey(e.calloutType),!0)},e.prototype.calloutDismissed=function(e){if(!e.persistDismissal)return!1;var t=this.getDismissKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.calloutCompleted=function(e){if(!e.persistCompletion)return!1;var t=this.getCompletedKey(e.calloutType);return!!this.localStorageService.get(t)},e.prototype.getDismissKey=function(t){return e.calloutDismissedKeyPrefix+"_"+t},e.prototype.getCompletedKey=function(t){return e.calloutCompletedKeyPrefix+"_"+t},e.calloutDismissedKeyPrefix="_FeatureCalloutDismissed",e.calloutCompletedKeyPrefix="_FeatureCalloutCompleted",e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}()},"T/SX":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},T6pR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},TDzr:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var i=n("QjXU"),r=n("3Vsh"),o=n("5ZNw"),a=n("hhzZ"),s=n("R7NL"),c=n("p6Zr"),l=n("H90i"),u=n("JT1q"),d=n("7Rc8"),p=n("fKR7"),f=n("/I02"),h=n("clUe"),m=function(){function e(){}return e.objectToArrayHelper=function(e){return Array.isArray(e)?e:e?[e]:[]},e}(),b=n("uUrA"),g=n("pjz5"),v=n("BaAg"),y=n("4ach"),S=n("cgnd"),w=n("PBJH"),C=function(){function e(){}return e.toHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},e}(),I=n("oAX+"),T=n("ZBli"),k=n("kpuN"),_=n("W3Zz"),A=n("7Gwk"),P=n("zwsB"),E=n("o2Lt"),O=n("Z0U4"),F=n("wwmn"),D=n("casz"),R=n("BJbw"),M=n("pOWU"),x=n("keVe"),L=n("TOqr"),U=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m,b,g){var v=e.call(this,t,i,r,"Forms",o,s,u,d)||this;v.eventService=n,v.locService=a,v.formsConfigService=c,v.officeRouteService=l,v.startupConfigService=p,v.clientStartupConfigService=f,v.urlAuthenticatorService=h,v.deviceDetector=m,v.templatesService=b,v.mruDataService=g,v.getFormsGroupsDataStreamCache=null,v.getMyFormsDataStreamCache=null,v.getSharedFormsDataStreamCache=null,v.getMyFormsResponsesCache=null,v.getFormsThemeMappingSetCache=null,v.getFormDataPromisesCache={},v.getFormsGroupMembersStreamCache={},v.getFormsInGroupDataStreamCache={};var y=v.clientStartupConfigService.config;return v.startupConfigService.config.authType===S.a.MSA?(v.tenantId=v.formsConfigService.config.formsMsaTenantId,v.guid=v.convertConsumerPuidToGuid(y.puid)):(v.tenantId=y.tenantId,v.guid=y.objectId),v}return Object(i.__extends)(t,e),t.prototype.onInitFormsStartPage=function(){this.accessTokenService.getAccessToken("Forms",!1,null,!0,{category:"CreateFile",fileType:v.b.Forms}),this.setFormsCompromisedUserAlert()},t.prototype.getFormsTermsOfServiceUrl=function(){return this.formsConfigService.config.termsOfServiceLinkOrgId},t.prototype.getForm=function(e,n,r,o){var a=this;return!o&&this.getFormDataPromisesCache[e]||(this.getFormDataPromisesCache[e]=new Promise((function(o,s){a.get("Get_Form","Get_Form",a.formsConfigService.config.formsApiPath+t.GET_FORM(a.tenantId,n,r,e),(function(e){e.instrument((function(e,t){t.RequestId=a.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data&&e.data.id){var t=a.getFormUrl(e.data.id);e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.url=t,e.data.ownerPrincipalType=n,e.data.otherInfo&&(e.data.otherInfo=JSON.parse(e.data.otherInfo)),o(e.data)}}))}),s,a.getRequestConfig(),"network-first")}))),this.getFormDataPromisesCache[e]},t.prototype.unpinSharedForm=function(e){var n=this;return new Promise((function(i,r){n.delete("Forms_Shared_UnpinRequest","Forms_Shared_Unpin",n.formsConfigService.config.formsApiPath+t.SHARED_FORM(e),null,(function(e){e.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){i(e.data)}))}),(function(e){r(e)}),n.getRequestConfig())}))},t.prototype.postCopyForm=function(e,n,r,o,a,s,c){var l=this,u=c===y.a.Groups;return new Promise((function(d,p){var f={newOwnerId:a,newTenantId:l.tenantId,isNewOwnerGroup:u,patchProperties:{title:n}},h=function(e){e.instrument((function(e,t){t.RequestId=l.getRequestIdFromResponse(e)})).then((function(e){var t=e.data.otherInfo,n=l.getFormUrl(e.data.id),r=Object(i.__assign)(Object(i.__assign)({},e.data),{otherInfo:JSON.parse(t),url:n});l.clearCache(c,a),m.unsubscribe(),d(r)}))},m=(u?l.getFormsInGroup(a):l.getMyForms()).results.subscribe((function(i){if(!i||!i.fromCache){if(i&&i.value){var a=i.value.filter((function(e){return!e.softDeleted})).map((function(e){return e.title}));f.patchProperties.title=function(e,t){if(-1!==t.indexOf(e)){var n=e+" ",i=1,r=e&&e.match(/([\s\S]+)\(([1-9]\d*)\)$/);for(r&&3===r.length&&(n=r[1],i=parseInt(r[2],10));-1!==t.indexOf(e);)e=n+"("+ ++i+")"}return e}(n,a)}l.post("Forms_Copy_Request","Forms_Copy",l.formsConfigService.config.formsApiPath+t.COPY_FORMS_PATH(r,s,o,e),f,h,(function(e){p(e)}),l.getRequestConfig())}}))}))},t.prototype.createForm=function(e,t,n){var i=this;return new Promise((function(r){r(i.getCreateFormsLink(e,(t||{type:"users"}).identifier,n))}))},t.prototype.createFormFromTemplate=function(e,n,i){var o=this,a=i||this.guid;return new Promise((function(i,s){o.templatesService.getTemplateContent(v.b.Forms,e.AssetId,e.TemplateBinaryUrl).results.pipe(Object(r.a)(1)).subscribe((function(r){o.post("Form_Create_Form_From_Template","Form_Create_Form_From_Template",o.formsConfigService.config.formsApiPath+t.CREATE_FORM_FROM_TEMPLATE(o.tenantId,n,a),r.data.Content.Value,(function(t){t.instrument((function(t,n){n.RequestId=o.getRequestIdFromResponse(t),n.ElementId=e.AssetId})).then((function(e){i(o.getCreateFormFromTemplateLink(e.data.id))}))}),(function(e){s(e)}),o.getRequestConfig(),null,null,null,null,void 0,null,null,null,!0,{category:"CreateFile",fileType:v.b.Forms})}))}))},t.prototype.postMoveForms=function(e,n,i,r,o){var a=this;return new Promise((function(s,c){a.post("Recycle_Form_Request","Recycle_Form",a.formsConfigService.config.formsApiPath+t.MOVE_FORM_PATH(a.tenantId,n,i,e),{isNewOwnerGroup:r===y.a.Groups,newOwnerId:o},(function(e){e.instrument((function(e,t){return t.RequestId=a.getRequestIdFromResponse(e),e})).then((function(e){a.clearCache(n,i),a.clearCache(r,o),s(e.data)}))}),(function(e){c(e)}),a.getRequestConfig())}))},t.prototype.getFormAuthenticatedCdn=function(e){var t=this.clientStartupConfigService.config.sharedClientStartupContext,n="prodprv"===t.deploymentEnvironment&&"scu"===t.geoName,i=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.formsConfigService.config.formsCdnPath+(e?E.c:this.deviceDetector.isMobileDevice()||this.deviceDetector.isTabletDevice()?E.a:E.b));return T.a.appendAndReplaceQueryParams(i,{origin:n?l.b:l.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)},t.prototype.getFormGroupThumbnailUrl=function(e){return this.getImage(this.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUP_THUMBNAIL_PATH(e),"Forms_Group_Thumbnail_Fetch","Forms_Group_Thumbnail_Fetch")},t.prototype.getFormsInGroup=function(e,n){var r=this;if(n&&(this.getFormsInGroupDataStreamCache[e]=null),this.getFormsInGroupDataStreamCache[e])return this.getFormsInGroupDataStreamCache[e];var o=function(n){return new Promise((function(o,a){r.get("Forms_From_Group_Request","Forms_From_Group",r.formsConfigService.config.formsApiPath+t.FORMS_FROM_GROUP(r.tenantId,e),(function(e){e.instrument((function(e,t){t.RequestId=r.getRequestIdFromResponse(e)})).then((function(e){e&&e.data&&e.data.value&&(e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.ownerPrincipalType=y.a.Groups,e.url=r.getFormUrl(e.id)})),o(e.data))}))}),(function(e){a(e)}),r.getRequestConfig(),n)}))},a=o("cache-only"),s=o("network-first"),c=I.a.createResultsWithCacheObservable(a,s,null,(function(t){r.getFormsInGroupDataStreamCache[e]=null}));return this.getFormsInGroupDataStreamCache[e]=c,this.getFormsInGroupDataStreamCache[e]},t.prototype.getFormsGroupMembers=function(e){var n=this;if(this.getFormsGroupMembersStreamCache[e])return this.getFormsGroupMembersStreamCache[e];var i=function(i){return new Promise((function(r,o){n.get("Forms_Group_Members_Request","Forms_Group_Members",n.formsConfigService.config.formsApiPath+t.FORMS_GROUP_MEMBERS(e),(function(e){e.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),i)}))},r=i("cache-only"),o=i("network-first"),a=I.a.createResultsWithCacheObservable(r,o,null,(function(t){return n.getFormsGroupMembersStreamCache[e]=null}));return this.getFormsGroupMembersStreamCache[e]=a,a},t.prototype.getFormsGroups=function(){var e=this;if(this.getFormsGroupsDataStreamCache)return this.getFormsGroupsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Forms_Groups_Request","Forms_Groups",e.formsConfigService.config.formsApiPath+t.MY_FORMS_GROUPS,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(t){e.mruDataService.getMruDocuments(new Set([v.b.Forms])).results.subscribe((function(e){var n=new Map;e.items.forEach((function(e,t){"GroupForm"===e.Extension&&void 0===n[e.MetaData.FormsMetaData.owner_id]&&(n[e.MetaData.FormsMetaData.owner_id]=t)})),t.data.value.sort((function(e,t){return n[e.id]>=0&&n[t.id]>=0?n[e.id]-n[t.id]:n[e.id]>=0?-1:1})),i(t.data)})),e.mruDataService.getMruDocuments(new Set([v.b.Forms])).initialCompletion.then((function(e){e&&e.cacheError&&e.networkError&&i(t.data)}))}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getFormsGroupsDataStreamCache=null}));return this.getFormsGroupsDataStreamCache=o,o},t.prototype.setFormsRecycleState=function(e,n,i,r){var o=this,a=r?"Recycle_Form_Request":"Restore_Form_Request",s=r?"Recycle_Form":"Restore_Form";return new Promise((function(c,l){o.patch(a,s,o.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(o.tenantId,i,n,e),{softDeleted:r?1:0},(function(e){e.instrument((function(e,t){t.RequestId=o.getRequestIdFromResponse(e)})).then((function(){o.clearCache(i,n),c()}))}),(function(e){l(e)}),o.getRequestConfig())}))},t.prototype.hardDeleteForm=function(e,n,i){var r=this;return new Promise((function(o,a){r.delete("Forms_Delete_Request","Forms_Delete",r.formsConfigService.config.formsApiPath+t.FORM_EDIT_OR_DELETE_PATH(r.tenantId,i,n,e),{},(function(e){e.instrument((function(e,t){t.RequestId=r.getRequestIdFromResponse(e)})).then((function(){r.clearCache(i,n),o()}))}),(function(e){a(e)}))}))},t.prototype.getCreateFormsLink=function(e,t,n){var i="Create",r="CreateQuiz",o=function(e,t,n){return"Action="+t+"&Title="+e+(n?"&GroupId="+n:"")},a=this.getFormAuthenticatedCdn(!1),s={Action:null,Fragment:null};if(e===v.b.Forms)s.Fragment=o(this.locService.NewFormsSurveyFileName,i,t),s.Action=i;else{if(e!==v.b.FormsQuiz)return null;a=a.replace(E.a,E.b),s.Fragment=o(this.locService.NewFormsQuizFileName,r,t),s.Action=r}return a=T.a.appendAndReplaceQueryParams(a,s,!0),this.appendQueryInformation(a,!0,n)},t.prototype.getFormUrl=function(e){return this.getFormAuthenticatedCdn(!1)+"#FormId="+e},t.prototype.getAllMyFormsLink=function(){var e=this,t={title:this.locService.AllMyFormsRedirectLabel,tooltip:this.locService.AllMyFormsRedirectTooltip,ariaLabel:this.locService.AllMyFormsRedirectTooltip,referral:c.a.Forms,zeroTitle:this.locService.AllMyFormsRedirectLabel};return this.formsConfigService.config.neoPortalPageEnabled?Object(i.__assign)(Object(i.__assign)({},t),{url:this.urlAuthenticatorService.appendPvrAndUpnAuthParams(this.getFormAuthenticatedCdn(!0))}):Object(i.__assign)(Object(i.__assign)({},t),{onClick:function(){e.officeRouteService.navigateTo({app:v.b.Forms,route:"MyForms"})}})},t.prototype.getCreateFormFromTemplateLink=function(e){var t=this.getFormAuthenticatedCdn(!1);return t=T.a.appendAndReplaceQueryParams(t,{Action:"CreateByTemplate",Fragment:"FormId="+e},!0),this.appendQueryInformation(t,!0)},t.prototype.getFormGroupMemberThumbnailUrl=function(e,n){return this.getImage(this.formsConfigService.config.formsApiPath+t.FORMS_MEMBER_THUMBNAIL_PATH(e,n),"Forms_Members_Thumbnail_Fetch","Forms_Members_Thumbnail_Fetch")},t.prototype.getMyFormsResponses=function(){var e=this;return this.getMyFormsResponsesCache||(this.getMyFormsResponsesCache=new Promise((function(n,i){e.get("Forms_Responses","Forms_Responses",e.formsConfigService.config.formsApiPath+t.FORMS_RESPONSE_COUNT_PATH,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){e&&e.data?n(m.objectToArrayHelper(e.data.value)):i()}))}),i,e.getRequestConfig(),"network-first")}))),this.getMyFormsResponsesCache},t.prototype.getSharedForms=function(){var e=this;if(this.getSharedFormsDataStreamCache)return this.getSharedFormsDataStreamCache;var n=function(n){return new Promise((function(i,r){e.get("Shared_Forms_Request","Shared_Forms",e.formsConfigService.config.formsApiPath+t.SHARED_FORMS_PATH,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(t){t&&t.data&&t.data.value?(t.data.value.sort((function(e,t){return e.modifiedDate===t.modifiedDate?0:e.modifiedDate<t.modifiedDate?1:-1})),t.data.value.forEach((function(t){t.id&&(t.url=e.getFormUrl(t.id),t.ownerPrincipalType=y.b.getOwnerPrincipalTypeToFormType(t.ownerType||t.ownerPrincipalType||t.OwnerPrincipalType))})),i(t.data)):r()}))}),(function(e){r(e)}),e.getRequestConfig(),n)}))},i=n("cache-only"),r=n("network-first"),o=I.a.createResultsWithCacheObservable(i,r,null,(function(t){return e.getSharedFormsDataStreamCache=null}));return this.getSharedFormsDataStreamCache=o,o},t.prototype.setFormsCompromisedUserAlert=function(){var e=this;this.getReputationTierCache||(this.getReputationTierCache=this.getUserReputationTier()),this.getReputationTierCache.then((function(t){t===y.c.Bad&&e.pushFormsAnnouncements("FormsCompromisedUser")}))},t.prototype.pushFormsAnnouncements=function(e,t){var n="announcement-background-color-wrapper--alert",i="announcement-section__title--black announcement-close__button--black";switch(e){case"FormsCompromisedUser":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.FormsCompromisedUserAlertMessage,null,"","",!1,"announcement-background-color-wrapper--error",i,null,null,{text:this.locService.TermsOfUseLink,url:this.getFormsTermsOfServiceUrl(),shouldFocusOnInit:!1})]});break;case"FormsMoveToRecycleBin":var r=this.locService.FormsMoveToRecycleBinMessageNew;r&&this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,r,null,"","",!1,n,i,null,null,null,5)]});break;case"FormsRestored":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.format(this.locService.FormsRestoredMessage,'"'+t+'"'),null,"","",!1,n,i)]});break;case"FormsPermanentlyDeleted":this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a(e,this.locService.format(this.locService.FormsPermanentlyDeletedMessage,'"'+t+'"'),null,"","",!1,n,i)]})}},t.prototype.setFormsCopySuccessAnnouncement=function(e,t,n,i,r){var a,s,c;switch(t){case y.a.Users:s=this.locService.FormsCopyToMyFormsMessage,c=this.locService.AllMyFormsRedirectLabel,a=this.officeRouteService.getUrlForRoute({app:v.b.Forms,route:"MyForms"});break;case y.a.Groups:s=this.locService.FormsCopyToGroupMessage,c=r,a=this.officeRouteService.getUrlForRoute({app:v.b.Forms,route:"GroupForms"},{groupId:i})}this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a("FormsCopied",this.locService.format(s,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,n?{url:a,text:c,shouldFocusOnInit:!0}:null)]})},t.prototype.setFormsMoveToGroupSuccessAnnouncement=function(e,t,n){var i=this.officeRouteService.getUrlForRoute({app:v.b.Forms,route:"GroupForms"},{groupId:t});this.eventService.broadcastEvent({name:"newAnnouncement",args:[new o.a("FormsMoveToGroup",this.locService.format(this.locService.FormsMoveToGroupMessage,'"'+e+'"'),null,"","",!1,"announcement-background-color-wrapper--alert","announcement-section__title--black announcement-close__button--black",null,null,{url:i,text:n,shouldFocusOnInit:!0})]})},t.prototype.getMyForms=function(e){var n=this;if(e&&(this.getMyFormsDataStreamCache=null),this.getMyFormsDataStreamCache)return this.getMyFormsDataStreamCache;var r=function(e){return new Promise((function(r,o){n.get("My_Forms_Request","My_Forms",n.formsConfigService.config.formsApiPath+t.MY_FORMS_PATH,(function(e){e.instrument((function(e,t){t.RequestId=n.getRequestIdFromResponse(e)})).then((function(e){e.data=Object(i.__assign)(Object(i.__assign)({},e.data),{fromCache:e.fromCache}),e&&e.data&&e.data.value&&(e.data.value=m.objectToArrayHelper(e.data.value),e.data.value.forEach((function(e){e.ownerPrincipalType=y.a.Users,e.otherInfo&&(e.otherInfo=JSON.parse(e.otherInfo)),e.url=n.getFormUrl(e.id)})),e.data.value=e.data.value.sort((function(e,t){return new Date(t.modifiedDate).getTime()-new Date(e.modifiedDate).getTime()}))),r(e.data)}))}),(function(e){o(e)}),n.getRequestConfig(),e)}))},o=r("cache-only"),a=r("network-first"),s=I.a.createResultsWithCacheObservable(o,a,null,(function(e){n.getMyFormsDataStreamCache=null}));return this.getMyFormsDataStreamCache=s,this.getMyFormsDataStreamCache},t.prototype.fetchFormThumbnail=function(e){var n=this,i=function(){return n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH:""+n.formsConfigService.config.formsApiPath},r=function(t){return{defaultImage:t+"/Images/Theme/"+n.getFormsDefaultImageName(e.fileName),defaultColor:n.formsConfigService.config.defaultThumbnailColor}},o=function(t){e.thumbnails.backgroundColor=t},a=function(t){e.thumbnails.small=t,e.thumbnails.medium=t,e.thumbnails.large=t,e.thumbnails.recommendedThumbnail=t},s=function(){return new Promise((function(s){var c,l,u=i(),d=r(u),f=e.metaData&&e.metaData.background_image?n.inMockMode?""+u+g.a.getLocation(e.metaData.background_image).path:e.metaData.background_image:d.defaultImage,h=e.metaData&&e.metaData.primary_color?e.metaData.primary_color:d.defaultColor;if(e.format===p.a.Recent)return o(h),a(f),void s();e.thumbnailInfo&&e.thumbnailInfo.thumbnailFillColor&&(h=e.thumbnailInfo.thumbnailFillColor),"Customized Theme"===(null===(c=e.thumbnailInfo)||void 0===c?void 0:c.thumbnailId)&&(null===(l=e.thumbnailInfo)||void 0===l?void 0:l.thumbnailUrl)?(f=e.thumbnailInfo.thumbnailUrl,o(h),a(f),s()):e.thumbnailInfo&&e.thumbnailInfo.thumbnailId?n.getFormsThemingData().then((function(i){var r=i[e.thumbnailInfo.thumbnailId];r&&(r.SecondaryColor&&(h=r.SecondaryColor),r.BackgroundImage&&(f=n.inMockMode?""+location.origin+t.FORMS_THUMBNAIL_MOCK_PATH+r.BackgroundImage:""+n.formsConfigService.config.formsApiPath+r.BackgroundImage)),o(h),a(f),s()})).catch((function(){o(h),a(f),s()})):(o(h),a(f),s())}))};return e.format===p.a.SharedForm?new Promise((function(t){n.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(i){var r=Object(u.b)(i,null,null,null,n.clientStartupConfigService.config.authType,i.fromCache);e.thumbnailInfo=r.thumbnailInfo,s().then(t).catch(t)})).catch((function(){var e=r(i());o(e.defaultColor),a(e.defaultImage),t()}))})):s()},t.prototype.handleQueryParam=function(e,t){"mockformsservicemode"===e&&this.mockRequestHeader&&this.getRequestConfig().headers.set(this.mockRequestHeader,t.toString())},t.prototype.getRequestIdFromResponse=function(e){return this.getHeaderValue(e.headers,"x-correlationid")},t.prototype.getImage=function(e,t,n){var i=this;return new Promise((function(r,o){i.get(t,n,e,(function(e){e.instrument((function(e,t){t.RequestId=i.getRequestIdFromResponse(e)})).then((function(e){if(e&&e.data){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result.toString();e=e.replace("data:image/pjpeg","data:image/jpeg"),r(e)}),!1),t.readAsDataURL(e.data)}}))}),(function(e){o(e)}),{responseType:"blob"},"network-only")}))},t.prototype.appendQueryInformation=function(e,t,n){var i=this.officeRouteService.getCurrentRoute();return T.a.appendAndReplaceQueryParams(e,{route:n||(i&&i.route?i.route:void 0)},t)},t.prototype.getRequestConfig=function(){return{headers:new Map([["Accept","application/json"],["x-ms-form-request-source","ms-startpage"],["x-usersessionid",this.startupConfigService.config.sharedClientStartupContext.sessionId],["x-correlationid",b.a.createGuid()],["x-anchormailbox",this.guid+"@"+this.tenantId]])}},t.prototype.clearCache=function(e,t){switch(e){case y.a.Groups:if(!t)break;this.getFormsInGroupDataStreamCache[t]=null;break;case y.a.Users:this.getMyFormsDataStreamCache=null}},t.prototype.convertConsumerPuidToGuid=function(e){return"00000000-0000-0000-".concat(e.slice(0,4),"-",e.slice(4))},t.prototype.getFormsDefaultImageName=function(e){e=e||"Untitled form";var t=this.formsConfigService.config.defaultImagesAvailable;return"default-"+(Math.abs(C.toHash(e))%t+1)+".png"},t.prototype.getFormsThemingData=function(){var e=this;return this.getFormsThemeMappingSetCache||(this.getFormsThemeMappingSetCache=new Promise((function(n,i){e.get("Forms_Theme_Request","Forms_Theme",e.formsConfigService.config.formsApiPath+""+(e.inMockMode?t.FORMS_THEMES_MOCK:t.FORMS_THEMES),(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){n(e.data)}))}),(function(t){e.getFormsThemeMappingSetCache=null,i(t)}),e.getRequestConfig(),"network-first",null,null,null,"None")}))),this.getFormsThemeMappingSetCache},t.prototype.getUserReputationTier=function(){var e=this;return new Promise((function(n,i){e.get("Get_User_Reputation_Tier","Get_User_Reputation_Tier",e.formsConfigService.config.formsApiPath+t.USER_REPUTATION_TIER_PATH,(function(t){t.instrument((function(t,n){n.RequestId=e.getRequestIdFromResponse(t)})).then((function(e){e&&e.data?n(e.data):i()}))}),(function(e){i(e)}),e.getRequestConfig(),"network-only")}))},t.SHARED_FORMS_PATH=(t.BASE_URL="/formapi/api")+"/me/sharedWithMeForms",t.MY_FORMS_PATH=t.BASE_URL+"/me/light/forms?$select=id,title,modifiedDate,settings,ownerId,ownerTenantId,category,background,otherInfo,softDeleted,status,type&$filter=type+ne+%27survey%27",t.FORMS_RESPONSE_COUNT_PATH=t.BASE_URL+"/light/GetRespCounts()",t.FORMS_THUMBNAIL_MOCK_PATH="/content/mockData/shared/services/mockData/form/thumbnails",t.FORMS_THEMES_MOCK="/Themes",t.FORMS_THEMES="/Themes.json",t.MY_FORMS_GROUPS=t.BASE_URL+"/groups",t.USER_REPUTATION_TIER_PATH=t.BASE_URL+"/userReputationTier",t.GET_FORM=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')?$select=id,rowCount,background,otherInfo,settings,type,category"},t.COPY_FORMS_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/CopyToUser"},t.MOVE_FORM_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms('"+r+"')/MoveForm"},t.FORMS_MEMBER_THUMBNAIL_PATH=function(e,n){return t.BASE_URL+"/groups('"+e+"')/members('"+n+"')/photo/$value"},t.FORMS_GROUP_MEMBERS=function(e){return t.BASE_URL+"/groups('"+e+"')/members"},t.FORM_EDIT_OR_DELETE_PATH=function(e,n,i,r){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/forms('"+r+"')"},t.FORMS_FROM_GROUP=function(e,n){return t.BASE_URL+"/"+e+"/groups/"+n+"/light/forms?$select=id,title,modifiedDate,ownerId,ownerTenantId,softDeleted,category,rowCount,background,otherInfo,type&$filter=type+ne+%27survey%27"},t.MY_FORMS_GROUP_THUMBNAIL_PATH=function(e){return t.BASE_URL+"/groups('"+e+"')/photo/$value"},t.SHARED_FORM=function(e){return t.BASE_URL+"/light/sharedWithMeForms('"+e+"')"},t.CREATE_FORM_FROM_TEMPLATE=function(e,n,i){return t.BASE_URL+"/"+e+"/"+n+"/"+i+"/light/forms"},t.ɵprov=x.cc({factory:function(){return new t(x.dc(k.b),x.dc(A.a),x.dc(a.a),x.dc(s.a),x.dc(f.a),x.dc(w.a),x.dc(F.a),x.dc(P.a),x.dc(O.a),x.dc(L.q),x.dc(D.a),x.dc(S.b),x.dc(S.b),x.dc(R.a),x.dc(_.b),x.dc(h.a),x.dc(d.a))},token:t,providedIn:"root"}),t}(M.a)},TIi1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},TJwc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return e;for(var i=e,r=function(e){var n=new RegExp("\\{"+e+"\\}","gi");i=i.replace(n,(function(){return t[e]}))},o=0;o<t.length;o++)r(o);return i},e.getDuplicateItemName=function(e){var t=e.match(/(.*)\(([0-9]+)\)$/i),n=function(e,t){return e.trim()+" ("+t+")"};return t?n(t[1],parseInt(t[2])+1):n(e,2)},e}()},TfV2:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e[e.Security=0]="Security",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.Full=3]="Full",e}({})},Tqea:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("6ib3");function r(e){switch(e){case i.a.Word:return"Word";case i.a.Excel:return"Excel";case i.a.PowerPoint:return"PowerPoint";case i.a.MeetingNotes:case i.a.OneNote:case i.a.OneNoteClassNoteBook:case i.a.OneNotePage:return"OneNote";case i.a.Pdf:return"PDF";case i.a.Visio:return"Visio";case i.a.Audio:return"Audio";case i.a.Video:return"Video";case i.a.Photos:return"Photos";case i.a.Outlook:return"Outlook";case i.a.Text:return"Text";case i.a.Sway:return"Sway";case i.a.Forms:case i.a.FormsQuiz:return"Forms";case i.a.Project:return"Project";case i.a.ProjectOperations:return"ProjectOperations";case i.a.Portfolio:return"Portfolio";case i.a.NewsArticle:return"NewsArticle";case i.a.Fluid:return"Loop components";case i.a.PowerBI:return"PowerBI";case i.a.StreamsVideo:return"Streams";case i.a.Stream:return"Stream";case i.a.ScreenRecording:return"ScreenRecording";case i.a.UpcomingMeeting:return"UpcomingMeeting";case i.a.List:return"List";case i.a.PlayLists:return"PlayLists";case i.a.PlayList:return"PlayList";case i.a.Spaces:return"Spaces";case i.a.MindMeister:return"MindMeister";case i.a.Monday:return"monday.com";case i.a.Trello:return"Trello";case i.a.Platform:return"Platform";case i.a.Whiteboard:return"Whiteboard";case i.a.MeetingObject:return"MeetingObject";case i.a.ThirdParty:return"Custom";case i.a.MyAnalytics:return"MyAnalytics";default:return"Document"}}},U8M1:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("lrJm"),r=n("4/We"),o=n("cgnd"),a=n("fVt+"),s=n("1LNb"),c=n("Z0U4"),l=n("keVe"),u=function(){function e(e,t,n,i,r,a){var s=this;this.capabilitiesService=e,this.clientStartupConfigService=t,this.feedbackService=n,this.officeRouteService=i,this.userConsentConfigService=r,this.globalErrorHandler=a,this.userConsentConfigPromise=null,this.capabilitiesService.capabilities.showFloodgate&&(this.capabilitiesService.capabilities.userConsentCallEnabled&&this.clientStartupConfigService.config.authType===o.a.MSA&&!this.userConsentConfigPromise&&(this.userConsentConfigPromise=this.userConsentConfigService.getConfig()),this.floodgateInitPromise=this.feedbackService.feedbackServiceInitializePromise.then((function(){return new Promise((function(e,t){var n=function(t){var n=s.feedbackService.getOCVTelemetryData(t.toString());OfficeBrowserFeedback.initOptions.applicationGroup=n.applicationGroup,OfficeBrowserFeedback.initOptions.telemetryGroup=n.telemetryGroup,OfficeBrowserFeedback.initOptions.webGroup=n.webGroup,OfficeBrowserFeedback.initOptions.appId=s.feedbackService.getOcvAppId(),OfficeBrowserFeedback.floodgate.initOptions&&(s.capabilitiesService.capabilities.adminPolicyEnabled&&(OfficeBrowserFeedback.floodgate.initOptions.surveyEnabled=!!s.feedbackService.OCVAdminPolicy&&s.feedbackService.OCVAdminPolicy.SendSurvey.State,OfficeBrowserFeedback.floodgate.initOptions.showEmailAddress=!!s.feedbackService.OCVAdminPolicy&&s.feedbackService.OCVAdminPolicy.EmailCollection.State),OfficeBrowserFeedback.floodgate.initOptions.onSurveyActivatedCallback={onSurveyActivated:function(e){return s.activateSurvey(e)}}),OfficeBrowserFeedback.floodgate.initialize().then(e)};s.userConsentConfigPromise?s.userConsentConfigPromise.then((function(e){0!==e.userConsent?t():s.feedbackService.addOCVScriptToPage(n)||t()})).catch((function(e){t(),s.globalErrorHandler.handleError(e)})):s.feedbackService.addOCVScriptToPage(n)||t()}))})))}return e.prototype.recordFloodgate=function(e){this.capabilitiesService.capabilities.showFloodgate&&this.floodgateInitPromise.then((function(){OfficeBrowserFeedback.floodgate.start().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.forEach((function(e){return t.logActivity(e)})),OfficeBrowserFeedback.floodgate.stop()}))}))},e.prototype.activateSurvey=function(e){var t=this.officeRouteService.getRouteItemForCurrentLocation().route;!t||"OfficeHome"!==t&&"Search"!==t&&"AppGallery"!==t||e.launch()},e.ɵprov=l.cc({factory:function(){return new e(l.dc(r.a),l.dc(o.b),l.dc(s.a),l.dc(c.a),l.dc(a.a),l.dc(i.b))},token:e,providedIn:"root"}),e}()},Uqr9:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return w}));var i=n("QjXU"),r=n("VV8N"),o=n("Cin9"),a=n("CMIS"),s=n("zvoD"),c=n("3Vsh"),l=n("hhzZ"),u=n("BaAg"),d=n("cgnd"),p=n("MFXD"),f=n("AXqk"),h=n("7Gwk"),m=n("Z0U4"),b=n("re3B"),g=n("BMb5"),v=n("keVe"),y=n("qfyf"),S=function(){function e(){}return e.now=function(){var e=window.performance;return e&&e.now?e.now():(void 0===this.nowOffset&&(this.nowOffset=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-this.nowOffset)},e}(),w=function(){function e(t,n,i,r,o,a,l,u){var d=this;if(this.queuedMarks=t,this.dataSecurityService=n,this.instrumentationService=o,this.windowService=a,this.clientStartupConfigService=l,this.dumpedMeasures=new Set,this.dumpedBrowserMarkers=!1,this.recordedMarkers=new Map,this.recordedMeasures=new Map,this.paramsForAppMeasures=new Map,this.globalStateParamsForBrowserMeasures=null,this._marks=new p.a,this.loggingEnabled=e.performanceLoggingSupported(this.windowService.nativeWindow),this.loggingEnabled){i.events.withScope(0).pipe(Object(s.a)((function(e){return"shellPlusLoaded"===e.name})),Object(c.a)(1)).toPromise().then((function(){setTimeout((function(){return d.log()}),1e3)})),r.addUnloadEvent((function(){d.mark("App_Unloaded",1),d.log()}));var f=function(e){d.currentRoute=e,d.mark("App_Navigation_Start",d.lastRecordedRouteNavigationStartMarker?0:d.windowService.nativeWindow.measureAppFrom||"responseStart")};u.subscribeToRouteChangeStart((function(e){e.currentRoute&&e.currentRoute.route&&f(e.currentRoute)})),u.subscribeToRouteChangeEnd((function(e){e.currentRoute&&e.currentRoute.route&&!d.currentRoute&&f(e.currentRoute),null===d.globalStateParamsForBrowserMeasures&&(d.globalStateParamsForBrowserMeasures={},d.instrumentationService.applyGlobalStateParams(d.globalStateParamsForBrowserMeasures,!0))})),this.drainQueuedMarks()}}return e.performanceLoggingSupported=function(e){var t=e.performance;return!!(t&&t.now&&t.mark&&t.timing&&t.timing.navigationStart&&t.measure&&t.getEntriesByType)},e.getBrowserTimingMeasures=function(t,n,r,o){var a=new Array;if(!e.performanceLoggingSupported(t))return a;for(var s in t.performance.timing){var c=e.globalAllowedMarkers.get(s);if(c){var l=t.performance.timing[s],u=t.performance.timing[c];if("number"==typeof l&&"number"==typeof u)if(0!==l&&0!==u)if(l<u)n(s,"Failed to calculate measure for <"+s+"> starting from <"+c+"> due to relative marker value being greater than marker value: <"+s+">="+l+"; diff from <"+c+">="+(l-u));else if(l<t.performance.timing.navigationStart)n(s,"Failed to calculate measure for <"+s+"> starting from <"+c+"> due to marker value being less than <navigationStart> marker value: <"+s+">="+l+"; diff from <navigationStart}>="+(l-t.performance.timing.navigationStart));else if(u<t.performance.timing.navigationStart)n(s,"Failed to calculate measure for <"+s+"> starting from <"+c+"> due to relative marker value being less than <navigationStart> marker value: <"+s+">="+l+"; <"+c+">="+u+"; diff from <navigationStart}>="+(u-t.performance.timing.navigationStart));else{var d=Math.ceil(l-u);a.push({name:s,duration:d,params:r?Object(i.__assign)({},r):{}});var p=s+"_ohp_measure";o&&o(s,p);try{t.performance.measure(p,c,s)}catch(e){n(s,"Failed to record measure for <"+s+"> starting from <"+c+">: exception is thrown")}}else"unloadEventStart"!==s&&"unloadEventEnd"!==s&&n(s,"Failed to calculate measure for <"+s+"> starting from <"+c+"> due to unexpected zero values: <"+s+">="+l+"; <"+c+">="+u);else n(s,"Failed to calculate measure for <"+s+"> starting from <"+c+"> due to unexpected value type: <"+s+"> value type is "+typeof l+"; <"+c+"> value type is "+typeof u)}}return a},e.prototype.mark=function(e,t,n,i){if(void 0===t&&(t=2),void 0===n&&(n=0),this.loggingEnabled&&!(n>this.dataSecurityService.securityLevel)){var o=e;if(this.currentRoute&&this.currentRoute.route){var a=""+this.currentRoute.route+(this.currentRoute.app?u.b[this.currentRoute.app]:"");Object(r.f)(a),o=e+"_"+a}var s=o;if(this.recordedMarkers.has(s)){var c=this.recordedMarkers.get(s)+1;this.recordedMarkers.set(s,c),s=o+"."+c}else this.recordedMarkers.set(s,1);this.windowService.nativeWindow.performance.mark(s);var l=this.lastRecordedRouteNavigationStartMarker||"navigationStart";"App_Navigation_Start"===e&&(Object(r.g)(s),this.lastRecordedRouteNavigationStartMarker=s);var d="navigationStart";return 2===t?d=l:0===t?d="":"string"==typeof t&&(d=t),this.addMeasure(o,s,d,e,i),this.drainQueuedMarks(),s}},e.prototype.getRecordedMarkerNameBySubstring=function(e){return e?Array.from(this.recordedMarkers.keys()).find((function(t){return t.indexOf(e)>=0})):null},e.prototype.getResourceTimingEntries=function(e){try{return this.windowService.nativeWindow.performance.getEntriesByType("resource").filter((function(t){return t.name.lastIndexOf(e)>=0}))}catch(e){return[]}},Object.defineProperty(e.prototype,"marks",{get:function(){return this._marks.asScopableObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationStart",{get:function(){return this.getPerformanceTimingMember("navigationStart")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchStart",{get:function(){return this.getPerformanceTimingMember("fetchStart")},enumerable:!0,configurable:!0}),e.prototype.getPerformanceTimingMember=function(e){var t=this.windowService.nativeWindow.performance;return t&&t.timing&&t.timing[e]?t.timing[e]:0},e.prototype.drainQueuedMarks=function(){var e=this;this.queuedMarks&&this.queuedMarks.splice(0,this.queuedMarks.length).forEach((function(t){return e.addMeasure(t.markName,t.markName,t.measureFrom||"navigationStart",t.markName,t.eventParams)}))},e.prototype.addMeasure=function(e,t,n,i,r){var o=this.windowService.nativeWindow,a=o.performance.getEntriesByType("mark").find((function(e){return e.name===t}));if(a&&this._marks.next(a),n&&!this.recordedMeasures.has(e)){this.recordedMeasures.set(e,i||e);try{o.performance.measure(e,n,t)}catch(i){return void this.logError(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+n+">: exception is thrown")}this.dumpedBrowserMarkers?(r&&this.paramsForAppMeasures.set(e,r),this.log(e)):(this.instrumentationService.applyGlobalStateParams(r=r||{},!1),this.paramsForAppMeasures.set(e,r))}},e.prototype.log=function(e){var t=this;this.getPerformanceDump(e).forEach((function(e){t.instrumentationService.logPerformanceEvent(e.name,e.duration,e.params),Object(o.a)({eventName:e.name,latency:e.duration})}))},e.prototype.getPerformanceDump=function(e){var t=this,n=new Map;if(!e&&this.dumpedBrowserMarkers)return n;var i,r=this.windowService.nativeWindow;if(e){var o=r.performance.getEntriesByName(e,"measure");if(!o)return n;i=o}else i=r.performance.getEntriesByType("measure").filter((function(e){return!t.dumpedMeasures.has(e.name)&&t.recordedMeasures.has(e.name)}));return i.forEach((function(e){var i=Math.ceil(e.duration),r={};t.paramsForAppMeasures.has(e.name)&&(r=t.paramsForAppMeasures.get(e.name));var o=t.recordedMeasures.get(e.name);n.set(e.name,{name:o,duration:i,params:r}),t.dumpedMeasures.add(e.name)})),e||this.dumpBrowserMarkers(n),n},e.prototype.dumpBrowserMarkers=function(t){var n,r,o=this;if(!this.dumpedBrowserMarkers){var a=this.windowService.nativeWindow;if(this.clientStartupConfigService.config.resourceLoggingEnabled&&this.clientStartupConfigService.config.cdnDomain){var s=new RegExp("https://"+this.clientStartupConfigService.config.cdnDomain+".*","i"),c=a.performance.getEntriesByType("resource").filter((function(e){return s.test(e.name)&&("script"===e.initiatorType||"link"===e.initiatorType)})).filter((function(e){return e.hasOwnProperty("transferSize")?e.transferSize>0:e.responseEnd-e.responseStart>20})),l=void 0,u=0;try{for(var d=Object(i.__values)(c),p=d.next();!p.done;p=d.next()){var f=p.value,h=f.responseEnd;"number"==typeof h&&h>0&&h>u&&(u=h,l=f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(l){var m=l.name.split("/").pop(),b="Last_CDN_Script_Downloaded",g=l.responseEnd,v=null===this.globalStateParamsForBrowserMeasures?{}:Object(i.__assign)({},this.globalStateParamsForBrowserMeasures);v.Filename=m,t.set(b,{name:b,duration:g,params:v}),this.dumpedMeasures.add(b)}}e.getBrowserTimingMeasures(a,(function(e,t){o.logError(e,t)}),this.globalStateParamsForBrowserMeasures,(function(e,t){o.dumpedMeasures.add(t),o.recordedMeasures.set(t,e)})).forEach((function(e){t.set(e.name,e)})),this.dumpedBrowserMarkers=!0}},e.prototype.logError=function(e,t){var n,i=((n={}).Error=e,n.DebugInfo=t,n);this.instrumentationService.logGenericEvent("Performance_Mark_Failure",i),Object(a.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})},e.globalAllowedMarkers=new Map([["fetchStart","navigationStart"],["unloadEventStart","navigationStart"],["unloadEventEnd","unloadEventStart"],["domainLookupEnd","domainLookupStart"],["connectEnd","connectStart"],["requestStart","navigationStart"],["responseStart","requestStart"],["responseEnd","responseStart"],["domLoading","responseStart"],["domInteractive","domLoading"],["domComplete","domLoading"]]),e.ɵprov=v.cc({factory:function(){return new e(v.dc(y.a,8),v.dc(f.a),v.dc(h.a),v.dc(b.a),v.dc(l.a),v.dc(g.b),v.dc(d.b),v.dc(m.a))},token:e,providedIn:"root"}),e}()},V9hE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=i.a.Security),Object(o.b)(e,r.a.GenericDebugCache,a,t,n,!0)}},VKX6:function(e,t,n){"use strict";var i;function r(){var e=window.performance;return e&&e.now?e.now():(void 0===i&&(i=e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now()),Date.now()-i)}n.d(t,"a",(function(){return r}))},VV8N:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return d}));var i=void 0,r=void 0,o=new Map,a=new Map,s=new Set;function c(){return i}function l(e){i=e}function u(){return r}function d(e){r=e}},VY7U:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("PZOQ"),r=n("1Bt+"),o=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[i.a,r.a]}},e}()},VrZ9:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var i=n("keVe"),r=n("TOqr"),o=n("pzhl"),a=n("PkQn"),s=n("4/We"),c=n("MRNN"),l=n("/I02"),u=n("PBJH"),d=n("Z0U4"),p=i.xb({encapsulation:2,styles:[],data:{}});function f(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,5,null,null,null,null,null,null,null)),(e()(),i.zb(1,0,null,null,4,"div",[],null,null,null,null,null)),i.yb(2,278528,null,0,r.i,[i.s,i.t,i.l,i.D],{ngClass:[0,"ngClass"]},null),i.Rb(3,{"back-button":0,"back-button--fluent":1,"ms-u-hiddenMdDown":2}),(e()(),i.zb(4,0,null,null,1,"ohp-icon-font",[["ariaVisible","true"],["dataArea","Hero"],["dataNav","1"],["iconButton","true"],["iconFontName","ArrowLeft"]],null,[[null,"iconClicked"]],(function(e,t,n){var i=!0;return"iconClicked"===t&&(i=!1!==e.component.navigateBack()&&i),i}),o.b,o.a)),i.yb(5,638976,null,0,a.a,[s.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],id:[2,"id"],title:[3,"title"],ariaVisible:[4,"ariaVisible"],ariaLabel:[5,"ariaLabel"],dataArea:[6,"dataArea"],dataNav:[7,"dataNav"],iconButton:[8,"iconButton"],focusOnLoad:[9,"focusOnLoad"]},{iconClicked:"iconClicked"})],(function(e,t){var n=t.component,i=e(t,3,0,!n.fluentRefresh,n.fluentRefresh,n.responsive&&!n.fluentRefresh);e(t,2,0,i),e(t,5,0,"back-button__icon ms-fcl-tp"+(n.fluentRefresh?" back-button__icon--fluent":""),"ArrowLeft",n.elementId,n.backButtonAriaLabel||n.defaultAriaLabel,"true",n.backButtonAriaLabel||n.defaultAriaLabel,"Hero","1","true",n.focusOnLoad)}),null)}function h(e){return i.bc(0,[(e()(),i.ib(16777216,null,null,1,null,f)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.backRoute||n.defaultBackRoute)}),null)}i.vb("ohp-back-button",c.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-back-button",[],null,null,null,h,p)),i.yb(1,245760,null,0,c.a,[s.a,l.a,u.a,d.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{elementId:"elementId",backButtonAriaLabel:"backButtonAriaLabel",defaultBackRoute:"defaultBackRoute",responsive:"responsive",focusOnLoad:"focusOnLoad"},{},[])},Vwd8:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));var i=n("QjXU"),r=n("Dn7E"),o=n("lrJm"),a=n("W3Zz"),s=n("uzn7"),c=n("re3B"),l=n("xoWf"),u=n("cgnd"),d=n("hhzZ"),p=n("keVe"),f=function(){function e(t,n,i,r,o,a,s){var c=this;this.clientStartupConfigService=t,this.localStorageService=n,this.userDataStorageService=o,this.instrumentationService=a,this.globalErrorHandler=s,this.scheduledSavePromise=null,this.pendingFirstTimeMetrics={},this.firstTimeUser=this.userDataStorageService.isFirstUse(),this.firstVisitTimestamp=this.userDataStorageService.getFirstUseTimestamp(),this.bufferingTimeoutInSeconds=r.isMobileDevice()?e.BufferingTimespanInSecondsForMobile:e.BufferingTimespanInSecondsForDesktop,this.localStorageProfileDataKey=".Full_Metrics.v"+e.LocalStorageSchemaVersion,this.fullMetrics=this.localStorageService.get(this.localStorageProfileDataKey),this.fullMetrics&&this.fullMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.fullMetrics.created):this.fullMetrics=e.createEmptySnapshot(),this.onLoadMetrics=this.fullMetrics.metrics,this.localStorageUnsavedDataKey=".Unsaved_Metrics.v"+e.LocalStorageSchemaVersion,this.unsavedMetrics=this.localStorageService.get(this.localStorageUnsavedDataKey),this.unsavedMetrics&&this.unsavedMetrics.metrics?this.firstTimeUser&&(this.firstTimeUser=!1,this.firstVisitTimestamp=this.unsavedMetrics.created):this.unsavedMetrics=null,this.inMemoryProfile={metrics:this.fullMetrics.metrics},this.roamingStorageProfileDataKey="User_Profile.Metrics.v"+e.LocalStorageSchemaVersion,this.loadFromUserStorage(),this.forceImmediateSave=this.firstTimeUser||!!this.unsavedMetrics,i.addUnloadEvent((function(){return c.flush()}))}return e.prototype.incrementMetric=function(t,n){var i=e.createTimestamp();e.applyIncrement(t,i,this.fullMetrics.metrics);var r=this.fullMetrics.metrics[t];r&&1===r.count&&(this.loadingMetricsFromRoamingStorage?this.pendingFirstTimeMetrics[t]=r.firstOccurrence:this.logMetricRecordedForFirstTime(t)),this.unsavedMetrics||(this.unsavedMetrics=e.createEmptySnapshot()),e.applyIncrement(t,i,this.unsavedMetrics.metrics),this.scheduleSave(n)},e.prototype.flush=function(){this.scheduledSavePromise&&this.forceSave()},e.prototype.get=function(){return this.pendingLoad},e.prototype.isFirstVisit=function(){return this.firstTimeUser},e.prototype.getInitialMetric=function(e){return this.onLoadMetrics[e]},e.prototype.doesMetricExist=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.get()];case 1:for(n in i.sent().metrics)if(t?n===e:n.includes(e))return[2,!0];return[2,!1]}}))}))},e.prototype.fullDaysSinceFirstVisit=function(){if(this.firstTimeUser)return 0;if(void 0===this.firstVisitTimestamp||this.firstVisitTimestamp<0)return-1;var t=e.createTimestamp()-this.firstVisitTimestamp;return Math.floor(t/e.MillisecondsInDay)},e.createTimestamp=function(){return Date.now()},e.createEmptySnapshot=function(){return{metrics:{},created:e.createTimestamp(),saved:-1}},e.applyIncrement=function(e,t,n){if(n.hasOwnProperty(e)){var i=n[e];i.count++,i.lastOccurrence=t}else n[e]={count:1,firstOccurrence:t,lastOccurrence:t}},e.mergeMetrics=function(t,n){for(var i in n)e.applyMetric(t,i,n[i])},e.applyMetric=function(e,t,n){if(e.hasOwnProperty(t)){var r=e[t];r.count+=n.count,r.firstOccurrence>n.firstOccurrence&&(r.firstOccurrence=n.firstOccurrence),r.lastOccurrence<n.lastOccurrence&&(r.lastOccurrence=n.lastOccurrence)}else e[t]=Object(i.__assign)({},n)},e.sanitizeMetrics=function(t){if(!t.hasOwnProperty(e.MetricPresentInSetThatHasToBeSanitized))return t;var n={};for(var i in t)if(!(i.indexOf("_Request")>0||i.indexOf("_Impression")>0)){var r=!1;if(i.startsWith("Referral."))r=!0;else if(i.indexOf("_PageView")>0)r=!0;else if(i.indexOf("_Click")>0||i.indexOf("_Toggle")>0){var o=i.split(".");3===o.length&&d.b.hasOwnProperty(o[1])&&(r=!0)}else"Upload_Completed"===i&&(r=!0);r&&(n[i]=t[i])}return n},e.prototype.resetScheduledSave=function(){this.scheduledSavePromise&&(clearTimeout(this.scheduledSaveTimeoutId),this.scheduledSaveTimeoutId=null,this.scheduledSavePromise=null,this.scheduledSaveEstimatedTime=null)},e.prototype.scheduleSave=function(e){var t=this;if(this.forceImmediateSave)return this.forceImmediateSave=!1,void this.forceSave();if(!this.scheduledSavePromise||e&&!(Date.now()+1e3*e>=this.scheduledSaveEstimatedTime)){this.resetScheduledSave();var n=1e3*(e?Math.min(e,this.bufferingTimeoutInSeconds):this.bufferingTimeoutInSeconds);this.scheduledSaveEstimatedTime=Date.now()+n,this.scheduledSavePromise=new Promise((function(e){t.scheduledSaveTimeoutId=setTimeout((function(){t.forceSave(),e()}),n)}))}},e.prototype.forceSave=function(){var t=this;if(this.resetScheduledSave(),this.clientStartupConfigService.config.sanitizeMetrics&&(this.unsavedMetrics&&(this.unsavedMetrics.metrics=e.sanitizeMetrics(this.unsavedMetrics.metrics)),this.fullMetrics.metrics=e.sanitizeMetrics(this.fullMetrics.metrics)),this.fullMetrics.saved=e.createTimestamp(),this.localStorageService.set(this.localStorageProfileDataKey,this.fullMetrics),this.unsavedMetrics&&this.localStorageService.set(this.localStorageUnsavedDataKey,this.unsavedMetrics),this.loadingMetricsFromRoamingStorage)this.scheduleSave();else{var n=this.unsavedMetrics;this.unsavedMetrics=null,this.userDataStorageService.set(this.roamingStorageProfileDataKey,this.fullMetrics).then((function(){t.unsavedMetrics?t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics):t.localStorageService.remove(t.localStorageUnsavedDataKey)})).catch((function(i){t.globalErrorHandler.handleError(i,"SxWjc"),t.unsavedMetrics&&n&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.unsavedMetrics=n,t.unsavedMetrics&&t.localStorageService.set(t.localStorageUnsavedDataKey,t.unsavedMetrics)}))}},e.prototype.loadFromUserStorage=function(){var t=this;this.pendingLoad=new Promise((function(n){t.loadingMetricsFromRoamingStorage=!0,t.userDataStorageService.get(t.roamingStorageProfileDataKey,e.LoadFromUserStorageRemoteAttempts).then((function(n){n&&n.metrics&&(t.unsavedMetrics&&n.saved<t.unsavedMetrics.created&&e.mergeMetrics(n.metrics,t.unsavedMetrics.metrics),t.fullMetrics=n,t.inMemoryProfile.metrics=t.fullMetrics.metrics)})).catch((function(e){t.globalErrorHandler.handleError(e,"QN0a5")})).then((function(){for(var e in t.loadingMetricsFromRoamingStorage=!1,t.pendingFirstTimeMetrics){var i=t.fullMetrics.metrics[e];i&&t.pendingFirstTimeMetrics[e]!==i.firstOccurrence||t.logMetricRecordedForFirstTime(e)}t.pendingFirstTimeMetrics={},n(t.inMemoryProfile)}))}))},e.prototype.logMetricRecordedForFirstTime=function(e){var t={};t.MetricName=e,this.instrumentationService.logGenericEvent("First_Time_Metric",t),Object(r.a)({featureName:"Other",eventName:"First_Time_Metric",params:t})},e.BufferingTimespanInSecondsForDesktop=30,e.BufferingTimespanInSecondsForMobile=5,e.LoadFromUserStorageRemoteAttempts=2,e.LocalStorageSchemaVersion=1,e.MillisecondsInDay=864e5,e.MetricPresentInSetThatHasToBeSanitized="Site_Visit",e.ɵprov=p.cc({factory:function(){return new e(p.dc(u.b),p.dc(s.a),p.dc(c.a),p.dc(a.b),p.dc(l.a),p.dc(d.a),p.dc(o.b))},token:e,providedIn:"root"}),e}(),h=function(){function e(e,t,n,i){this.userProfileService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e=this;if(this.metrics){var t="Generic_Click"===this.streamName&&this.params.Referral?1:void 0;this.metrics.forEach((function(n){return e.userProfileService.incrementMetric(n,t)}))}},e}(),m=function(){function e(e){this.userProfileService=e}return e.prototype.createEvent=function(e,t,n){return new h(this.userProfileService,e,t,n)},e.prototype.flush=function(){this.userProfileService.flush()},e.ɵprov=p.cc({factory:function(){return new e(p.dc(f))},token:e,providedIn:"root"}),e}()},W0EU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},W3Zz:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l}));var i,r,o,a=n("BMb5"),s=n("keVe");!function(e){e[e.PC=0]="PC",e[e.Mac=1]="Mac",e[e.WindowsPhone=2]="WindowsPhone",e[e.iPad=3]="iPad",e[e.iPhone=4]="iPhone",e[e.AndroidPhone=5]="AndroidPhone",e[e.AndroidTablet=6]="AndroidTablet",e[e.Linux=7]="Linux",e[e.Chromebook=8]="Chromebook",e[e.Other=9]="Other"}(i||(i={})),function(e){e[e.IE=0]="IE",e[e.Edge=1]="Edge",e[e.EdgeLegacy=2]="EdgeLegacy",e[e.Chrome=3]="Chrome",e[e.Firefox=4]="Firefox",e[e.Safari=5]="Safari",e[e.PhantomJS=6]="PhantomJS",e[e.Opera=7]="Opera",e[e.WebView=8]="WebView",e[e.Other=9]="Other"}(r||(r={})),function(e){e.Slow2g="Slow2g",e.Standard2g="Standard2g",e.Standard3g="Standard3g",e.Standard4g="Standard4g",e.Unknown="Unknown"}(o||(o={}));var c=function(){function e(e,t,n){this.major=this.normalize(e),this.minor=this.normalize(t),this.build=this.normalize(n)}return e.prototype.compareTo=function(e){return this.major===e.major&&this.minor===e.minor&&this.build===e.build?0:this.major>e.major||this.major===e.major&&this.minor>e.minor||this.major===e.major&&this.minor===e.minor&&this.build>e.build?1:-1},e.prototype.toString=function(){return this.major+"_"+this.minor+"_"+this.build},e.prototype.normalize=function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseInt(e);return isNaN(t)?0:t}return 0},e}(),l=function(){function e(e){this.windowService=e,this.platforms=[{keyword:"Windows NT",platformType:i.PC},{keyword:"Windows XP",platformType:i.PC},{keyword:"Macintosh",platformType:i.Mac},{keyword:"Windows Phone",platformType:i.WindowsPhone,pageName:"windows-phone"},{keyword:"iPad",platformType:i.iPad,pageName:"ipad"},{keyword:"iPhone",platformType:i.iPhone,pageName:"iphone"},{keyword:"Android",platformType:i.AndroidPhone,pageName:"android-phone"},{keyword:"Linux",platformType:i.Linux},{keyword:"CrOS",platformType:i.Chromebook}],this.browsers=[{keyword:"PhantomJS",browserType:r.PhantomJS},{keyword:"Edge",browserType:r.EdgeLegacy},{keyword:"EdgA",browserType:r.Edge},{keyword:"EdgiOS",browserType:r.Edge},{keyword:"Edg",browserType:r.Edge},{keyword:"wv",browserType:r.WebView},{keyword:"MSIE",browserType:r.IE},{keyword:"Trident",browserType:r.IE},{keyword:"OPR",browserType:r.Opera},{keyword:"Chrome",browserType:r.Chrome},{keyword:"CriOS",browserType:r.Chrome},{keyword:"Firefox",browserType:r.Firefox},{keyword:"Safari",browserType:r.Safari}],this.networkTypes=[{keyword:"slow-2g",networkType:o.Slow2g},{keyword:"2g",networkType:o.Standard2g},{keyword:"3g",networkType:o.Standard3g},{keyword:"4g",networkType:o.Standard4g}],this.userAgent=this.windowService.nativeWindow.navigator.userAgent}return e.prototype.getDeviceInfo=function(){if(this.deviceInfo)return this.deviceInfo;var e=this.userAgent.toLowerCase(),t={keyword:"Other",platformType:i.Other};this.platforms.some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),t.platformType===i.AndroidPhone&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:i.AndroidTablet,pageName:"android-tablet"});var n=new c(0,0,0);if(t.platformType===i.Mac)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(this.userAgent)).length>=6&&(n=new c(o[1],o[3],o[5]));else if(t.platformType===i.PC||t.platformType===i.WindowsPhone)-1!==e.indexOf("windows xp")?n=new c(5,1,0):(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(this.userAgent)).length>=5&&(n=new c(o[3],o[4],0));else if(t.platformType===i.iPad||t.platformType===i.iPhone){var o=e.match(/os (\d+)_(\d+)(_(\d+))?/);n=new c(o[1]||0,o[2]||0,o[4]||0)}var a={keyword:"Other",browserType:r.Other};return this.browsers.some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(a=t,!0)})),this.deviceInfo={platform:t,platformVersion:n,browser:a},this.deviceInfo},e.prototype.getNetworkInfo=function(){if(this.networkType)return this.networkType;var e=this.windowService.nativeWindow.navigator.connection,t=e&&e.effectiveType?e.effectiveType:"Unknown",n={keyword:"Unknown",networkType:o.Unknown};return this.networkTypes.some((function(e){return-1!==t.toLowerCase().indexOf(e.keyword)&&(n=e,!0)})),this.networkType=n.networkType,this.networkType},e.prototype.isDesktopDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.PC||e===i.Mac||e===i.Linux||e===i.Chromebook},e.prototype.isMobileDevice=function(){var e=this.getDeviceInfo().platform.platformType;return e===i.iPhone||e===i.AndroidPhone||e===i.WindowsPhone},e.prototype.isTabletDevice=function(e){void 0===e&&(e=null);var t=this.getDeviceInfo().platform.platformType;return null!==e?t===e:t===i.iPad||t===i.AndroidTablet},e.prototype.isUwp=function(){return this.userAgent.toLowerCase().indexOf("msapphost/")>-1&&"undefined"!=typeof Windows},e.prototype.isWebView2=function(){return this.isUwp()&&void 0!==window.Office},e.prototype.isIE11Browser=function(){return this.userAgent.toLowerCase().indexOf("trident/7.0")>-1},e.ɵprov=s.cc({factory:function(){return new e(s.dc(a.b))},token:e,providedIn:"root"}),e}()},W3xQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("dFxn"),r=n("cgnd"),o=n("keVe"),a=function(){function e(e,t){this.config=e.parse("calendarConfig"),this.config&&(this.config.peopleImagesEnabled=this.config.peopleImagesEnabled&&!t.config.automatedTestRunning)}return e.ɵprov=o.cc({factory:function(){return new e(o.dc(i.a),o.dc(r.b))},token:e,providedIn:"root"}),e}()},WDeU:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU");function r(e){for(var t=[],n=0;n<e.length;++n){var i=("00"+e[n].toString(16)).slice(-2);t.push(i)}return t.join("")}var o=n("HZp7"),a=n("YqCH");function s(e,t,n,s,c){return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,u,d;return Object(i.__generator)(this,(function(p){switch(p.label){case 0:return l=[Object(a.a)(e,t,n)],c&&l.push(function(e,t,n,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,o(t+n)];case 1:return a=i.sent(),[4,e.digest({name:"SHA-256"},a)];case 2:return s=i.sent(),[2,r(new Uint8Array(s))]}}))}))}(crypto.subtle,s,e,(function(e){return Object(o.b)(e)}))),[4,Promise.all(l)];case 1:return u=p.sent(),d=s,u.length>1&&(d=u[1]),[2,[u[0],d]]}}))}))}},WFKr:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("CVeG"),r=function(){function e(e,t){this.Finished=e,this.Value=t}return e.Finished=function(t){return new e(!0,t)},e.Unfinished=function(t){return new e(!1,t)},e}(),o=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.Pipeline=e}return e.prototype.Run=function(e){if(!this.Pipeline||0===this.Pipeline.length)return e;for(var t=null,n=0;n<this.Pipeline.length;n++){if((t=this.Pipeline[n](e)).Finished)return t.Value;e=t.Value}return t?t.Value:e},e}(),a=function(){function e(){}return Object.defineProperty(e,"MetacharactersMatch",{get:function(){return/[\\^$*+?.()|[\]{}]/g},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MetacharactersReplacement",{get:function(){return"\\$&"},enumerable:!0,configurable:!0}),e.escape=function(t){return t.replace(e.MetacharactersMatch,e.MetacharactersReplacement)},e}(),s=function(){function e(){}return e.Format=function(t,n,i){return e.FormatWithSeparator(t,e.DefaultSeparator(n),i)},e.FormatWithSeparator=function(t,n,r){var o=[],s=e.FormatterPipeline.Run({PathArray:t,Formatted:"",Separator:n,MaxLength:r||e.DefaultMaxLength}).Formatted;o.push(s);var c=i.a.escapeHtml(n),l=""+e.PathSegmentPostfix+e.PathSegmentPrefix+c+e.PathSegmentPostfix+e.PathSegmentPrefix,u=e.GetRegExp(a.escape(c),"g");return o.push(""+e.PathSegmentPrefix+i.a.escapeHtml(s).replace(u,l)+e.PathSegmentPostfix),o},e.DefaultSeparator=function(t){return t?e.DefaultPathSepRtl:e.DefaultPathSepLtr},e.ZeroElements=function(e){return e.PathArray&&0!==e.PathArray.length?r.Unfinished(e):(e.Formatted="",r.Finished(e))},e.TopTooLong=function(t){var n=t.PathArray[0].trim();return n.length>t.MaxLength?(t.Formatted=n.substr(0,t.MaxLength-1).trim()+e.Ellipsis,r.Finished(t)):r.Unfinished(t)},e.SingleElement=function(e){return 1===e.PathArray.length?(e.Formatted=e.PathArray[0].trim(),r.Finished(e)):r.Unfinished(e)},e.TopTooLongForSingleFollower=function(t){var n=t.PathArray[0].trim();return n.length+t.Separator.length+e.Ellipsis.length>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopTooLongForMultipleFollowers=function(t){var n=t.PathArray[0].trim();return t.PathArray.length>2&&n.length+2*(t.Separator.length+e.Ellipsis.length)>t.MaxLength?(t.Formatted=n,r.Finished(t)):r.Unfinished(t)},e.TopAndBottomTooLongAndOnlyElements=function(t){if(2===t.PathArray.length){var n=t.PathArray[0].trim(),i=t.PathArray[1].trim(),o=n.length+i.length+t.Separator.length+1-t.MaxLength;if(o>1)return t.Formatted=e.Join(n,e.Ellipsis+i.substr(o).trim(),t.Separator),r.Finished(t)}return r.Unfinished(t)},e.TopAndBottomTooLongAndOtherElements=function(t){if(t.PathArray.length>2){var n=t.PathArray[0].trim(),i=t.PathArray[t.PathArray.length-1].trim(),o=n.length+i.length+2*(t.Separator.length+1)-t.MaxLength;if(o>1)return i=i.substr(o).trim(),t.Formatted=e.Join(n,e.Ellipsis,t.Separator),i.length>0&&(t.Formatted=e.Join(t.Formatted,e.Ellipsis+i,t.Separator)),r.Finished(t)}return r.Unfinished(t)},e.MultipleElements=function(t){return t.Formatted=t.PathArray.reduce((function(n,i){return e.Join(n,i,t.Separator)})),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseFirst=function(t){var n=e.GetRegExp(t.Separator+".*?"+t.Separator);return t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),t.Formatted.length<=t.MaxLength?r.Finished(t):r.Unfinished(t)},e.CollapseRemaining=function(t){for(var n=e.GetRegExp(t.Separator+".*?"+t.Separator+".*?"+t.Separator);t.Formatted.length>t.MaxLength;){var i=t.Formatted;if(t.Formatted=t.Formatted.replace(n,t.Separator+e.Ellipsis+t.Separator),i===t.Formatted)break}return r.Finished(t)},e.Join=function(e,t,n){return 0===t.length?e:e.trim()+n+t.trim()},e.GetRegExp=function(t,n){void 0===n&&(n="");var i=t+"/"+n;if(e.RegExpCache.has(i))return e.RegExpCache.get(i);var r=new RegExp(t,n);return e.RegExpCache.set(i,r),r},e.DefaultMaxLength=60,e.DefaultPathSepLtr=" » ",e.DefaultPathSepRtl=" « ",e.Ellipsis="…",e.PathSegmentPrefix='<span dir="auto">',e.PathSegmentPostfix="</span>",e.FormatterPipeline=new o(e.ZeroElements,e.TopTooLong,e.SingleElement,e.TopTooLongForSingleFollower,e.TopTooLongForMultipleFollowers,e.TopAndBottomTooLongAndOnlyElements,e.TopAndBottomTooLongAndOtherElements,e.MultipleElements,e.CollapseFirst,e.CollapseRemaining),e.RegExpCache=new Map,e}()},WJRI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var i=n("keVe"),r=n("TOqr"),o=n("kVgv"),a=i.xb({encapsulation:2,styles:[],data:{}});function s(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"div",[["aria-live","assertive"],["class","title-announcement"],["role","alert"],["tabindex","-1"]],[[1,"aria-label",0]],null,null,null,null)),(e()(),i.Yb(1,null,[" ","\n"]))],null,(function(e,t){var n=t.component;e(t,0,0,n.announcement),e(t,1,0,n.announcement)}))}function c(e){return i.bc(2,[(e()(),i.ib(16777216,null,null,1,null,s)),i.yb(1,16384,null,0,r.k,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.announcement)}),null)}i.vb("ohp-title-announcer",o.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-title-announcer",[],null,null,null,c,a)),i.yb(1,49152,null,0,o.a,[],null,null)],null,null)}),{announcement:"announcement"},{},[])},WLAd:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("hZW2"),r=n("keVe"),o=function(){function e(e){this.documentService=e}return e.prototype.addOnVisibilityChanged=function(e){var t=this.documentService.nativeDocument;t.addEventListener("visibilitychange",(function(){return e(t.visibilityState)}))},e.prototype.getVisibilityState=function(){return this.documentService.nativeDocument.visibilityState},e.prototype.isVisible=function(){return"visible"===this.getVisibilityState()},e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},Wa5Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("kb6k"),o=n("lAHu");function a(e,t,n,a,s,c,l,u,d,p,f){void 0===p&&(p={});var h="cache-only"===f;h&&(d="None");var m=Object(i.__assign)(Object(i.__assign)({},a),{url:n,method:"GET"});return Object(r.a)((function(n){return Object(o.a)(e,t,n,l,u,f,p.populateRequestEvent,p.onUploadProgress,p.onDownloadProgress,p.cancellationToken,p.timeoutInMs)}),e,t,m,s,c,d,p.mockParam,p.resourceUrl,p.rpsHeaderPrefix,p.additionalAuthErrors,p.isRetriableError,p.updateRequestWithAuth,h)}},XQbr:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},XV2T:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t,n){if(this.userId=t||e.unknownUserId,this.nativeStorage=n,this.nativeStorage){var i=this.getUserBasedKey("_"+Math.round(1e6*Math.random()));try{this.nativeStorage.setItem(i,i),this.nativeStorage.removeItem(i)}catch(e){this.nativeStorage=null}}}return e.prototype.get=function(e){return this.getItem(this.getUserBasedKey(e))},e.prototype.set=function(e,t){this.setItem(this.getUserBasedKey(e),t)},e.prototype.remove=function(e){this.removeItem(this.getUserBasedKey(e))},e.prototype.getGlobal=function(e){return this.getItem(e)},e.prototype.setGlobal=function(e,t){this.setItem(e,t)},e.prototype.removeGlobal=function(e){this.removeItem(e)},e.prototype.findKeys=function(e){if(!this.nativeStorage||!e)return null;for(var t=[],n=0;n<this.nativeStorage.length;n++){var i=this.nativeStorage.key(n);i.indexOf(e)>=0&&t.push(i)}return t},e.prototype.getItem=function(e){if(!this.nativeStorage)return null;var t=this.nativeStorage.getItem(e);return"string"==typeof t?JSON.parse(t):void 0},e.prototype.setItem=function(e,t){if(this.nativeStorage)try{var n=void 0===t?void 0:JSON.stringify(t);this.nativeStorage.setItem(e,n)}catch(e){}},e.prototype.removeItem=function(e){this.nativeStorage&&this.nativeStorage.removeItem(e)},e.prototype.getUserBasedKey=function(t){return e.officeHomeStorageKeyPrefix+"-"+this.userId+t},e.officeHomeStorageKeyPrefix="officeHome",e.unknownUserId="Unknown",e}()},Xc4i:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("QjXU"),r=n("2dXW"),o=n("ro+v"),a=n("3Vsh"),s=(n("hhzZ"),n("BaAg")),c=n("jCfB"),l=(n("4/We"),n("cgnd"),n("/I02"),n("idgT"),n("oAX+")),u=n("y9oG"),d=(n("hZW2"),n("Uqr9"),n("Brer")),p=n("EUVs"),f=function(){function e(e,t,n,i,r,o,a,s){this.capabilitiesService=e,this.clientStartupConfigService=t,this.contextService=n,this.documentService=i,this.instrumentationService=r,this.performanceService=o,this.templatesConfigService=a,this.vroomService=s,this.index=0,this.bootstrappersLoaded=new Map,this.bootstrapperDiagnostics=new Map,this.applicationUrls=new Map,this.performanceMarker=new Map}return e.prototype.loadBootstrapper=function(e,t,n,i){var r=this;if(void 0===i&&(i=!1),this.bootstrappersLoaded.has(e))return this.bootstrappersLoaded.get(e);var o=new Promise((function(t,i){r.bootstrapperDiagnostics.set(e,{startTime:Date.now()}),r.documentService.addScriptToPage(e,(function(){r.bootstrapperDiagnostics.get(e).endTime=Date.now(),t()}),i,!1,s.b[n]+"_bootstrapper")}));return i&&this.templatesConfigService.prefetchStaticResources(n),this.bootstrappersLoaded.set(e,o),this.applicationUrls.set(n,{bootstrapperUrl:e,applicationUrl:t}),o},e.prototype.convertMruInflationPromise=function(e,t,n){var i=this;return e.then((function(e){var r=p.a.getDocumentInfoForMruFileItem(e,t);return{fetchDiagnostics:{startTime:n,endTime:Date.now()},wopiHostData:e.wopiData,fetchedDocumentInfo:r.docId&&r.driveId?i.getDocumentInfoWithSharingLink(r):i.getWopiData(r,!1,!1,!0).then((function(e){return e.fetchedDocumentInfo}))}}))},e.prototype.getWopiData=function(e,t,n,r){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Date.now(),s=Object(i.__read)(this.getDriveItemWithWacData(e,t,n),2),c=s[1];return s[0].then((function(t){var n,s,l,u;if(t){var p={startTime:a,endTime:Date.now()},f=d.a.getWopiHostDataFromItem(t),h=Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!==(n=t.webUrl)&&void 0!==n?n:e.docUrl,driveId:null!==(l=null===(s=null==t?void 0:t.parentReference)||void 0===s?void 0:s.driveId)&&void 0!==l?l:e.driveId,docId:null!==(u=null==t?void 0:t.id)&&void 0!==u?u:e.docId}),m=r?o.getDocumentInfoWithSharingLink(h):Promise.resolve(h);return Promise.resolve({wopiHostData:f,fetchDiagnostics:p,fetchedDocumentInfo:m})}return c.then((function(e){return Promise.reject(e)})).catch((function(e){return Promise.reject(e)}))})).catch((function(e){return Promise.reject(e)}))},e.prototype.logPerformanceEventFromClick=function(e,t,n){var i,r,o=null!==(r=this.performanceMarker.get(e))&&void 0!==r?r:{clickTimeMarker:1,instrumentationParams:(i={},i.WacHostEntry=this.contextService.getWdOrigin("DIRECT"),i.ResourceId=this.getCorrelationIdForBootId(e),i.FileFormat=s.a.fileTypeNameFromType(n),i)};this.performanceService.mark(t+"."+e,o.clickTimeMarker,void 0,o.instrumentationParams)},e.prototype.generateCorrelationAndBootId=function(e){var t=null!=e?e:this.index++;return[this.getCorrelationIdForBootId(t),t]},e.prototype.logPerformanceBootStart=function(e,t,n,i){var r,o=((r={}).WacHostEntry=n,r.ResourceId=t,r.FileFormat=s.a.fileTypeNameFromType[i],r),a=this.performanceService.mark("WacContentPerformanceMarker.DocumentLoadStart."+e,0,void 0,o);this.performanceMarker.set(e,{clickTimeMarker:a,instrumentationParams:o})},e.prototype.logBootPerformance=function(e,t,n,i){var r;if(n&&n.documentLoadedTime&&i){var o=((r={}).DebugInfo=JSON.stringify(n),r),a=Object(u.a)(e,t,o);this.instrumentationService.logPerformanceEvent(c.b,n.documentLoadedTime-i,a)}},e.prototype.getDocumentInfoWithSharingLink=function(e){return this.capabilitiesService.capabilities.wacSharingLinkEnabled?this.vroomService.createSharingLink(e.driveId,e.docId).then((function(t){var n;try{n=decodeURIComponent(t)}catch(t){return e}return Object(i.__assign)(Object(i.__assign)({},e),{docUrl:null!=n?n:e.docUrl})})).catch((function(){return e})):Promise.resolve(e)},e.prototype.getCorrelationIdForBootId=function(e){return this.clientStartupConfigService.config.sharedClientStartupContext.correlationId+"."+e},e.prototype.getDriveItemWithWacData=function(e,t,n){var i=this,s=e.docId,c=e.driveId,u=e.docUrl,d=e.fileType,p=t?"editnew":"open",f=c&&s?function(e){return i.vroomService.getItemWithWacData(u,c,s,e,p,n)}:function(e){return i.vroomService.getSharedItemWithoutThumbnail(u,d,null,e,!0,p,n)},h=new r.a;return[(n?Object(o.a)(f("network-only")):l.a.createResultsWithCacheObservable(f("cache-only"),f("network-first"),void 0,(function(e){return h.error(e)})).results).pipe(Object(a.a)(1)).toPromise(),h.toPromise()]},e}()},Y22C:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){this.queuedEvents=[]}return e.prototype.queueEvent=function(e){this.queuedEvents.push(e)},e.prototype.drainQueue=function(){return this.queuedEvents.splice(0,this.queuedEvents.length)},e}()},"Yh/z":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("QjXU"),r=n("8wW2"),o=n("muUJ"),a=n("a3FV"),s=n("CMIS"),c=n("0TX8"),l=n("cy7S"),u=n("oK0o"),d=n("mpo9");function p(e,t,n){var p=this;return new Promise((function(f,h){return Object(i.__awaiter)(p,void 0,void 0,(function(){var p,m,b;return Object(i.__generator)(this,(function(g){switch(g.label){case 0:return Object(d.a)()[e]=Array.isArray(t)?t:Object(i.__assign)({},t),[4,n.getIdentity()];case 1:if(p=g.sent(),n.jwtAuthEnabled&&p.isMsa)return h("User storage does not support roaming"),[2];if(m={headers:{}},!n.inMockMode&&!n.jwtAuthEnabled){if(!(b=u.get("AjaxSessionKey")))return Object(o.a)(a.a.CsrfTokenError),Object(s.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),h("CSRF token missing"),[2];m.headers.AjaxSessionKey=b}return[4,Object(c.a)(m,n.inMockMode,n.workload,n.getIdentity)];case 2:return g.sent(),Object(l.a)(a.a.OfficeHomeStorageWriteRequest,"OfficeHomeStorage_Write",n.officeHomeApiRoot+"/api/userstorage/"+e+"/",t,m,n.jwtAuthEnabled,n.getAccessToken,n.officeHomeApiRoot,n.correlationId,"OfficeHome",{populateRequestEvent:function(t,n){n.ElementId=e}}).then((function(){return f()})).catch((function(t){Object(r.a)().handleError(t,"J7GBR"),h("Failed to update or create value in roaming user data storage for <"+e+"> key.")})),[2]}}))}))}))}},YqCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=n("e3cR"),o=n("obr3"),a=n("H2Bi"),s=new Map;function c(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,u,d,p,f;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(u=s.get(l=e+"."+a.a+"."+t))return[2,u];i.label=1;case 1:return i.trys.push([1,3,,7]),[4,d=Object(r.b)(l,{upgrade:function(e){try{e.deleteObjectStore(a.b)}catch(e){}e.createObjectStore(a.b)},blocking:function(){d.then((function(e){e.close(),s.delete(l)}))},terminated:function(){s.delete(l)}},n)];case 2:return p=i.sent(),s.set(l,d),[2,p];case 3:return(f=i.sent())instanceof DOMException?[4,Object(o.a)(l)]:[3,5];case 4:return i.sent(),[2,c(e,t,n)];case 5:throw new Error("Failed to create database with exception: "+f.toString());case 6:return[3,7];case 7:return[2]}}))}))}},Z0U4:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("QjXU"),r=n("X+PR"),o=n("GMuP"),a=n("AlWG"),s=n("dpyN"),c=n("zvoD"),l=n("hhzZ"),u=n("BaAg"),d=n("4/We"),p=n("ZBli"),f=n("uzn7"),h=n("5aVq"),m=n("BMb5"),b=n("keVe"),g=n("TOqr"),v=function(){function e(t,n,i,r,c,l,u,d,p){var f=this;this.activatedRoute=t,this.capabilitiesService=n,this.instrumentationService=i,this.localStorageService=r,this.locationStrategy=c,this.platformLocation=l,this.router=u,this.windowService=d,this.shellShimService=p;var h=this.windowService.nativeWindow.history;if(this.historyEnabled=!!h&&!!h.go,this.historyEnabled)try{this.lastPoppedState=this.parseState(h.state),this.windowService.nativeWindow.addEventListener("popstate",(function(e){f.lastPoppedState=f.parseState(e.state)}))}catch(e){this.historyEnabled=!1}this.historyEnabled||(this.instrumentationService.logGenericEvent("History_Disabled"),Object(o.a)({eventName:"History_Disabled",params:{}})),this.initialRoute=this.currentRouteFromPath(this.platformLocation.pathname),this._routes=new a.a({currentRoute:this.initialRoute,type:0}),this.routes=this._routes.asObservable().pipe(Object(s.a)((function(t,n){return t.type===n.type&&e.areRoutesEqual(t.currentRoute,n.currentRoute)}))),this.nativeSearchEnabled=this.capabilitiesService.capabilities.nativeSearchInHeaderEnabled}return e.areRoutesEqual=function(e,t){return!(!e||!t||e.route!==t.route)&&("M365Apps"===e.route&&"M365Apps"===t.route?e.appId===t.appId&&e.entityId===t.entityId&&e.subEntityId===t.subEntityId:e.app===t.app)},e.prototype.start=function(){var t=this;this.router.events.pipe(Object(c.a)((function(e){return e instanceof r.e||e instanceof r.d}))).subscribe((function(n){var i=n.url?n.url.split("?")[0]:null,a=t.currentRouteFromPath(i),s={currentRoute:a,type:n instanceof r.e?0:1},c=!t.ignoreNextNavigation&&(!t.currentRouteState||!e.areRoutesEqual(a,t.currentRouteState.routeItem)||t.rewriteInProgress);if(t.isRouteChangeEndEvent(s)){if("eager"===t.router.urlUpdateStrategy&&(t.router.urlUpdateStrategy="deferred"),t.ignoreNextNavigation)return void(t.ignoreNextNavigation=!1);var l={routeItem:a,index:t.historyEnabled?t.windowService.nativeWindow.history.length:-1,backRouteItem:null,backIndex:-1,version:e.officeRouteStateVersion};if(t.lastPoppedState&&e.areRoutesEqual(t.lastPoppedState.routeItem,a))l=t.lastPoppedState;else if(t.historyEnabled&&t.currentRouteState){if(l.index!==t.currentRouteState.index+1){var d={};d.Index=l.index.toString(),a&&(d.State=a.route,d.DocumentType=a.app?u.b[a.app]:""),d.Error=t.versionMismatch?"Version":"Index",d.DebugInfo="new: "+JSON.stringify(l)+", current: "+JSON.stringify(t.currentRouteState)+", previous: "+JSON.stringify(t.previousRouteState),t.instrumentationService.logGenericEvent("Unexpected_History_State",d),Object(o.a)({eventName:"Unexpected_History_State",params:d}),t.previousRouteState||t.currentRouteState.routeItem&&"OfficeHome"===t.currentRouteState.routeItem.route||(t.historyEnabled=!1,l.index=-1)}if(t.historyEnabled){l.index=t.currentRouteState.index+1;var p=e.areRoutesEqual(t.currentRouteState.routeItem,a);l.backRouteItem=p?t.currentRouteState.backRouteItem:t.currentRouteState.routeItem,l.backIndex=p?t.currentRouteState.backIndex:t.currentRouteState.index}}t.updateState(l),t.lastPoppedState=null,t.previousRouteState=t.currentRouteState,t.currentRouteState=l,t.rewriteInProgress=!1,s.previousRoute=t.previousRouteState?t.previousRouteState.routeItem:null,s.backRoute=l.backRouteItem}c&&t._routes.next(s)}))},e.prototype.hasNavigated=function(){return this.router.navigated},e.prototype.back=function(e){if(void 0===e&&(e=null),this.currentRouteState){this.nativeSearchEnabled&&this.currentRouteState.routeItem&&"Search"===this.currentRouteState.routeItem.route&&this.shellShimService.getShellShim().then((function(e){e.Search.SetSearchText("")}));var t=this.currentRouteState.backIndex-this.currentRouteState.index;this.historyEnabled&&this.currentRouteState.backIndex>=0&&t<0?this.windowService.nativeWindow.history.go(t):e?this.navigateTo(e):this.platformLocation.back()}else e&&this.navigateTo(e)},e.prototype.getNavigationUrl=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[e].concat(t),o=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);return this.router.serializeUrl(this.router.createUrlTree(r,{queryParams:o}))},e.prototype.navigateTo=function(e,t,n,r,o){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===o&&(o=!1);var a=this.getCommandsAndParamsForRoute(e,n);if(a){var s=Object(i.__read)(a,2);return this.navigateToInternal(s[0],t,s[1],r,o)}},e.prototype.getUrlForRoute=function(e,t){void 0===t&&(t=null);var n=this.getCommandsAndParamsForRoute(e,t);if(n){var r=Object(i.__read)(n,2),o=r[1],a=r[0].reduce((function(e,t){return e+t.split("/").filter((function(e){return!!e})).join("/")+"/"}),this.platformLocation.protocol+"//"+this.platformLocation.hostname+"/");return p.a.appendQueryParams(a,o)}},e.prototype.updateQueryParams=function(e){var t=this;this.ignoreNextNavigation=!0,this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0}).then((function(){t.ignoreNextNavigation=!1})).catch((function(){t.ignoreNextNavigation=!1}))},e.prototype.navigateToAuxilaryRoute=function(e,t){var n={};n[e]=t?[t]:null,this.ignoreNextNavigation=!0,this.router.navigate([{outlets:n}],{queryParamsHandling:"preserve",skipLocationChange:!0})},e.prototype.redirectAndRewrite=function(e){void 0===e&&(e="/");for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0;var i=[e].concat(t);if(this.capabilitiesService.capabilities.isEmbedMode){var r=i.shift(),o=r.split("/").join("");i.unshift("/Embed/".toLowerCase(),o)}this.router.navigate(i,{queryParamsHandling:"preserve",replaceUrl:!0})},e.prototype.subscribeToRouteChangeStart=function(e){return this.routes.pipe(Object(c.a)(this.isRouteChangeStartEvent)).subscribe(e)},e.prototype.subscribeToRouteChangeEnd=function(e){return this.routes.pipe(Object(c.a)(this.isRouteChangeEndEvent)).subscribe(e)},e.prototype.getRouteChangeStartObservable=function(){return this.routes.pipe(Object(c.a)(this.isRouteChangeStartEvent))},e.prototype.getRouteChangeEndObservable=function(){return this.routes.pipe(Object(c.a)(this.isRouteChangeEndEvent))},e.prototype.isOnRoute=function(e){return this.currentRouteState.routeItem.route===e},e.prototype.getCurrentRoute=function(){return this.currentRouteState?this.currentRouteState.routeItem:null},e.prototype.getCurrentPageForLogging=function(){var e=this.getCurrentRoute();return e?""+(e.app?u.b[e.app]:"")+e.route:"Unknown"},e.prototype.getInitialRoute=function(){return this.initialRoute},e.prototype.getInitialPageForLogging=function(){var e=this.initialRoute;return e?""+(e.app?u.b[e.app]:"")+e.route:"Unknown"},e.prototype.getRouteItemForCurrentLocation=function(){return this.currentRouteFromPath(this.platformLocation.pathname)},e.prototype.isRouteChangeStartEvent=function(e){return 0===e.type},e.prototype.isRouteChangeEndEvent=function(e){return 1===e.type},e.prototype.getCommandsAndParamsForRoute=function(e,t){if(void 0===t&&(t=null),e){var n=Object(i.__assign)({},this.activatedRoute.snapshot.queryParams);"Search"!==e.route&&this.currentRouteState&&this.currentRouteState.routeItem&&("Search"===this.currentRouteState.routeItem.route||"SearchPersonScoped"===this.currentRouteState.routeItem.route)&&(delete n.q,delete n.p,delete n.e,delete n.s,delete n.pp,delete n.refiners,delete n.wm),this.currentRouteState&&this.currentRouteState.routeItem&&"Content"===this.currentRouteState.routeItem.route&&(delete n.item,delete n.drive,delete n.file,delete n.action,delete n.siteUrl,delete n.abpId,delete n.t),t&&(n=Object(i.__assign)(Object(i.__assign)({},n),t));var r=[];switch(e.route){case"AppGallery":r.push("apps");break;case"Search":case"SearchSiteScoped":r.push("search");break;case"SearchPersonScoped":r.push("search/content");break;case"Start":r.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"ModernStart":r.push(this.capabilitiesService.capabilities.modernStartPageRootPath);break;case"Templates":r.push(this.capabilitiesService.capabilities.templatePageRootPath);break;case"Pwa":r.push("pwa");break;case"Create":r.push("create");break;case"Content":case"MyForms":case"GroupForms":r.push(this.capabilitiesService.capabilities.startPageRootPath);break;case"M365Apps":r.push(this.capabilitiesService.capabilities.m365AppsPageRootPath.toLowerCase()),e.appId&&(r.push(e.appId.toLowerCase()),e.entityId&&(r.push(e.entityId),e.subEntityId&&r.push(e.subEntityId)));break;case"ConsumerAllSearch":r.push("search/main");break;case"ConsumerFileSearch":r.push("search/docs");break;case"ConsumerTemplateSearch":r.push("search/templates");break;case"MyContent":r.push("mycontent");break;case"Feed":r.push("feed");break;default:r.push("home")}if(e.app&&r.push(u.b[e.app]),"MyForms"===e.route&&r.push("MyForms"),"GroupForms"===e.route&&r.push("GroupForms"),"Content"===e.route&&r.push(this.capabilitiesService.capabilities.wacHostPagePath.replace("/","")),this.capabilitiesService.capabilities.isEmbedMode){var o=r.shift().split("/").join("");r.unshift("/Embed/",o)}return"M365Apps"===e.route?[r,n]:[r.map((function(e){return e.toLowerCase()})),n]}},e.prototype.currentRouteFromPath=function(e){var t,n;if(!e)return null;var i=e.toLowerCase(),r=null,o=null;if(0===i.indexOf("/embed")&&(i=i.replace("/embed","")),"/"===i||0===i.indexOf("/home"))r=this.capabilitiesService.capabilities.pwaEnabled?"Pwa":"OfficeHome";else if(0===i.indexOf("/apps"))r="AppGallery";else if(0===i.indexOf("/search"))r=this.isSiteScopedSearchRoute(i)?"SearchSiteScoped":this.isPersonScopedSearchRoute(i)?"SearchPersonScoped":"Search";else if(0===i.indexOf("/pwa"))r="Pwa";else{if(0===i.indexOf("/m365apps")){r="M365Apps";var a=e.split("/").filter((function(e){return!!e}));return{route:r,appId:a[1]?a[1].toLowerCase():void 0,entityId:null!==(t=a[2])&&void 0!==t?t:void 0,subEntityId:null!==(n=a[3])&&void 0!==n?n:void 0}}if(0===i.indexOf("/create"))r="Create";else if(0===i.indexOf("/mycontent"))r="MyContent";else if(0===i.indexOf("/feed"))r="Feed";else{var s=0===i.indexOf(this.capabilitiesService.capabilities.templatePageRootPath.toLowerCase()),c=0===i.indexOf(this.capabilitiesService.capabilities.startPageRootPath.toLowerCase()),l=0===i.indexOf(this.capabilitiesService.capabilities.modernStartPageRootPath.toLowerCase()),d=i.indexOf(this.capabilitiesService.capabilities.wacHostPagePath.toLowerCase())>=0&&(c||l),p=i.toLocaleLowerCase().indexOf("/myforms")>=0&&c,f=i.toLocaleLowerCase().indexOf("/groupforms")>=0&&c;if(s||c||l||d||p||f){var h=i.split("/");r=s?"Templates":d?"Content":p?"MyForms":f?"GroupForms":l?"ModernStart":"Start",o=u.a.fileTypeNameToFileType(h[d||p||f?h.length-2:h.length-1])}}}return r?{route:r,app:o}:null},e.prototype.navigateToInternal=function(e,t,n,i,r){return void 0===t&&(t=!1),void 0===n&&(n={}),void 0===r&&(r=!1),t&&(this.currentRouteState=this.previousRouteState,this.rewriteInProgress=!0),i&&e.length&&this.localStorageService.set(i,e[0]),this.router.urlUpdateStrategy=r?"eager":"deferred",this.router.navigate(e,{queryParams:n,replaceUrl:t})},e.prototype.parseState=function(t){var n=t?t.ohpState:null;return n&&n.version!==e.officeRouteStateVersion&&(this.versionMismatch=!0),this.versionMismatch?null:n},e.prototype.updateState=function(e){if(this.historyEnabled){var t=this.windowService.nativeWindow.history.state?Object(i.__assign)({},this.windowService.nativeWindow.history.state):{};t.ohpState=e,this.locationStrategy.replaceState(t,"",this.platformLocation.pathname,this.platformLocation.search+this.platformLocation.hash)}},e.prototype.isSiteScopedSearchRoute=function(e){return e.startsWith("/search/siteall")||e.startsWith("/search/sitenews")||e.startsWith("/search/sitesites")||e.startsWith("/search/sitefiles")||e.startsWith("/search/siteimages")},e.prototype.isPersonScopedSearchRoute=function(e){return e.startsWith("/search/content")||e.startsWith("/search/contact")||e.startsWith("/search/organization")||e.startsWith("/search/calendar")||e.startsWith("/search/office")},e.officeRouteStateVersion=1,e.ɵprov=b.cc({factory:function(){return new e(b.dc(r.a),b.dc(d.a),b.dc(l.a),b.dc(f.a),b.dc(g.h),b.dc(g.q),b.dc(r.n),b.dc(m.b),b.dc(h.a))},token:e,providedIn:"root"}),e}()},ZBSS:function(e,t,n){"use strict";n.d(t,"T",(function(){return i})),n.d(t,"W",(function(){return r})),n.d(t,"ab",(function(){return o})),n.d(t,"x",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"l",(function(){return c})),n.d(t,"X",(function(){return l})),n.d(t,"z",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"v",(function(){return m})),n.d(t,"R",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"n",(function(){return v})),n.d(t,"y",(function(){return y})),n.d(t,"S",(function(){return S})),n.d(t,"t",(function(){return w})),n.d(t,"V",(function(){return C})),n.d(t,"D",(function(){return I})),n.d(t,"w",(function(){return T})),n.d(t,"j",(function(){return k})),n.d(t,"E",(function(){return _})),n.d(t,"F",(function(){return A})),n.d(t,"G",(function(){return P})),n.d(t,"H",(function(){return E})),n.d(t,"I",(function(){return O})),n.d(t,"J",(function(){return F})),n.d(t,"L",(function(){return D})),n.d(t,"M",(function(){return R})),n.d(t,"C",(function(){return M})),n.d(t,"i",(function(){return x})),n.d(t,"Y",(function(){return L})),n.d(t,"A",(function(){return U})),n.d(t,"O",(function(){return N})),n.d(t,"P",(function(){return j})),n.d(t,"Q",(function(){return W})),n.d(t,"K",(function(){return B})),n.d(t,"c",(function(){return z})),n.d(t,"d",(function(){return V})),n.d(t,"b",(function(){return H})),n.d(t,"e",(function(){return q})),n.d(t,"B",(function(){return G})),n.d(t,"q",(function(){return Q})),n.d(t,"u",(function(){return Z})),n.d(t,"r",(function(){return K})),n.d(t,"s",(function(){return X})),n.d(t,"N",(function(){return J})),n.d(t,"f",(function(){return Y})),n.d(t,"o",(function(){return $})),n.d(t,"U",(function(){return ee})),n.d(t,"Z",(function(){return te}));var i="Release",r="RequestOrigin",o="UserSegment",a="EventSchemaVersion",s="BrowserSessionId",c="DeploymentEnvironment",l="Geo",u="Flights",d="EcsRing",p="DeviceType",f="AppWorkload",h="AppWorkloadType",m="EventCategory",b="PageView",g="Action",v="Diagnostic",y="Feature",S="Performance",w="Error",C="Request",I="Impression",T="EventName",k="AudienceGroup",_="IsAdmin",A="IsDynamics",P="IsEdu",E="IsEduFaculty",O="IsEduStudent",F="IsFirstVisit",D="IsIw",R="IsSmb",M="Id",x="Area",L="SubArea",U="FromCache",N="AppName",j="PageName",W="PageType",B="IsIntentional",z="Target",V="TargetId",H="Result",q="Type",G="HttpCode",Q="Error",Z="ErrorType",K="ErrorCategory",X="OccurrenceCount",J="Latency",Y="ActualSize",$="Distribution",ee="RenderSize",te="TotalSize"},ZBli:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("pjz5"),r=function(){function e(){}return e.appendQueryParam=function(t,n,i){if(!t||!n)return t;var r={};return r[n]=i,e.appendQueryParams(t,r)},e.appendQueryParams=function(t,n,i){return t?e.appendQuery(t,e.buildQueryPath(n,i)):t},e.appendQuery=function(e,t){if(!e||!t)return e;var n=i.a.getLocation(e),r=n.port,o=n.search;return n.protocol+"//"+n.hostname+(r?":"+r:"")+n.path+(o?o+"&":"?")+t+n.hash},e.appendAndReplaceQueryParams=function(t,n,r,o){if(!t||!n)return t;var a={},s=i.a.getLocation(t),c=s.protocol,l=s.hostname,u=s.path,d=s.search,p=s.hash;for(var f in"?"===d[0]&&d.substring(1).split("&").forEach((function(e){var t=e.split("=");r?a[decodeURIComponent(t[0])]=decodeURIComponent(t[1]):a[t[0]]=t[1]})),n)a[f]=n[f];return e.appendQueryParams(c+"//"+l+u+p,a,o)},e.appendLoginHint=function(t,n,i){return i?e.appendQueryParam(t,"login_hint",n):t},e.removeQueryParams=function(t,n,r){if(!t||!n)return t;var o={},a=i.a.getLocation(t),s=a.protocol,c=a.hostname,l=a.path,u=a.search,d=a.hash;return"?"===u[0]&&u.substring(1).split("&").forEach((function(e){var t=e.split("="),i=r?decodeURIComponent(t[0]):t[0];n.some((function(e){return e.toLowerCase()===i.toLowerCase()}))||(o[i]=r?decodeURIComponent(t[1]):t[1])})),e.appendQueryParams(s+"//"+c+l+d,o,!1)},e.buildQueryPath=function(e,t){if(!e)return"";var n="";for(var i in e)n=n+(n?"&":"")+i+"="+(t?e[i]?""+e[i]:"":e[i]?""+encodeURIComponent(e[i]):"");return n},e.replacePathAndAddParams=function(t,n,r){var o=r?e.appendAndReplaceQueryParams(t,r,!1):t,a=i.a.getLocation(o),s=a.port;return a.protocol+"//"+a.hostname+(s?":"+s:"")+n+a.search+a.hash},e}()},ZJrL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.parseJsonElementWithId=function(e){var t=document.getElementById(e),n=t&&t.textContent;return n?JSON.parse(n):null},e.decodeJsonString=function(e){var t=e.split('"');return t.forEach((function(e,t,n){var i=decodeURIComponent(e);n[t]=i.replace(/"/g,'\\"')})),t.join('"')},e}()},Zmq1:function(e,t,n){"use strict";var i;function r(e){var t=parseInt(e);return isNaN(t)?0:t}function o(){if(i)return i;var e=window.navigator.userAgent.toLowerCase(),t={keyword:"Other",platformType:"Other"};[{keyword:"Windows NT",platformType:"PC"},{keyword:"Windows XP",platformType:"PC"},{keyword:"Macintosh",platformType:"Mac"},{keyword:"Windows Phone",platformType:"WindowsPhone",pageName:"windows-phone"},{keyword:"iPad",platformType:"iPad",pageName:"ipad"},{keyword:"iPhone",platformType:"iPhone",pageName:"iphone"},{keyword:"Android",platformType:"AndroidPhone",pageName:"android-phone"},{keyword:"Linux",platformType:"Linux"},{keyword:"CrOS",platformType:"Chromebook"}].some((function(n){return-1!==e.indexOf(n.keyword.toLowerCase())&&(t=n,!0)})),"AndroidPhone"===t.platformType&&-1===e.indexOf("mobile")&&(t={keyword:"Android",platformType:"AndroidTablet",pageName:"android-tablet"});var n={major:0,minor:0,build:0};if("Mac"===t.platformType)(o=/Mac OS X (\d+)(_|\.)(\d+)([_\.]?)(\d*)/i.exec(window.navigator.userAgent))&&o.length>=6&&(n={major:r(o[1]),minor:r(o[3]),build:r(o[5])});else if("PC"===t.platformType||"WindowsPhone"===t.platformType)-1!==e.indexOf("windows xp")?n={major:5,minor:1,build:0}:(o=/Windows (NT|Phone) (OS )?(\d+)\.(\d+)/i.exec(window.navigator.userAgent))&&o.length>=5&&(n={major:r(o[3]),minor:r(o[4]),build:0});else if("iPad"===t.platformType||"iPhone"===t.platformType){var o;n={major:r((o=e.match(/os (\d+)_(\d+)(_(\d+))?/))&&o[1]),minor:r(o&&o[2]),build:r(o&&o[4])}}var a={keyword:"Other",browserType:"Other"};return[{keyword:"PhantomJS",browserType:"Headless"},{keyword:"Edge",browserType:"Edge"},{keyword:"MSIE",browserType:"IE"},{keyword:"Edg",browserType:"EdgeChromium"},{keyword:"Chrome",browserType:"Chrome"},{keyword:"CriOS",browserType:"Chrome"},{keyword:"Firefox",browserType:"Firefox"},{keyword:"Safari",browserType:"Safari"}].some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(a=t,!0)})),i={platform:t,platformVersion:n,browser:a}}n.d(t,"a",(function(){return o}))},ZtId:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},Zy3K:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("BaAg"),n("4/We"),n("PBJH");var i=function(){function e(e,t){this.capabilitiesService=e,this.locService=t}return e.prototype.ngOnInit=function(){this.createLocation=this.locService.BrandOneDrive,this.createLocationPrompt=this.locService.appResource("CreateNewLocationPrompt",this.app),this.oneDriveColor="#0078D4",this.fluentRefresh=this.capabilitiesService.capabilities.fluentRefresh},e}()},a3FV:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.ActionsMenuItemClick="Actions_Menu_Item_Click",e.ActionsMenuReactToggle="Actions_Menu_React_Toggle",e.ActionsMenuToggle="Actions_Menu_Toggle",e.ActivityFeedRequest="Activity_Feed_Request",e.ActivitySessionFinished="Activity_Session_Finished",e.ActivitySessionStarted="Activity_Session_Started",e.ActivityStoreRequest="Activity_Store_Request",e.AddToHomeScreenPromptImpressionMobile="Add_To_Home_Screen_Prompt_Mobile",e.AddToHomeScreenPromptImpressionDesktop="Add_To_Home_Screen_Prompt_Impression_Desktop",e.AddToToDoRequest="Add_To_To_Do_Request",e.AdminPolicyServerRequest="Admin_Policy_Server_Request",e.AdminPolicyCacheRequest="Admin_Policy_Cache_Request",e.AllowFileSystemAccess="Allow_File_System_Access",e.AllTemplatesClick="All_Templates_Click",e.AppAddedToHomeScreen="App_Added_To_Home_Screen",e.AppAddedToHomeScreenMobile="App_Added_To_Home_Screen_Mobile",e.AppAddedToHomeScreenDesktop="App_Added_To_Home_Screen_Desktop",e.AppItemsImpression="App_Items_Impression",e.AnnouncementImpression="Announcement_Impression",e.AppError="App_Error",e.AppBarClick="AppBar_Click",e.AppGalleryLearnMoreClick="AppGallery_LearnMoreClick",e.AppGalleryCardImpression="AppGallery_Card_Impression",e.AppGalleryClick="AppGallery_Click",e.AppGalleryNavClick="AppGallery_Nav_Click",e.AppGalleryPageView="AppGallery_PageView",e.AppInstalledStatus="App_Installed_Status",e.AppListImpression="AppList_Impression",e.AppServiceConnection="App_Service_Connection",e.AppTileRightClick="App_Tile_Right_Click",e.AppTilesImpression="App_Tiles_Impression",e.AppTilesReady="App_Tiles_Ready",e.AuthStateChanged="Auth_State_Changed",e.BulkLicensePreview="Bulk_License_Preview",e.BulkLicensePreviewReadError="Bulk_License_Preview_Read_Error",e.BulkLicensePreviewRequest="Bulk_License_Preview_Request",e.CalendarClick="Calendar_Click",e.CalendarDayImpression="Calendar_Day_Impression",e.CalendarRequest="Calendar_Request",e.CAPPopup="CAP_Popup",e.CheckLoginRequest="Check_Login_Request",e.ClearSWCache="Clear_SW_Cache",e.ConfigRequest="Config_Request",e.ConsumerSkuLoaded="ConsumerSkuLoaded",e.ConsumerUpsellImpression="ConsumerUpsell_InstallImpression",e.ContentActionError="Content_Action_Error",e.ContentActionsMenuToggle="Content_Actions_Menu_Toggle",e.ContentActionsCommandMenuToggle="Content_Actions_Command_Menu_Toggle",e.ContentActionsMenuItemClick="Content_Actions_Menu_Item_Click",e.ContentActionsMenuItemClickLaunchDocument="Content_Actions_Menu_Item_Click_Launch_Document",e.ContentActionInitialization="Content_Action_Initialization",e.ContentActionRegistered="Content_Action_Registered",e.ContentActionSuccess="Content_Action_Success",e.ContentActionCompleted="Content_Action_Completed",e.CreateCenterCreateTilesImpression="Create_Center_Create_Tiles_Impression",e.CreateCenterEnterpriseTemplatesImpression="Create_Center_Enterprise_Templates_Impression",e.CreateCenterTemplatesCollectionsImpression="Create_Center_Templates_Collections_Impression",e.CreateFromDocumentClick="Create_From_Document_Click",e.CreateFromDocumentClickResult="Create_From_Document_Click_Result",e.CreateLinkClick="Create_Link_Click",e.CreateLinkClickResult="Create_Link_Click_Result",e.CreateMenuImpression="Create_Menu_Impression",e.CreateMenuToggle="Create_Menu_Toggle",e.CreateModalImpression="Create_Modal_Impression",e.CreateNewDocumentError="CreateNew_Document_Error",e.CreateNewRedirectFail="Create_New_Redirect_Fail",e.CreateNewRedirectSuccess="Create_New_Redirect_Success",e.CreateOnHomeCreateTilesImpression="Create_On_Home_Create_Tiles_Impression",e.CreatePanelImpression="Create_Panel_Impression",e.CreateSharingLinkGraphAPI="CreateSharingLink_GraphAPI",e.CsrfTokenError="Csrf_Token_Error",e.CustomStartDeprecationModalImpression="CustomStart_Deprecation_Modal_Impression",e.DimeCompleted="Dime_Completed",e.DimeTransactionCompleted="DimeTransactionCompleted",e.DimeInitialize="Dime_Initialize",e.DimeLaunch="Dime_Launch",e.DimeLoadScript="Dime_LoadScript",e.DimePreload="Dime_Preload",e.DimeWarmup="Dime_Warmup",e.DocumentHover="Document_Hover",e.DocumentTitleRenameFile="Document_Title_Rename_File",e.DocumentTitleRenameFileError="Document_Title_Rename_File_Error",e.DTTShellContainerNotFound="Document_Title_Shell_Container_Not_Found",e.EdgeworthBulkCacheRead="EdgeworthBulkCacheRead",e.EdgeworthCacheDeleteError="Edgeworth_Cache_Delete_Error",e.EdgeworthCacheRead="EdgeworthCacheRead",e.EdgeworthCacheWrite="EdgeworthCacheWrite",e.EdgeworthCachedTimestampAccess="EdgeworthCachedTimestampAccess",e.EdgeworthCalloutImpression="Edgeworth_Callout_Impression",e.EdgeworthClick="Edgeworth_Click",e.EdgeworthDebugCount="EdgeworthDebugCount",e.EdgeworthDeleteSettingRequest="EdgeworthDeleteSettingRequest",e.EdgeworthDuplicateFilesDetected="EdgeworthDuplicateFilesDetected",e.EdgeworthFilterSelect="Edgeworth_Filter_Select",e.EdgeworthFullSyncRequest="EdgeworthFullSyncRequest",e.EdgeworthHideItemRequest="EdgeworthHideItemRequest",e.EdgeworthImpression="Edgeworth_Impression",e.EdgeworthInitExperience="Edgeworth_Init_Experience",e.EdgeworthParseError="Edgeworth_Parse_Error",e.EdgeworthPinItemRequest="EdgeworthPinItemRequest",e.EdgeworthPivotClick="Edgeworth_Pivot_Click",e.EdgeworthRebuildError="EdgeworthRebuildError",e.EdgeworthRebuildRequired="EdgeworthRebuildRequired",e.EdgeworthRebuildCompleted="EdgeworthRebuildCompleted",e.EdgeworthRequest="EdgeworthRequest",e.EdgeworthSubstrateRecentRequest="EdgeworthSubstrateRecentRequest",e.EdgeworthSubstrateDeltaSyncPageRequest="EdgeworthSubstrateDeltaSyncPageRequest",e.EdgeworthSyncDetails="EdgeworthSyncDetails",e.EdgeworthTextFilterUsed="EdgeworthTextFilterUsed",e.EdgeworthUnhideItemRequest="EdgeworthUnhideItemRequest",e.EdgeworthUnpinItemRequest="EdgeworthUnpinItemRequest",e.EdgeworthUpsertSettingRequest="EdgeworthUpsertSettingRequest",e.EduThemesCalloutImpression="EduThemesCallout_Impression",e.ElementInViewport="Element_In_Viewport",e.EmbedBootstrapEnd="Embed_Bootstrap_End",e.EmbedSwGetTokenError="Embed_Sw_Get_Token_Error",e.ErrorDialogImpression="Error_Dialog_Impression",e.ExpandableListToggle="Expandable_List_Toggle",e.ExpandedWorkspacesRequest="Expanded_Workspaces_Request",e.ExploreAllYourAppsImpression="ExploreAllYourApps_Impression",e.FastSearchPageView="FastSearch_PageView",e.FeaturedDocumentsClick="FeaturedDocuments_Click",e.FeaturedDocumentsErrorImpression="FeaturedDocuments_Error_Impression",e.FeaturedDocumentsImpression="FeaturedDocuments_Impression",e.FeaturedDocumentsRequest="FeaturedDocuments_Request",e.FeaturedDocumentsToggle="FeaturedDocuments_Toggle",e.FeatureGatesRequest="FeatureGates_Request",e.FeatureSettingsRequest="FeatureSettings_Request",e.FeedbackOCVClick="Feedback_OCV_Click",e.FeedbackOCVDismissed="Feedback_OCV_Dismissed",e.FeedbackOCVError="Feedback_OCV_Error",e.FeedbackOCVSubmitted="Feedback_OCV_Submitted",e.FileVersionListFetch="File_Version_List_Fetch",e.FirstRunCompleted="First_Run_Completed",e.FirstRunImpression="First_Run_Impression",e.FirstRunSlideStats="First_Run_Slide_Stats",e.FirstSiteVisit="First_Site_Visit",e.FirstTimeMetric="First_Time_Metric",e.FluidContentCreateNew="FluidContent_CreateNew",e.FluidContentError="FluidContent_Error",e.FluidContentOpen="FluidContent_Open",e.FluidContentPageView="FluidContent_PageView",e.FluidContentTimeout="FluidContent_Timeout",e.FluidFileInfoError="Fluid_FileInfo_Error",e.FluidFileLoadError="FluidFileLoad_Error",e.FluidFileLocationInfoError="FluidFile_LocationInfo_Error",e.FluidInformationProtectionError="Fluid_InformationProtection_Error",e.FluidMobileUpsellImpression="Fluid_MobileUpsell_Impression",e.FluidMobileUpsellInstallClick="Fluid_MobileUpsell_Install_Click",e.FluidShareControlError="Fluid_ShareControl_Error",e.FluidShareControlStart="Fluid_ShareControl_Start",e.FluidTokenFetch="Fluid_TokenFetch",e.FluidVersionHistoryDTTClick="Fluid_VersionHistoryDTTClick",e.FocusContextError="Focus_Context_Error",e.FreNewCalloutsEvent="Fre_New_Callouts_Event",e.FreNewCalloutsImpression="Fre_New_Callouts_Impression",e.GalleryCardImpression="Gallery_Card_Impression",e.GalleryNavClick="Gallery_Nav_Click",e.GenericDebugCache="Generic_Debug_Cache_2",e.GenericClick="Generic_Click",e.GenericEvent="Generic_Event",e.GenericImpression="Generic_Impression",e.GenericRequest="Generic_Request",e.GetClassNotebooksRequest="Get_ClassNotebooks_Request",e.GetDownloadUrlError="Get_DownloadUrl_Error",e.GetForm="Get_Form",e.GetOneNotePageRequest="Get_OneNote_Page_Request",e.GetOneNoteSectionsRequest="Get_OneNote_Sections_Request",e.GetSiteTitleRequest="Get_Site_Title_Request",e.GetUserReputationTier="Get_User_Reputation_Tier",e.GetWindowsPkid="GetWindowsPkid",e.GroupSideMenuMoveClick="Group_SideMenu_Move_Click",e.EnterpriseTemplatesErrorImpression="Enterprise_Templates_Error_Impression",e.EnterpriseTemplatesImpression="Enterprise_Templates_Impression",e.InvalidMethod="Invalid_Method",e.FormCreateFormFromTemplate="Form_Create_Form_From_Template",e.FormsFeatureCallout="Forms_Feature_Callout",e.FormsMembersThumbnailFetch="Forms_Members_Thumbnail_Fetch",e.FormsGroupThumbnailFetch="Forms_Group_Thumbnail_Fetch",e.FormsSharedUnpinRequest="Forms_Shared_UnpinRequest",e.FormsCopyRequest="Forms_Copy_Request",e.FormsGroupsRequest="Forms_Groups_Request",e.FormsFromGroupRequest="Forms_From_Group_Request",e.FormsResponses="Forms_Responses",e.FormsThemeRequest="Forms_Theme_Request",e.FormsDeleteRequest="Forms_Delete_Request",e.GroupFormsCreateRequest="Group_Forms_Create_Request",e.FormsGroupMembersRequest="Forms_Group_Members_Request",e.ImpressionsSinceFirstVisit="Impressions_Since_First_Visit",e.InitializeWopiPendingFailed="Initialize_Wopi_Pending_Failed",e.SharedFormsRequest="Shared_Forms_Request",e.MyFormsRequest="My_Forms_Request",e.MyContentLinkClick="My_Content_Link_Click",e.RestoreFormRequest="Restore_Form_Request",e.RecycleFormRequest="Recycle_Form_Request",e.GraphBatchRequest="Graph_Batch_Request",e.GroupItemClick="Group_Item_Click",e.HelpSearchSuggestionRequest="Help_Search_Suggestion_Request",e.HistoryDisabled="History_Disabled",e.HomePageView="Home_PageView",e.IdentityRequest="Identity_Request",e.InputDialogButtonClick="Input_Dialog_Button_Click",e.InstallClick="Install_Click",e.InstallCustomError="Install_Custom_Error",e.InstallGenericError="Install_Generic_Error",e.InstallableAppsRequest="Installable_Apps_Request",e.InstalledAppsFetch="Installed_Apps_Fetch",e.InstalledAppsExFetch="Installed_Apps_Ex_Fetch",e.InstalledAppsExFetchDebug="Installed_Apps_Ex_Fetch_Debug",e.InstalledOfficeDetailsFetch="Installed_Office_Details_Fetch",e.InstallerRequest="Installer_Request",e.InstallScenario="Install_Scenario",e.LaunchByProtocolFailed="Launch_By_Protocol_Failed",e.LaunchFileExplorerFailed="Launch_File_Explorer_Failed",e.LaunchLocalApp="Launch_Local_App",e.LeftNavCalloutImpression="Left_Nav_Callout_Impression",e.LeftNavImpression="Left_Nav_Impression",e.LeftNavReady="LeftNav_Ready",e.LocalMruFetch="Local_Mru_Fetch",e.LocalStorageUnavailable="Local_Storage_Unavailable",e.M365AppsDefinitionError="M365_Apps_Definition_Error",e.M365AppsDefinitionLookup="M365_Apps_Definition_Lookup",e.M365AppsDefinitionLookupError="M365_Apps_Definition_Retry_Lookup_Error",e.M365AppsDefinitionLookupRequest="M365_Apps_Definition_Not_Found_In_Config_Retrying_Lookup",e.M365AppsParseDomConfigError="M365_Apps_Parse_Dom_Config_Error",e.MOSAppHostError="MOS_App_Host_Error",e.MOSHubSDK="MOS_HUB_SDK_Request",e.MeetingObjectsNoArtifactsFoundError="Meeting_Objects_No_Artifacts_Found_Error",e.MeetNowButtonImpression="Meet_Now_Button_Impression",e.MemoryUsage="Memory_Usage",e.MetaTransformCapacityRequest="MeTA_Transform_Capacity_Request",e.MobileAppBannerImpression="Mobile_App_Banner_Impression",e.MobileView="Mobile_View",e.MoveToFolderControlError="Move_To_Folder_Control_Error",e.MoveToFolderControlClick="Move_To_Folder_Control_Click",e.MoveToFolderControlAbandon="Move_To_Folder_Control_Abandon",e.MoveToFolderControlImpression="Move_To_Folder_Control_Impression",e.MoveToFolderControlAuthenticate="Move_To_Folder_Control_Authenticate",e.MoveToFolderControlNavigationStarted="Move_To_Folder_Control_Navigation_Started",e.MoveToFolderControlNavigationEnded="Move_To_Folder_Control_Navigation_Ended",e.MruClick="Mru_Click",e.MruDelete="Mru_Delete",e.MruFileItemError="Mru_File_Item_Error",e.MruPathClick="Mru_Path_Click",e.MruUpdatePin="Mru_Update_Pin",e.MruImpression="Mru_Impression",e.MruRequest="Mru_Request",e.MruS2SRequest="Mru_S2S_Request",e.MruWrite="Mru_Write",e.MruWriteError="Mru_Write_Error",e.MsaTokenFetch="Msa_Token_Fetch",e.MyContentChangeLayout="My_Content_Change_Layout",e.NavigateToTemplatesClick="Navigate_To_Templates_Click",e.NewConsumerNoContentImpression="New_Consumer_No_Content_Impression",e.NewPlaylistButtonClick="New_Playlist_Button_Click",e.NewUserShelfImpression="New_User_Shelf_Impression",e.NewScreenRecorderButtonClick="New_Screen_Recorder_Button_Click",e.NewVideoRecorderButtonClick="New_Video_Recorder_Button_Click",e.NewUserShelfClick="New_User_Shelf_Click",e.NotificationServiceError="Notification_Service_Error",e.OfficeConsumerLicenseFetch="Office_Consumer_License_Fetch",e.OfficeFeedAction="OfficeFeedAction",e.OfficeFeedInstrumentation="OfficeFeedInstrumentation",e.OfficeFeedRequest="OfficeFeedRequest",e.OfficeFeedStreamThumbnailRequest="OfficeFeed_Stream_Thumbnail_Request",e.OfficeHomeStorageReadRequest="OfficeHomeStorage_Read_Request",e.OfficeHomeStorageWriteRequest="OfficeHomeStorage_Write_Request",e.OfficeInsightsSearchSuggestionRequest="OfficeInsights_Search_Telemetry_Request",e.OfficeLicensesFetch="Office_Licenses_Fetch",e.OneDriveGraphCancelUploadSessionRequest="OneDrive_Graph_Cancel_Upload_Session_Request",e.OneDriveGraphCreateFileRequest="OneDrive_Graph_Create_File_Request",e.OneDriveGraphCreateUploadSessionRequest="OneDrive_Graph_Create_Upload_Session_Request",e.OneDriveGraphItemError="OneDrive_Graph_Item_Error",e.OneDriveGraphItemRequest="OneDrive_Graph_Item_Request",e.OneDriveGraphItemWithWacDataAndThumbRequest="OneDrive_Graph_Item_With_Wac_Data_And_Thumb_Request",e.OneDriveGraphItemWithWacDataRequest="OneDrive_Graph_Item_With_Wac_Data_Request",e.OneDriveGraphSharesRequest="OneDrive_Graph_Shares_Request",e.OneDriveGraphSharesWithWacDataRequest="OneDrive_Graph_Shares_With_Wac_Data_Request",e.OneDriveGraphBatchSharesRequest="OneDrive_Graph_Batch_Shares_Request",e.OneDriveGraphThumbnailRequest="OneDrive_Graph_Thumbnail_Request",e.OneDriveGraphThumbnailStringRequest="OneDrive_Graph_Thumbnail_String_Request",e.OneDriveGraphPeoplePictureRequest="OneDrive_Graph_People_Picture_Request",e.OneDriveGraphBatchPeoplePicturesRequest="OneDrive_Graph_Batch_People_Pictures_Request",e.OneDriveGraphUploadFileRequest="OneDrive_Graph_Upload_File_Request",e.OneDriveGraphUploadFragmentRequest="OneDrive_Graph_Upload_Fragment_Request",e.OneDriveGraphUploadStatusRequest="OneDrive_Graph_Upload_Status_Request",e.OneDrivePlacesBadUrl="OneDrive_Places_Bad_Url",e.OneDrivePlacesClick="OneDrive_Places_Click",e.OneDrivePlacesImpression="OneDrive_Places_Impression",e.OneDriveUserRootUrl="OneDrive_User_RootUrl",e.ODSPProvisioningStatus="ODSP_Provisioning_Status",e.ODSPProvisioningFinish="ODSP_Provisioning_Finish",e.ODSPProvisioningGiveUp="ODSP_Provisioning_GiveUp",e.ODSPInstaProvisionedRedirect="ODSP_Insta_Provisioned_Redirect",e.OneNoteGraphCreateNoteBookRequest="OneNote_Graph_Create_NoteBook_Request",e.OneNoteGraphGetNotebooksRequest="OneNote_Graph_Get_NoteBooks_Request",e.OneNoteNotebookCreateLinkClick="OneNote_Notebook_Create_Link_Click",e.OneNotePageCreateLinkClick="OneNote_Page_Create_Link_Click",e.OtelInitializationError="OTEL_Initialization_Error",e.OtelReady="OTEL_Ready",e.GroupsImpression="Groups_Impression",e.PerformanceDump="Performance_Dump",e.PerformanceMarkFailure="Performance_Mark_Failure",e.PeopleCardImpression="People_Card_Impression",e.PeopleCardInitialization="People_Card_Initialization",e.PinToTaskbar="Pin_To_Taskbar",e.PrefetchEdgeworthConfigInternalError="PrefetchEdgeworthConfigInternal_Error",e.PrefetchNorthStarError="PrefetchNorthStar_Error",e.PrideThemesCalloutImpression="PrideThemesCallout_Impression",e.PrimaryTokenFetchRequest="Primary_Token_Fetch_Request",e.PromotedAppTileImpression="Promoted_App_Tile_Impression",e.PwaBootstrapEnd="Pwa_Bootstrap_End",e.PwaOnActivated="Pwa_On_Activated",e.PwaNavigationFailed="Pwa_Navigation_Failed",e.PwaJumpListItemClick="Pwa_Jump_List_Item_Click",e.PwaJumpList="Pwa_Jump_List",e.PwaSwHandleRegistrationError="Pwa_Sw_Handle_Registration_Error",e.PwaSwGetTokenError="Pwa_Sw_Get_Token_Error",e.QuickAccessChangeLayout="QuickAccess_Change_Layout",e.QuickAccessCreateCustomPivot="QuickAccess_Create_CustomPivot",e.QuickAccessCustomPivotsImpression="QuickAccess_CustomPivots_Impression",e.QuickAccessRemoveCustomPivot="QuickAccess_Remove_CustomPivot",e.QuickAccessShowCustomPivotsMenu="QuickAccess_Show_CustomPivotMenu",e.RecommendedCalloutImpression="Recommended_Callout_Impression",e.RecommendedClick="Recommended_Click",e.RecommendedDelete="Recommended_Delete_Request",e.RecommendedFilesActions="Recommended_Files_Actions",e.RecommendedImpression="Recommended_Impression",e.RecommendedInflationComplete="Recommended_Inflation_Complete",e.RecommendedNavClick="Recommended_Nav_Click",e.RecommendedRequest="Recommended_Request",e.RefreshAccessTokenRequest="Refresh_Access_Token_Request",e.ResourceStringsFetch="Resource_Strings_Fetch",e.ReturningUserCalloutsImpression="Returning_User_Callouts_Impression",e.SearchAutoSuggestionResultsFetched="Search_Auto_Suggestion_Results_Fetched",e.SearchCapability="Search_Capability",e.SearchClick="Search_Click",e.SearchPageView="Search_PageView",e.SearchPerformance="Search_Performance",e.SearchQuery="Search_Query",e.SearchRenderedResults="Search_Rendered_Results",e.SearchResultsFetched="Search_Results_Fetched",e.SearchSessionStarted="Search_Session_Started",e.SessionStorageUnavailable="Session_Storage_Unavailable",e.SettingsRequest="Settings_Request",e.ShareControlAbandon="Share_Control_Abandon",e.ShareControlClick="Share_Control_Click",e.ShareControlError="Share_Control_Error",e.ShareControlImpression="Share_Control_Impression",e.ShareControlStarted="Share_Control_Started",e.SharedWithMeRequest="Shared_With_Me_Request",e.SharePointContextRequest="SharePoint_Context_Request",e.SharePointGetListError="SharePoint_Get_List_Error",e.SharePointIdsRequest="SharePoint_Ids_Request",e.SharePointListItemRequest="SharePoint_List_Item_Request",e.SharePointListsRequest="SharePoint_Lists_Request",e.SharePointMicroserviceUrlsRequest="SharePoint_Microservice_Urls_Request",e.SharePointSiteClick="SharePoint_Site_Click",e.SharePointSitesImpression="SharePoint_Sites_Impression",e.SharePointWebsocketRequest="SharePoint_Websocket_Request",e.SharePointSitesRequest="SharePoint_Sites_Request",e.ShellBootstrapperError="Shell_Bootstrapper_Load_Error",e.ShowMoreTilesImpression="ShowMoreTiles_Impression",e.SimplePersistenceReadError="Simple_Persistence_Read_Error",e.SimplePersistenceWriteError="Simple_Persistence_Write_Error",e.SpaceCreated="Space_Created",e.SpaceGalleryClick="SpaceGallery_Click",e.SpaceGalleryImpression="SpaceGallery_Impression",e.SpaceGalleryPageView="SpaceGallery_PageView",e.SpacePageClick="SpacePage_Click",e.SpacePagePageView="SpacePage_PageView",e.SpaceUpdated="Space_Updated",e.SplitButtonToggle="Split_Button_Toggle",e.StayingAwareAckError="Staying_Aware_Ack_Error",e.StayingAwareActivityTypeError="Staying_Aware_Activity_Type_Error",e.StayingAwareAppExtensionError="Staying_Aware_App_Extension_Error",e.StayingAwareCompleted="Staying_Aware_Completed",e.StayingAwareControlError="Staying_Aware_Control_Error",e.StayingAwareControlImpression="Staying_Aware_Control_Impression",e.StayingAwareData="Staying_Aware_Data",e.StayingAwareDataLogError="Staying_Aware_Data_Log_Error",e.StayingAwareDismissed="Staying_Aware_Dismissed",e.StayingAwareDocumentOpened="Staying_Aware_Document_Opened",e.StayingAwareError="Staying_Aware_Error",e.StayingAwareFlagged="Staying_Aware_Flagged",e.StayingAwareGetHiddenListError="Staying_Aware_Get_Hidden_List_Error",e.StayingAwareItemControlError="Staying_Aware_Item_Control_Error",e.StayingAwarePushedUpdates="Staying_Aware_Pushed_Updates",e.StayingAwareSocketConnected="Staying_Aware_Socket_Connected",e.StayingAwareSocketDisconnected="Staying_Aware_Socket_Disconnected",e.StayingAwareUpdateActivityStateError="Staying_Aware_Update_Activity_State_Error",e.StayingAwareUpdateSessionSortError="Staying_Aware_Update_Session_Sort_Error",e.StayingAwareUpdateLastReadTimeError="Staying_Aware_Update_Last_Read_Time_Error",e.SuggestedActionClick="Suggested_Action_Click",e.SupportCentralError="Support_Central_Error",e.SupportCentralImpression="Support_Central_Impresion",e.SupportCentralInit="Support_Central_Init",e.SupportCentralLoaded="Support_Central_Loaded",e.SupportCentralStart="Support_Central_Start",e.SwActivated="Sw_Activated",e.SwApiMissingTokenError="Sw_ApiMissingToken_Error",e.SwApiMissingUserIdError="Sw_ApiMissingUserId_Error",e.SwApiNetworkRequestError="Sw_ApiNetworkRequest_Error",e.SwApiRequestHandlingError="Sw_ApiRequestHandling_Error",e.SwApiTimeoutError="Sw_ApiTimeout_Error",e.SwAppWarmupTimeoutError="Sw_AppWarmupTimeout_Error",e.SwPrecacheAssetError="Sw_PrecacheAsset_Error",e.SwPrecacheCountMismatchError="Sw_PrecacheCountMismatch_Error",e.SwayCreateRequest="Sway_Create_Request",e.SwayCreateStoryAndPublishDocumentRequest="Sway_Create_Story_And_Publish_Document_Request",e.SwayGetAnalytics="Sway_Get_Analytics_Request",e.SwayGetThumbnailRequest="Sway_Get_Thumbnail_Request",e.TeamsAccessTokenRequest="Teams_Access_Token_Request",e.TellMeSearchSuggestionRequest="TellMe_Search_Suggestion_Request",e.TemplateClick="Template_Click",e.TemplateClickResult="Template_Click_Result",e.TemplateLibrariesRequest="Template_Libraries_Request",e.TemplatesCollectionClick="Templates_Collection_Click",e.TemplatesCollectionsRequest="Templates_Collections_Request",e.TemplateContentRequest="Template_Content_Request",e.TemplatesRecommendedRequest="Templates_Recommended_Request",e.TemplatesGraphGetRequest="Templates_Graph_Get_Request",e.TemplatesErrorImpression="Templates_Error_Impression",e.TemplatesImpression="Templates_Impression",e.TemplatesPageView="Templates_PageView",e.TemplatesRequest="Templates_Request",e.TemplatesToggle="Templates_Toggle",e.ThumbnailLoad="Thumbnail_Load",e.ThumbnailCachePipeLoad="Thumbnail_Cache_Pipe_Load",e.TileToggleOpen="Tile_Toggle_Open",e.TileToggleSelect="Tile_Toggle_Select",e.ToastClick="Toast_Click",e.TokensConfigMissing="Tokens_Config_Missing",e.TrendingAroundMeRequest="Trending_Around_Me_Request",e.UnexpectedHistoryState="Unexpected_History_State",e.UnhandledException="Unhandled_Exception",e.UnifiedDocumentBootEnd="UnifiedDocumentBootEnd",e.UnifiedDocumentBootError="UnifiedDocumentBootError",e.UnifiedDocumentBootErrorExpected="UnifiedDocumentBootErrorExpected",e.UnknownTheme="Unknown_Theme",e.UploadButtonImpression="Upload_Button_Impression",e.UploadButtonDragAndDropCalloutImpression="Upload_Button_DragAndDrop_Callout_Impression",e.UploadClick="Upload_Click",e.UploadCompleted="Upload_Completed",e.UploadDialogImpression="Upload_Dialog_Impression",e.UploadLocalError="Upload_Local_Error",e.UpsellButtonClick="Upsell_Button_Click",e.UpsellButtonImpression="Upsell_Button_Impression",e.UpsellDialogImpression="Upsell_Dialog_Impression",e.UpsellDialogClose="Upsell_Dialog_Close",e.UserEntitlementsRequest="UserEntitlements_Request",e.VisioLicenseStatus="Visio_License_Status",e.VroomActivityRequest="Vroom_Activity_Request",e.VroomCreateFileRequest="Vroom_Create_File_Request",e.VroomCreateLinkRequest="Vroom_Create_Link_Request",e.VroomCreateUploadSessionRequest="Vroom_Create_Upload_Session_Request",e.VroomGetFluidEnabled="Vroom_Get_Fluid_Enabled_Request",e.VroomItemRequest="Vroom_Item_Request",e.VroomItemWithWacDataRequest="Vroom_Item_With_Wac_Data_Request",e.VroomOneDriveCheckAccessRequest="Vroom_OneDrive_Item_Check_Access_Request",e.VroomSharesRequest="Vroom_Shares_Request",e.VroomSharesWithWacDataRequest="Vroom_Shares_With_Wac_Data_Request",e.VroomThumbnailRequest="Vroom_Thumbnail_Request",e.VroomUploadFileRequest="Vroom_Upload_File_Request",e.WacContentError="WacContent_Error",e.WacContentPageView="WacContent_PageView",e.WacDocumentAbandon="WacDocument_Abandon",e.WacDocumentLoadStart="WacDocument_Load_Start",e.WacDocumentLoaded="WacDocument_Loaded",e.WacDocumentPreboot="WacDocument_Preboot",e.WacDocumentPreload="WacDocument_Preload",e.WacDocumentJsApiError="WacDocument_JsApi_Error",e.WacDocumentJsApiTimeout="WacDocument_JsApi_Timeout",e.WacDocumentVroomError="WacDocument_Vroom_Error",e.WacDocumentBootstrapperLoadError="WacHost_Bootstrapper_Load_Error",e.WacDocumentGenericBootError="WacDocument_Generic_Boot_Error",e.WacPageAction="WacPageAction",e.WacStartPageView="WacStart_PageView",e.WamTokenRequestInitiated="WAM_Token_Request_Initiated",e.WamTokenRequest="WAM_Token_Request",e.WamTokenExpired="WAM_Token_Expired",e.WopiDataFetchFailed="Wopi_Data_Fetch_Failed",e}({})},aQ3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("pOWU"),o=function(){function e(){this.cachedResponsePromises=new Map}return e.prototype.set=function(e,t,n,i){var r=this.key(t,n,i);this.cachedResponsePromises.set(r,e)},e.prototype.has=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.has(i)},e.prototype.get=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.get(i)},e.prototype.delete=function(e,t,n){var i=this.key(e,t,n);return this.cachedResponsePromises.delete(i)},e.prototype.key=function(e,t,n){return(t?"beta":"v1.0")+"/"+n+"/"+e},e}(),a=function(e){function t(t,n,i,r,a,s,c,l){var u=e.call(this,t,n,i,"Graph",r,a,s,l)||this;u.globalErrorHandler=c,u.cachedResponsePromises=new o;var d=r.sharedContext;return u.graphServiceHost=u.inMockMode?d.officeHomeApiRoot:d.graphApiRoot,u.requestConfig={headers:new Map},u}return Object(i.__extends)(t,e),t.prototype.getGraph=function(t,n,i,o,a,s,c,l,u,d,p,f,h){var m=this;if(void 0===s&&(s=!1),void 0===d&&(d=!1),void 0===f&&(f=null),void 0===h&&(h=!1),!h&&this.cachedResponsePromises.has(i,d,o))return this.cachedResponsePromises.get(i,d,o);var b=new Promise((function(h,b){var g=m.getGraphServiceEndpoint(i,d);g||b(new r.b(null,"Graph service endpoint url is not defined"));var v=m.getRequestConfig();v.responseType=void 0!==p?p:"json",e.prototype.get.call(m,t,n,g,(function(e){e.instrument((function(e,t){t.RequestId=m.getRequestIdFromResponse(e),a&&a(e,t)})).then((function(e){return h(e)})).catch((function(e){m.globalErrorHandler.handleError(e,"XDHsY")}))}),(function(e){s&&m.cachedResponsePromises.delete(i,d,o),b(e)}),v,o,c,l,u,void 0,void 0,f)}));return s&&this.cachedResponsePromises.set(b,i,d,o),b},t.prototype.postGraph=function(t,n,i,r,o,a,s,c,l,u,d,p,f,h){void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===f&&(f=null),void 0===h&&(h=void 0);var m=this.getGraphServiceEndpoint(i,d),b=this.getRequestConfig();return void 0!==h&&h.forEach((function(e,t){b.headers.set(t,e)})),e.prototype.post.call(this,t,n,m,r,o,a,b,s,c,l,u,void 0,null,null,null,p,f)},t.prototype.putGraph=function(t,n,i,r,o,a,s,c,l,u,d){void 0===d&&(d=!1);var p=this.getGraphServiceEndpoint(i,d);return e.prototype.put.call(this,t,n,p,r,o,a,this.getRequestConfig(),s,c,l,u)},t.prototype.patchGraph=function(t,n,i,r,o,a,s,c,l,u,d,p,f,h){void 0===h&&(h=!1);var m=this.getGraphServiceEndpoint(i,h),b=s||this.getRequestConfig();return e.prototype.patch.call(this,t,n,m,r,o,a,b,c,l,u,d,p,f)},t.prototype.handleQueryParam=function(e,n,i){"mockgraph"===e&&(null==i||i.headers.set(t.mockGraphHeader,n))},t.prototype.getRequestConfig=function(e){return void 0===e&&(e={}),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},this.requestConfig),{headers:new Map(this.requestConfig.headers)}),e)},t.prototype.getGraphServiceEndpoint=function(e,n){return void 0===n&&(n=!1),this.graphServiceHost?this.graphServiceHost+"/"+(n?t.graphBeta:t.graphV1)+"/"+e:""},t.graphV1="v1.0",t.graphBeta="beta",t.mockGraphHeader="ohp-mock-graph",t}(r.a)},adME:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(e){this.action=e,this.hoverDelay=100}return e.prototype.onMouseEnter=function(){var e=this;this.enabled()&&(this.hoverTimeout=setTimeout((function(){e.action()}),this.hoverDelay))},e.prototype.onMouseLeave=function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)},e}()},amPu:function(e,t,n){"use strict";function i(e,t,n){return e&&e.success?(t||(t={}),t.Authorization=(""+("RPSCompact"===e.format?n||"":"Bearer ")+e.token).trim(),t):null!=t?t:{}}n.d(t,"a",(function(){return i}))},b7yv:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),s=n("4/We"),c=n("keVe"),l=function(){function e(e,t,n){this.configParserService=e,this.capabilitiesService=t,this.eventService=n}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise){var t=function(){return e.configParserService.parse("firstRunConfig")};if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(t());else{var n=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise();this.configPromise=n.then(t)}}return this.configPromise},e.ɵprov=c.cc({factory:function(){return new e(c.dc(o.a),c.dc(s.a),c.dc(a.a))},token:e,providedIn:"root"}),e}()},bN7T:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var i=n("QjXU");function r(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,e.getRandomValues(new Uint8Array(12))]}))}))}function o(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function a(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){var s,c,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,a(JSON.stringify(e))];case 1:return s=i.sent(),[4,r(n)];case 2:return c=i.sent(),[4,n.subtle.encrypt({name:"AES-GCM",iv:c,tagLength:128},t,s)];case 3:return l=i.sent(),[2,o(c.buffer,l)]}}))}))}function s(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,s,c,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return a=e.slice(0,12),s=e.slice(12,e.byteLength),[4,n.subtle.decrypt({name:"AES-GCM",iv:a,tagLength:128},t,s)];case 1:return c=i.sent(),[4,r(new Uint8Array(c))];case 2:return l=i.sent(),[2,JSON.parse(l,o)]}}))}))}},"c/bn":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("ntFm"),o=n("VKX6"),a=n("TfV2"),s=n("GMuP"),c=n("tyUq"),l=n("czhI"),u=n.n(l),d=n("g92T"),p="NotAvailable";function f(e,t,n){return{data:void 0,status:e,headers:{},ok:!1,statusText:n&&"string"==typeof n?n:e.toString(),fromCache:t}}function h(e,t,n,l,h,m,b,g,v){var y=Object(o.a)(),S="cache-only"===l,w=function(e,t,n,r,o,a){var s=this;return new Promise((function(c,l){return Object(i.__awaiter)(s,void 0,void 0,(function(){var s,p,h,m;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(s="cache-only"===n,p={url:e.url,method:e.method,headers:e.headers,params:e.params,data:e.body,timeout:t,responseType:e.responseType,onUploadProgress:r,onDownloadProgress:o},a&&(h=u.a.CancelToken.source(),p.cancelToken=h.token,a.onCancel((function(){return h.cancel()}))),!d.c)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(d.c)(p,n||"network-only")];case 2:return i.sent(),[3,4];case 3:return m=i.sent(),l(f(501,s,m)),[2];case 4:return d.b.request(p).then((function(e){c({data:e.data,status:e.status,headers:e.headers,ok:!0,statusText:e.statusText,fromCache:s})}),(function(e){u.a.isCancel(e)?l(f(705,s)):"ECONNABORTED"===e.code?l(f(707,s)):e.response?l({data:e.response.data,status:e.response.status,headers:e.response.headers,ok:!1,statusText:e.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine?l(f(706,s)):l(f(-1,s))})),[2]}}))}))}))}(n,v||3e5,l,m,b,g),C=g?g.onCancel((function(){return Promise.resolve(f(705,S))})):new Promise((function(){})),I=function(n){!function(e,t,n,i,l){if(!e.fromCache||e.ok||501!==e.status){var u=Math.ceil(Object(o.a)()-i),d=e.status;null==d&&(d=-2);var f,h=e.statusText,m=h;null==h?(f=p,m=p):f="ok"===h.toLowerCase()?h:{value:h,kind:2};var b={};l&&l(e,b),b.hasOwnProperty("HttpCode")&&(d=b.HttpCode,delete b.HttpCode),function(e,t){void 0===t&&(t=a.a.Security),Object(c.a)({eventName:e.eventName,error:e.error,latency:e.latency,fromCache:e.fromCache,httpCode:e.httpCode,area:e.area,subArea:e.subArea},t),e.instrumentationParams&&Object.keys(e.instrumentationParams).length>0&&Object(s.a)({eventName:e.eventName,params:e.instrumentationParams,area:e.area,subArea:e.subArea},t)}({eventName:n,httpCode:d,error:m,fromCache:e.fromCache,latency:u,instrumentationParams:b}),Object(r.a)(t,d,u,f,e.fromCache,b).record()}}(n,e,t,y,h)};return Promise.race([w,C]).then(I,I),w}},c8Ce:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),s=n("4/We"),c=n("keVe"),l=function(){function e(e,t,n){this.configParserService=e,this.capabilitiesService=t,this.eventService=n}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise)if(this.capabilitiesService.capabilities.pwaEnabled)this.configPromise=Promise.resolve(function(){return e.configParserService.parse("upsellConfig")}());else{var t=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise();this.configPromise=t.then((function(){return e.configParserService.parse("upsellConfig")}))}return this.configPromise},e.ɵprov=c.cc({factory:function(){return new e(c.dc(o.a),c.dc(s.a),c.dc(a.a))},token:e,providedIn:"root"}),e}()},cAxl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("3bNC");var i=function(){function e(e){this.graphPictureService=e,this.fetchImage=!0,this.isUpcomingMeeting=!1,this.status="None",this.hasPadding=!1,this.personPictureCard=!1,this.iconSize=this.iconSize||30}return e.prototype.ngOnChanges=function(){var e;if(this.fetchImage){var t=this.pictureId||(null===(e=this.person)||void 0===e?void 0:e.email);this.imageBase64Promise=t?this.graphPictureService.getPeoplePicture(t,this.iconSize<=48?"48x48":void 0):Promise.resolve(null)}else this.imageBase64Promise=Promise.resolve(this.imageBase64)},e}()},cZRF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("QjXU"),r=n("kMgc"),o=n("bN7T"),a=n("jsgn"),s=n("FHrx"),c=n("COYM"),l=n("keVe"),u=function(){function e(e,t){this.webCryptoService=e,this.encryptionConfigService=t}return Object.defineProperty(e.prototype,"key",{get:function(){return this._keyPromise||(this._keyPromise=this.importKey()),this._keyPromise},enumerable:!0,configurable:!0}),e.prototype.importKey=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Object(a.a)(this.encryptionConfigService.config.cryptoKey,this.webCryptoService.crypto.subtle)]}))}))},e.ɵprov=l.cc({factory:function(){return new e(l.dc(c.b),l.dc(s.a))},token:e,providedIn:"root"}),e}(),d=function(){function e(e,t,n){this.encodingService=e,this.encryptionKeyService=t,this.webCryptoService=n}return e.prototype.encryptData=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return t=i.sent(),[2,Object(o.b)(e,t,this.webCryptoService.crypto,(function(e){return n.encodingService.encode(e)}))]}}))}))},e.prototype.decryptData=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.encryptionKeyService.key];case 1:return n=i.sent(),[2,Object(o.a)(e,n,this.webCryptoService.crypto,(function(e){return r.encodingService.decode(e)}),t)]}}))}))},e.ɵprov=l.cc({factory:function(){return new e(l.dc(r.a),l.dc(u),l.dc(c.b))},token:e,providedIn:"root"}),e}()},casz:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("QjXU"),r=n("UY9y"),o=n.n(r),a=n("lrJm"),s=n("x+6c"),c=n("WLAd"),l=n("Uqr9"),u=n("BMb5"),d=n("keVe"),p=function(){function e(e,t,n,i,r){var a=this;this.idleCallbackService=e,this.errorHandler=t,this.pageVisibilityService=n,this.windowService=i,this.performanceService=r,this.heap=new o.a([],(function(e,t){return a.compare(e,t)})),this.isProcessing=!1,this.shouldLogFirstIdle=this.pageVisibilityService.isVisible(),this.shouldLogFirstSchedule=!0,this.setOnVisibilityChange(),this.setOnGlobalWindow()}return e.prototype.scheduleWork=function(e,t){if(0===t)return e(),this.createNoopHandle();this.shouldLogFirstSchedule&&(this.shouldLogFirstSchedule=!1,this.performanceService.mark("First_Schedule"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=this.createHandle(n);return this.heap.push(n),this.dequeueWhenIdle(),i},e.prototype.hasTasks=function(){return!!this.heap.peek()},Object.defineProperty(e.prototype,"FCI",{get:function(){return void 0!==this.firstIdle?this.firstIdle:-1},enumerable:!0,configurable:!0}),e.prototype.createHandle=function(e){var t=this,n=function(){return e.cancelled=!0};return{cancel:n,cancelAndRunNow:function(){e.cancelled||(n(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(i){return n(),e.completed?t.createNoopHandle():t.scheduleWork(e.work,i)}}},e.prototype.createNoopHandle=function(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}},e.prototype.dequeueWhenIdle=function(){var e=this;this.pageVisibilityService.isVisible()?this.idleCallbackHandle||(this.idleCallbackHandle=this.idleCallbackService.runWhenIdle((function(t){e.shouldLogFirstIdle&&(e.shouldLogFirstIdle=!1,e.firstIdle=l.a.now(),e.performanceService.mark("First_Idle")),e.idleCallbackHandle=null,e.doWork(t)}))):this.doWork()},e.prototype.doWork=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.isProcessing)return[2];this.isProcessing=!0,i.label=1;case 1:if(this.pageVisibilityService.isVisible()&&!(e&&e.timeRemaining()>0))return[3,6];if(!(t=this.heap.pop()))return[3,6];if(t.cancelled)return[3,1];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.work(e)];case 3:return i.sent(),t.completed=!0,[3,5];case 4:return n=i.sent(),this.errorHandler.handleError(n,"DXUlK"),[3,5];case 5:return[3,1];case 6:return this.isProcessing=!1,this.heap.peek()&&this.dequeueWhenIdle(),[2]}}))}))},e.prototype.compare=function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0},e.prototype.setOnGlobalWindow=function(){this.windowService.nativeWindow.scheduler=this},e.prototype.setOnVisibilityChange=function(){var e=this;this.pageVisibilityService.addOnVisibilityChanged((function(t){"hidden"===t&&(e.shouldLogFirstIdle=!1,e.idleCallbackHandle&&(e.idleCallbackService.cancelIdleCallback(e.idleCallbackHandle),e.idleCallbackHandle=null),e.doWork())}))},e.ɵprov=d.cc({factory:function(){return new e(d.dc(s.a),d.dc(a.b),d.dc(c.a),d.dc(u.b),d.dc(l.b))},token:e,providedIn:"root"}),e}()},cenr:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("8/lW"),r=n("a3FV"),o=n("4CZh");function a(e,t,n,a){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===a&&(a=i.a.Security),Object(o.b)(e,r.a.GenericEvent,a,t,n,!0)}},cgnd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var i,r,o,a=n("lrJm"),s=n("dFxn"),c=n("ZJrL"),l=n("keVe");function u(e){if(!r){r=!0;try{o=e?e.parse("clientStartupConfiguration"):c.a.parseJsonElementWithId("clientStartupConfiguration")}catch(e){throw new a.a("Failure to parse clientStartupConfiguration from response",e)}if(!o)throw new a.a("clientStartupConfiguration is not present in response");var t=o.authTypeString;"MSA"===t?(o.authType=i.MSA,window.pwaCurrentUserId&&0===window.pwaCurrentUserId.indexOf("consumers_")&&(o.puid=window.pwaCurrentUserId.substring("consumers_".length)),window.userPrincipalName&&(o.userPrincipalName=window.userPrincipalName,o.loginHint=window.userPrincipalName)):o.authType="OrgId"===t?i.OrgId:i.Unknown,o.isV2Auth="2.0"===o.authVersion}return function(e){var t;t=e.length?"https://"+e:window.location.origin,n.p=t+="/bundles/"}(o.cdnDomain),o}!function(e){e[e.MSA=0]="MSA",e[e.OrgId=1]="OrgId",e[e.Unknown=-1]="Unknown"}(i||(i={}));var d=function(){function e(e){this.config=u(e)}return e.ɵprov=l.cc({factory:function(){return new e(l.dc(s.a))},token:e,providedIn:"root"}),e}()},ci1G:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},cj6A:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("QjXU"),r=n("4/We"),o=n("hZW2"),a=n("casz"),s=n("keVe"),c=function(){function e(e,t,n,i){this.capabilitiesService=e,this.documentService=t,this.ngModuleLoader=n,this.scheduler=i,this.routeModuleMap=new Map([["Start","./wac-start/wac-start.module#WacStartModule"],["AppGallery","./app-gallery/app-gallery.module#AppGalleryModule"],["Templates","./templates/templates.module#TemplatesModule"]]),this.preloadedRoutes=new Set,this.prefetchedDns=new Set}return e.prototype.preload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e?this.isOfficeRoute(e)&&this.routeModuleMap.has(e)?[4,this.preloadRoute(e)]:[3,2]:[2];case 1:return t.sent(),[3,3];case 2:e.startsWith("https")&&this.prefetchDns(e),t.label=3;case 3:return[2]}}))}))},e.prototype.isOfficeRoute=function(e){return!e.startsWith("http")},e.prototype.preloadRoute=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return"Start"!==e||this.capabilitiesService.capabilities.wacStartPageEnabled?this.preloadedRoutes.has(e)?[3,3]:(this.preloadedRoutes.add(e),[4,new Promise((function(e){return t.scheduler.scheduleWork(e,3)}))]):[2];case 1:return n.sent(),[4,this.ngModuleLoader.load(this.routeModuleMap.get(e))];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.prefetchDns=function(e){if(!this.prefetchedDns.has(e)){this.prefetchedDns.add(e);var t=new Map([["rel","dns-prefetch"],["href",e]]);this.documentService.addLinkTag(t)}},e.ɵprov=s.cc({factory:function(){return new e(s.dc(r.a),s.dc(o.a),s.dc(s.w),s.dc(a.a))},token:e,providedIn:"root"}),e}()},clUe:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var i=n("QjXU"),r=n("j7b/"),o=n("m32Q"),a=n("lkvL"),s=n("lwUs"),c=n("lrJm"),l=n("3GGT"),u=n("hhzZ"),d=n("R7NL"),p=n("Vwd8"),f=n("BaAg"),h=n("kpuN"),m=n("6nG3"),b=n("W3Zz"),g=n("Z0U4"),v=n("wwmn"),y=n("casz"),S=n("ZtId"),w=n("Brer"),C=n("pOWU"),I=n("4/We"),T=n("cgnd"),k=n("LQqy"),_=n("/I02"),A=n("PBJH"),P=n("JH4S"),E=n("oAX+"),O=n("idgT"),F=n("keVe"),D=n("TOqr"),R=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m,b,g,v,y,S){var w=e.call(this,t,c,l,"OfficeHome",o,u,p,y)||this;return w.capabilitesService=n,w.clientStartupConfigService=i,w.consumerInstallConfigService=r,w.deviceDetector=a,w.globalErrorHandler=s,w.officeRouteService=d,w.startupConfigService=f,w.templatesConfig=h,w.updateContentService=m,w.userContextService=b,w.userProfileService=g,w.locService=v,w.vroomService=S,w.locale=o.sharedContext.officeMarket.toLowerCase(),w.numTemplates=w.templatesConfig.config.numTemplates,w.initializeTemplateCache(),w.requestConfig={headers:new Map},w.templatesStreamMap=new Map,w.enterpriseTemplatesStreamMap=new Map,w.templatesContentStreamMap=new Map,w.deviceInfo=w.deviceDetector.getDeviceInfo(),w}return Object(i.__extends)(t,e),t.prototype.getTemplateContent=function(e,n,i){var r=this;if(this.templatesContentStreamMap.has(e)&&this.templatesContentStreamMap.get(e).has(i))return this.templatesContentStreamMap.get(e).get(i);var o=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_CONTENT_PATH)+"&"+t.templateIdArg+n+"&"+t.templateBinaryUrlArg+i,a=this.fetchTemplateContentData(e,o,n,"cache-only"),s=this.fetchTemplateContentData(e,o,n,"network-first"),c=E.a.createResultsWithCacheObservable(a,s,null,(function(t){r.templatesContentStreamMap.get(e)&&r.templatesContentStreamMap.get(e).delete(i)}));return this.templatesContentStreamMap.get(e)||this.templatesContentStreamMap.set(e,new Map),this.templatesContentStreamMap.get(e).set(i,c),c},t.prototype.getVisioLocalizationLabel=function(e){return this.locService[f.b[e]+"TemplateLabel"]},t.prototype.getTemplatesCollections=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,s,c,l,u=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];n=[],r=[],s={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Promise.all(e.map((function(e){return Object(o.a)({userId:u.clientStartupConfigService.config.puid,collectionName:t.templatesCollectionPersistenceKey,collectionVersion:t.templatesCollectionPersistenceVersion,key:u.getCacheKey(e),plugins:t.templatesPersistencePlugins})})))];case 2:for(n=i.sent(),l=0;l<e.length;++l)n[l]?s[e[l]]=n[l]:r.push(e[l]);return 0===r.length?[2,n]:[3,4];case 3:return i.sent(),r=e,[3,4];case 4:return i.trys.push([4,6,,7]),[4,this.fetchTemplatesCollections(r.join(","))];case 5:for((c=i.sent()).forEach((function(e){e&&e.Templates&&e.Templates.Template&&e.Templates.Template.length>0&&Object(a.a)({userId:u.clientStartupConfigService.config.puid,collectionName:t.templatesCollectionPersistenceKey,collectionVersion:t.templatesCollectionPersistenceVersion,key:u.getCacheKey(e.CollectionId),data:e,plugins:t.templatesPersistencePlugins})})),l=0;l<r.length;++l)s[r[l]]=c[l];return[2,e.map((function(e){return s[e]})).filter((function(e){return!!e}))];case 6:return i.sent(),[2,n.filter((function(e){return!!e}))];case 7:return[3,9];case 8:return[2,[]];case 9:return[2]}}))}))},t.prototype.getTemplatesRecommended=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e&&e.length>0))return[3,8];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(o.a)({userId:this.clientStartupConfigService.config.puid,collectionName:t.templatesRecommendedPersistenceKey,collectionVersion:t.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),plugins:t.templatesPersistencePlugins})];case 2:return(n=i.sent())?[2,n]:[3,4];case 3:return i.sent(),[3,4];case 4:r=this.getTemplatesRecommendedUrl(e),i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.fetchTemplatesRecommended(e,r)];case 6:return(s=i.sent())&&s.Template&&s.Template.length&&Object(a.a)({userId:this.clientStartupConfigService.config.puid,collectionName:t.templatesRecommendedPersistenceKey,collectionVersion:t.templatesRecommendedPersistenceVersion,key:this.getCacheKey(e),data:s,plugins:t.templatesPersistencePlugins}),[2,s];case 7:return i.sent(),[3,8];case 8:return[2,null]}}))}))},t.prototype.getTemplates=function(e){var t=this;if(this.templatesStreamMap.has(e))return this.templatesStreamMap.get(e);var n=this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint),i=this.fetchTemplateData(e,n,"cache-only"),r=this.fetchTemplateData(e,n,"network-first"),o=this.updateContentService.getOrAddUpdateStream(this.getUpdateStreamKey(n),(function(){return t.fetchTemplateData(e,n,"network-first")})),a=E.a.createResultsWithCacheObservable(i,r,o,(function(n){return t.templatesStreamMap.delete(e)}));return this.templatesStreamMap.set(e,a),a},t.prototype.updateTemplates=function(e){return this.templatesFromConfig.delete(e),this.templatesStreamMap.delete(e),this.updateContentService.pushUpdate(this.getUpdateStreamKey(this.getUrl(e,this.templatesConfig.config.templatesApiEndpoint)))},t.prototype.getCreateTemplates=function(){var e=this;if(this.createTemplatesStream)return this.createTemplatesStream;var n=this.startupConfigService.config.authType===T.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+i+"&"+t.authIdArg+n+"&"+t.pageArg+"Other&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+b.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+b.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment,o=this.contextService.sharedContext.officeHomeApiRoot+"/"+this.templatesConfig.config.templatesApiEndpoint+"?"+t.appArg+"Create&"+t.cultureArg+this.locale+"&"+t.limitArg+"20&"+t.isEduArg+this.userContextService.user.isEdu+r,a=this.fetchTemplateData(f.b.None,o,"cache-only"),s=this.fetchTemplateData(f.b.None,o,"network-first"),c=E.a.createResultsWithCacheObservable(a,s,null,(function(t){return e.createTemplatesStream=null}));return this.createTemplatesStream=c,c},t.prototype.getEnterpriseTemplates=function(e,n,i){var r=this;void 0===n&&(n=""),void 0===i&&(i=!1);var o=e.concat(n);if(this.enterpriseTemplatesStreamMap.has(o))return this.enterpriseTemplatesStreamMap.get(o);var a=function(e,n){var o=[];return e&&(o=e.value.filter((function(e){return t.supportedEnterpriseFileTypes.has(f.a.getFileExtension(e.name))||e.folder})).map((function(e){var t=[];if(e.thumbnails.length>0){var n=e.thumbnails[0];t.push(i?{Size:"large",Height:n.large.height,Width:n.large.width,Url:n.large.url,ImageType:"MT"}:{Size:"medium",Height:n.medium.height,Width:n.medium.width,Url:n.medium.url,ImageType:"MT"})}return{AssetId:e.id,Title:e.name,TemplateBinaryUrl:r.capabilitesService.capabilities.pwaEnabled?e.webDavUrl:e.webUrl,Thumbnails:t}}))),{Template:o,fromCache:n}},s=this.vroomService.getDriveItemChildrenWithThumbnails(e,n,"cache-only").then((function(e){return a(e,!0)})),c=this.vroomService.getDriveItemChildrenWithThumbnails(e,n,"network-first","BrowseOrgTemplates","AUO").then((function(e){return a(e,!1)})),l=E.a.createResultsWithCacheObservable(s,c,null,(function(e){return r.enterpriseTemplatesStreamMap.delete(o)}));return this.enterpriseTemplatesStreamMap.set(o,l),l},t.prototype.getRequestIdFromOmexResponse=function(e){return this.getHeaderValue(e.headers,"x-ms-request-id")},t.prototype.getEnterpriseTemplatesLibraries=function(){return this.enterpriseTemplateLibraries||(this.enterpriseTemplateLibraries=this.vroomService.getEnterpriseTemplatesLibraries().then((function(e){var t=[];return e&&(t=e.value.map((function(e){return{DriveId:e.id,ItemId:"",Title:e.name}}))),t}))),this.enterpriseTemplateLibraries},t.prototype.isPaidConsumer=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.clientStartupConfigService.config.authType!==T.a.MSA?[3,2]:[4,this.consumerInstallConfigService.getCurrentSku()];case 1:return[2,null!==(e=t.sent())&&!(e===m.b.NonActive||e===m.b.NotSubscribed||e===m.b.NotDetected||e===m.b.Perpetual||e===m.b.Perpetual2019)];case 2:return[2,!1]}}))}))},t.prototype.handleQueryParam=function(e,t){"mocktemplates"===e&&this.mockRequestHeader&&this.requestConfig.headers.set(this.mockRequestHeader,t)},t.prototype.fetchTemplateContentData=function(e,t,n,r){var o=this;return new Promise((function(a,s){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,c=this;return Object(i.__generator)(this,(function(i){return o=f.a.fileTypeNameFromType(e),this.get("Template_Content_Request","Template_Content",t,(function(e){e.instrument((function(e,t){e.ok&&(e.data?(t.ItemCategory=o,t.ElementId=n):t.HttpCode=l.a.UnexpectedResponse.toString())})).then((function(e){e.data?a(e):s(new C.b(e,"Null template content response"))})).catch((function(e){c.globalErrorHandler.handleError(e)}))}),s,this.requestConfig,r),[2]}))}))}))},t.prototype.fetchTemplatesCollections=function(e){var t=this,n=this.getTemplatesCollectionUrl(e);return new Promise((function(r,o){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(i){return this.get("Templates_Collections_Request","Templates_Collections",n,(function(n){n.instrument((function(t,n){var i;if(t.ok)if(t.data&&t.data.Collections&&t.data.Collections.length>0){var r=null===(i=t.data.Collections[0].Templates)||void 0===i?void 0:i.RequestId;n.ActualSize=t.data.Collections.length.toString(),n.ItemCategory=e,n.RequestId=r}else n.HttpCode=l.a.UnexpectedResponse.toString()})).then((function(e){if(e.data&&e.data.Collections&&0!==e.data.Collections.length){var n=e.data.Collections.map((function(e){return e&&e.Templates&&e.Templates.Value&&e.Templates.Value.length>0?{CollectionId:e.Collection,Title:e.Collection,Templates:{Template:t.setupTemplates(e.Templates.Value,f.b.None),fromCache:!1}}:null}));n&&0!==n.length||o(new C.b(e,"Null templates response")),r(n)}else o(new C.b(e,"Null templates response"))})).catch((function(e){t.globalErrorHandler.handleError(e,"KAzhF")}))}),o,this.requestConfig,"network-only"),[2]}))}))}))},t.prototype.fetchTemplatesRecommended=function(e,n){var r=this;return new Promise((function(o,a){return Object(i.__awaiter)(r,void 0,void 0,(function(){var r,s=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return r=function(t){t.instrument((function(t,n){if(t.ok)if(t.data&&t.data.Templates.Value&&t.data.Templates.Value.length>0){var i=t.data.Templates.RequestId;n.ActualSize=t.data.Templates.Value.length.toString(),n.ItemCategory=e,n.RequestId=i}else n.HttpCode=l.a.UnexpectedResponse.toString()})).then((function(e){if(e.data&&e.data.Templates&&0!==e.data.Templates.Value.length){var t={Template:s.setupTemplates(e.data.Templates.Value,f.b.None),fromCache:!1};t&&0!==t.Template.length||a(new C.b(e,"Null templates response")),o(t)}else a(new C.b(e,"Null templates response"))})).catch((function(e){s.globalErrorHandler.handleError(e,"KlVan")}))},[4,this.isPaidConsumer()];case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Recommended_Request","Templates_Recommended",n,r,a,this.requestConfig,"network-only"),[2]}}))}))}))},t.prototype.fetchTemplateData=function(e,n,r){var o=this;return new Promise((function(a,s){return Object(i.__awaiter)(o,void 0,void 0,(function(){var o,c,u=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.templatesFromConfig.has(e)?(a({Template:this.templatesFromConfig.get(e),fromCache:"cache-only"===r}),[2]):(o=f.a.fileTypeNameFromType(e),c=function(t){t.instrument((function(e,t){e.ok?e.data&&e.data.Templates&&e.data.Templates.Value?(t.ActualSize=e.data.Templates.Value.length.toString(),t.ItemCategory=o,t.RequestId=e.data.Templates.RequestId):(t.HttpCode=l.a.UnexpectedResponse.toString(),t.Error="Null templates response"):t.Error=e.statusText})).then((function(t){if(t.data&&t.data.Templates&&t.data.Templates.Value){var n=u.setupTemplates(t.data.Templates.Value,e);a({Template:n,fromCache:t.fromCache})}else s(new C.b(t,"Null templates response"))})).catch((function(e){u.globalErrorHandler.handleError(e,"TFeVI")}))},[4,this.isPaidConsumer()]);case 1:return i.sent()&&(n+=t.isPremiumString),this.get("Templates_Request","Templates",n,c,s,this.requestConfig,r),[2]}}))}))}))},t.prototype.initializeTemplateCache=function(){var e=this;this.templatesFromConfig=new Map,this.templatesConfig.getTemplatesInfoPromise().then((function(t){if(t){var n=f.a.fileTypeNameToFileType(t.Application);if(n!==f.b.Unknown){var i=e.setupTemplates(t.Templates.Value,n);e.templatesFromConfig.set(n,i)}}}))},t.prototype.setupTemplates=function(e,t){var n,r;if(t===f.b.Visio)try{for(var o=Object(i.__values)(e),a=o.next();!a.done;a=o.next()){var s=a.value;s.Categories.length&&(s.Title=s.Categories[0].LocalizedTitle)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e.reduce((function(e,t){return void 0!==t.AssetId&&(t.IsBlank=!1,e.push(t)),e}),[])},t.prototype.getUpdateStreamKey=function(e){return"templates-"+e},t.prototype.getUrl=function(e,n){var i=this.numTemplates;[f.b.VisioBusinessWac,f.b.VisioFlowChartWac,f.b.VisioGeneralWac,f.b.VisioNetworkWac,f.b.VisioSoftwareWac].lastIndexOf(e)>=0&&(i=this.templatesConfig.config.numVisioTemplates);var r=this.officeRouteService.getRouteItemForCurrentLocation(),o=!r||"Start"!==r.route&&"Templates"!==r.route?"Other":r.route+"Page",a=this.startupConfigService.config.authType===T.a.OrgId?2:1,s=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),c="&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.flightsArg+s+"&"+t.authIdArg+a+"&"+t.pageArg+o+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.browserNameArg+b.a[this.deviceInfo.browser.browserType]+"&"+t.osNameArg+b.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion+"&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment;return this.contextService.sharedContext.officeHomeApiRoot+"/"+n+"?"+t.appArg+f.b[e]+"&"+t.cultureArg+this.locale+"&"+t.limitArg+(i-1)+"&"+t.isEduArg+this.userContextService.user.isEdu+c},t.prototype.getTemplatesCollectionUrl=function(e){return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_COLLECTION_PATH)+"?"+t.collectionsArg+e+"&"+t.cultureArg+this.locale},t.prototype.getTemplatesRecommendedUrl=function(e){var n=this.startupConfigService.config.authType===T.a.OrgId?2:1,i=this.startupConfigService.config.sharedClientStartupContext.flights.replace(/,\s*$/,""),r="&"+t.browserNameArg+b.a[this.deviceInfo.browser.browserType]+"&"+t.flightsArg+i+"&"+t.isIwArg+this.userContextService.user.isIw+"&"+t.isAdminArg+this.userContextService.user.isAdmin+"&"+t.isSmbArg+this.userContextService.user.isSmb+"&"+t.isEduFacultyArg+this.userContextService.user.isEduFaculty+"&"+t.isEduStudentArg+this.userContextService.user.isEduStudent+"&"+t.authIdArg+n+"&"+t.firstVisitAgeInWeeksArg+Math.floor(this.userProfileService.fullDaysSinceFirstVisit()/7)+"&"+t.pageArg+"Create&"+t.deploymentEnvironmentArg+this.startupConfigService.config.sharedClientStartupContext.deploymentEnvironment+"&"+t.osNameArg+b.d[this.deviceInfo.platform.platformType]+"&"+t.osVersionArg+this.deviceInfo.platformVersion;return this.contextService.sharedContext.officeHomeApiRoot+"/"+(this.templatesConfig.config.templatesApiEndpoint+t.TEMPLATES_RECOMMENDED_PATH)+"?"+t.cultureArg+this.locale+"&"+t.appsArg+e+"&"+t.limitArg+"200"+r},t.prototype.getCacheKey=function(e){return e+"_"+this.locale},t.TEMPLATES_COLLECTION_PATH="/collections",t.TEMPLATES_RECOMMENDED_PATH="/recommended",t.TEMPLATES_CONTENT_PATH="/content",t.collectionsArg="collections=",t.cultureArg="culture=",t.appArg="app=",t.appsArg="apps=",t.limitArg="show=",t.isEduArg="isEdu=",t.flightsArg="flights=",t.isIwArg="isIw=",t.isAdminArg="isAdmin=",t.isSmbArg="isSmb=",t.isEduFacultyArg="isEduFaculty=",t.isEduStudentArg="isEduStudent=",t.authIdArg="authId=",t.pageArg="page=",t.firstVisitAgeInWeeksArg="firstVisitAgeInWeeks=",t.browserNameArg="browserName=",t.osNameArg="osName=",t.osVersionArg="osVersion=",t.deploymentEnvironmentArg="deploymentEnvironment=",t.isPremiumString="&isPremium=1",t.templateIdArg="id=",t.templateBinaryUrlArg="templateBinaryUrl=",t.supportedEnterpriseFileTypes=new Set(["pptx","potx","dotx","xltx"]),t.templatesCollectionPersistenceKey="templates-collection-api",t.templatesCollectionPersistenceVersion=5,t.templatesPersistencePlugins=[Object(s.a)(7*r.a)],t.templatesRecommendedPersistenceKey="templates-recommended-api",t.templatesRecommendedPersistenceVersion=3,t.ɵprov=F.cc({factory:function(){return new t(F.dc(h.b),F.dc(I.a),F.dc(T.b),F.dc(k.a),F.dc(_.a),F.dc(b.b),F.dc(c.b),F.dc(u.a),F.dc(d.a),F.dc(v.a),F.dc(g.a),F.dc(D.q),F.dc(T.b),F.dc(O.a),F.dc(S.a),F.dc(P.a),F.dc(p.b),F.dc(A.a),F.dc(y.a),F.dc(w.a))},token:t,providedIn:"root"}),t}(C.a)},cy7S:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("kb6k"),o=n("lAHu");function a(e,t,n,a,s,c,l,u,d,p,f){void 0===f&&(f={});var h=Object(i.__assign)(Object(i.__assign)({},s),{url:n,method:"PUT",body:a});return Object(r.a)((function(n){return Object(o.a)(e,t,n,u,d,void 0,f.populateRequestEvent,f.onUploadProgress,f.onDownloadProgress,f.cancellationToken,f.timeoutInMs)}),e,t,h,c,l,p,f.mockParam,f.resourceUrl,f.rpsHeaderPrefix,f.additionalAuthErrors,f.isRetriableError,f.updateRequestWithAuth)}},dFxn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("lrJm"),r=n("ZJrL"),o=n("keVe"),a=function(){function e(e){this.globalErrorHandler=e}return e.prototype.parse=function(e){try{return r.a.parseJsonElementWithId(e)}catch(n){var t=new i.a("Failure to parse "+e+" from response",n);this.globalErrorHandler.handleError(t)}return null},e.ɵprov=o.cc({factory:function(){return new e(o.dc(o.m))},token:e,providedIn:"root"}),e}()},dOgD:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var i=n("lrJm"),r=n("hhzZ"),o=n("R7NL"),a=n("QOOv"),s=n("kpuN"),c=n("pd4Y"),l=n("Z0U4"),u=n("wwmn"),d=n("casz"),p=n("ZtId"),f=n("BMb5"),h=n("4/We"),m=n("cgnd"),b=n("/I02"),g=n("PBJH"),v=n("QjXU"),y=n("kaEK"),S=n("9260"),w=n("BaAg"),C=n("RR/o"),I=n("pOWU"),T=n("uUrA"),k=n("CVeG"),_=n("oAX+"),A=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m){var b=e.call(this,t,r,o,"Substrate",i,s,l,f)||this;b.capabilitiesService=n,b.locService=a,b.mruConfigService=c,b.globalErrorHandler=u,b.startupConfigService=d,b.updateContentService=p,b.dateService=h,b.windowService=m,b.fetchRequestIndex=0;var g=b.capabilitiesService.capabilities;return b.scenario=g.suggestedActionsEnabled?"OfficeSuggestedActions":g.pwaEnabled?"OfficeComApp":"OfficeComHome",b.section=g.suggestedActionsEnabled?"OfficeSuggestedActions":"OfficeComHome",b.application=g.pwaEnabled?"OfficeComApp":"OfficeComHome",b.baseUrl=b.inMockMode?b.contextService.sharedContext.officeHomeApiRoot:""+b.mruConfigService.config.substrateApiEndpoint,b.officeFeedDataStreams=new Map,b.regExp=new RegExp("{([0-9]+)}"),b.feedFlight=b.mruConfigService.config.officeFeedFlightEnabled,b.startupConfig=b.startupConfigService.config,b.tamyDataStreamMap=new Map,b}return Object(v.__extends)(t,e),t.prototype.getOfficeFeed=function(){var e=this,n="",i=this.mruConfigService.config;n=i.useFeedS2SApi?this.contextService.sharedContext.officeHomeApiRoot+"/api/officefeed?"+t.locParam+this.contextService.sharedContext.officeMarket+"&feedFlight="+this.getFeedFlight():this.baseUrl+"/PeoplePredictionsB2/MicrosoftFeed?section="+this.section+"&"+t.locParam+this.contextService.sharedContext.officeMarket+"&"+t.newSchema+this.mruConfigService.config.officeFeedNewSchemaEnabled;var r=this.startupConfig.sharedClientStartupContext.flights.toLowerCase(),o=[],a=this.capabilitiesService.capabilities;if(a.threeSRDLEnabled?o.push("OfficeComHome3SRDLParity"):a.threeSMRERDLEnabled&&o.push("OfficeComHome3SMRERDL"),i.officeFeedFlightControlName&&i.officeFeedFlightName&&(r.includes(i.officeFeedFlightControlName.toLowerCase())?o.push(i.officeFeedExperimentControlName):r.includes(i.officeFeedFlightName.toLowerCase())&&o.push(i.officeFeedExperimentName)),i.officeFeedFlight2ControlName&&i.officeFeedFlight2Name&&(r.includes(i.officeFeedFlight2ControlName.toLowerCase())?o.push(i.officeFeedExperiment2ControlName):r.includes(i.officeFeedFlight2Name.toLowerCase())&&o.push(i.officeFeedExperiment2Name)),i.officeFeedFlight3ControlName&&i.officeFeedFlight3Name&&(r.includes(i.officeFeedFlight3ControlName.toLowerCase())?o.push(i.officeFeedExperiment3ControlName):r.includes(i.officeFeedFlight3Name.toLowerCase())&&o.push(i.officeFeedExperiment3Name)),o.length>0&&(n+="&experiment="+o.join("&experiment=")),this.officeFeedDataStreams.has(n))return this.officeFeedDataStreams.get(n);var s=this.updateContentService.getOrAddUpdateStream("officefeed-"+n,(function(){return e.fetchOfficeFeed("network-first",n,i.useFeedS2SApi)})),c=this.capabilitiesService.capabilities.prefetchDataEnabled?this.prefetchOfficeFeed(n,i.useFeedS2SApi):this.fetchOfficeFeed("network-first",n,i.useFeedS2SApi),l=_.a.createResultsWithCacheObservable(this.fetchOfficeFeed("cache-only",n,i.useFeedS2SApi),c,s,(function(t){return e.officeFeedDataStreams.delete(n)}));return this.officeFeedDataStreams.set(n,l),l},t.prototype.getTamyDocuments=function(e,n){var i=this,r=this.mruConfigService.config.supportedFileTypes,o=n&&n.size?r.filter((function(e){return n.has(w.a.fileTypeNameToFileType(e))})):r,a=o.reduce((function(e,t,n){return e+(n>0?" or ":"")+"resourceVisualization/Type eq '"+t+"'"}),""),s=t.tamyPath,c="$top="+e+"&$filter="+encodeURIComponent(a),l="?"+t.tamyQueryParams+"&"+c,u=this.inMockMode?""+this.contextService.sharedContext.officeHomeApiRoot+s+"/trending"+l:""+this.mruConfigService.config.substrateApiEndpoint+s+l;if(this.tamyDataStreamMap.has(u))return this.tamyDataStreamMap.get(u);var d=this.fetchOfficeFeed("cache-only",u,!1,0,"Trending",!0,o),p=this.fetchOfficeFeed("network-first",u,!1,0,"Trending",!0,o),f=_.a.createResultsWithCacheObservable(d,p,null,(function(e){return i.tamyDataStreamMap.delete(u)}));return this.tamyDataStreamMap.set(u,f),f},t.prototype.logInstrumentation=function(e,t,n,i){var r=this;return new Promise((function(o,a){for(var s=(r.inMockMode?r.contextService.sharedContext.officeHomeApiRoot:r.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/Feedback",c=[],l=0;l<e.length;l++)c.push({FeedbackId:e[l],Action:t[l],ItemSource:n[l],Target:i?i[l]:"",Timestamp:new Date(Date.now()).toISOString()});var u={Actions:c},d=r.createRequestConfig(r.startupConfig.sharedClientStartupContext.correlationId,"Feedback");r.post("OfficeFeedInstrumentation","OfficeFeedInstrumentation",s,u,(function(e){e.instrument((function(e,t){t.ItemCategory=c.map((function(e){return e.Action})).join(","),t.RequestId=r.getRequestIdFromResponse(e)})).then((function(){return o(null)}))}),a,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r.mruConfigService.config.deferFeedWrite?4:0)}))},t.prototype.performAction=function(e,t,n){var i=this;return new Promise((function(r,o){var a=(i.inMockMode?i.contextService.sharedContext.officeHomeApiRoot:i.mruConfigService.config.substrateApiEndpoint)+"/peoplepredictionsb2/v2/myanalyticsaction",s={FeedbackId:e,Action:t,ActionPayload:n},c=i.createRequestConfig(i.startupConfigService.config.sharedClientStartupContext.correlationId,"Feedback");i.post("OfficeFeedAction","OfficeFeedAction",a,s,(function(e){e.instrument((function(e,t){t.ItemCategory=s.Action})).then((function(){return r(!0)}))}),o,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,0)}))},t.prototype.getStreamsThumbnail=function(e){var t=this;this.inMockMode&&(e=this.contextService.sharedContext.officeHomeApiRoot+"/StreamsThumbnail");var n=new FileReader;return new Promise((function(i,r){var o=t.createRequestConfig(t.startupConfig.sharedClientStartupContext.correlationId,"StreamsThumbnail","blob");t.get("OfficeFeed_Stream_Thumbnail_Request","OfficeFeed_Stream_Thumbnail",e,(function(e){e.then((function(e){e&&e.data?(n.onloadend=function(){var e=n.result&&"string"==typeof n.result&&n.result||"";i(e.length>0?e:null)},n.onerror=function(){return i(null)},n.onabort=function(){return i(null)},n.readAsDataURL(e.data)):i(null)})).catch((function(e){t.globalErrorHandler.handleError(e,"AfEUN")}))}),r,o,"network-only")}))},t.prototype.handleQueryParam=function(e,t,n){"mockofficefeed"===e&&this.mockRequestHeader&&n.headers.set(this.mockRequestHeader,t)},t.prototype.prefetchOfficeFeed=function(e,t){var n=this;return this.windowService.nativeWindow.prefetchRecommendedDataPromise?this.windowService.nativeWindow.prefetchRecommendedDataPromise.then((function(e){return e?{items:((n.mruConfigService.config.officeFeedNewSchemaEnabled?e.items:e)||[]).map((function(e){return n.convertItemToMruDataItem(e)})).filter((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)})),impressionId:e.recommendedRequestId||"",fromCache:!1}:Promise.reject("Prefetch failed")})):this.fetchOfficeFeed("network-first",e,t)},t.prototype.fetchOfficeFeed=function(e,n,i,o,a,s,c){var l=this;return new Promise((function(u,d){var p=T.a.createGuid(),f=l.createRequestConfig(p,a||"MicrosoftFeed"),h="MicrosoftFeedSPNF"===a;l.get(s?"Trending_Around_Me_Request":"OfficeFeedRequest",s?"Trending_Around_Me":"OfficeFeedRequest",n,(function(i){i.instrument((function(i,o){if(o.RequestId=l.getRequestIdFromResponse(i),o.Index=(l.fetchRequestIndex++).toString(),o.ImpressionId=!!i.headers&&i.headers.get(S.a.clientRequestIdHeader)||p,o.ApiLatency=(!!i.headers&&i.headers.get(t.e2eLatencyHeader)||-1).toString(),i.ok&&i.data&&!h){var a=l.mruConfigService.config.officeFeedNewSchemaEnabled?i.data.items:i.data;if(a){var s=a.length;o.ResourceIdDistribution=a.map((function(e){return e.sharePointIds&&e.sharePointIds.listItemUniqueId?e.sharePointIds.listItemUniqueId:""})).toString(),o.OfficeFeedCategoryDistribution=a.map((function(e){return e.category})).toString(),o.ActualSize=s.toString()}}else"cache-only"===e&&401===i.status&&(o.OfficeFeedUrl=r.a.filterPii(n),o.OfficeFeedAuthenticateHeader=i.headers.get("WWW-Authenticate"))})).then((function(t){if(h)u(null);else{var n=t&&t.data&&(l.mruConfigService.config.officeFeedNewSchemaEnabled?t.data.items:t.data)||[];c&&c.length>0&&(n=n.filter((function(e){return c.includes(e.subCategory)})));var i=n.map((function(e){return l.convertItemToMruDataItem(e,s)})),r=s?i:i.filter((function(e){var t;return e&&(null===(t=e.Activity)||void 0===t?void 0:t.formatString)}));u({items:r,impressionId:!!t.headers&&t.headers.get(S.a.clientRequestIdHeader)||p,fromCache:"cache-only"===e})}})).catch((function(e){l.globalErrorHandler.handleError(e,"AfEUN")}))}),d,f,e,null,null,null,i?"OfficeHome":"Substrate",null,o)}))},t.prototype.createRequestConfig=function(e,t,n){var i={headers:new Map([["ScenarioTag",""+this.scenario+t],["Content-Type","application/json"],["X-OfficeFeedFlight",this.getFeedFlight()],["X-AnchorMailbox","Oid:"+this.startupConfig.objectId+"@"+this.startupConfig.tenantId],["X-Application",this.application],["X-ApplicationScenario",this.scenario],["X-RoutingParameter-SessionKey",this.startupConfig.objectId],[S.a.clientRequestIdHeader,e]])};return n&&(i.responseType=n),i},t.prototype.getFeedFlight=function(){return this.feedFlight?"experiment":"evaluation"},t.prototype.convertItemToMruDataItem=function(e,t){return void 0===t&&(t=!1),"file"===e.category.toLowerCase()||"video"===e.category.toLowerCase()?this.convertFileToMruDataItem(e,t):"newsarticle"===e.category.toLowerCase()?this.convertNewsItemToMruDataItem(e):"upcomingmeeting"===e.category.toLowerCase()&&this.mruConfigService.config.upcomingMeetingEnabled?this.convertUpcomingMeetingToMruDataItem(e):"myanalyticsinsight"===e.category.toLowerCase()&&this.mruConfigService.config.myAnalyticsEnabled?this.convertMyAnalyticsToMruDataItem(e):null},t.prototype.convertMyAnalyticsToMruDataItem=function(e){var t,n,i,r=(null===(t=(e.inclusionReasons&&e.inclusionReasons[0]).actors[0])||void 0===t?void 0:t.User)||{},o=r.DisplayName,a={formatString:o,plainText:o,people:[{upn:r.email,tag:"c0",name:r.DisplayName}],reasonType:y.a.MyAnalytics,timestamp:e.createdDateTime?new Date(e.createdDateTime):null},s='"'+(null===(n=e.previewInfo)||void 0===n?void 0:n.text)+'"',c=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:e.name,Title:e.name,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:c,FileType:"MyAnalytics",PathArray:null,Provenance:w.f[w.f.Substrate],ResourceId:"",UrlAlreadyEncoded:!0,Activity:a,ThumbnailUrl:null,FeedbackId:e.feedbackId,TaskInsight:e.taskInsight,PotentialAction:e.potentialActions,Actor:r,InsightName:e.insightName,InsightDescription:s,InsightDescriptionPrefix:this.getInsightDescriptionPrefix(null===(i=e.taskInsight)||void 0===i?void 0:i.actionType)}},t.prototype.getInsightDescriptionPrefix=function(e){var t=this.locService.YouSaid;return"FollowUp"===e||"FollowUpActionRequest"===e||"FollowUpReplyRequest"===e?t=this.locService.YouAsked:"Commitment"===e?t=this.locService.YouSaid:"Request"===e&&(t=this.locService.TheyAsked),t},t.prototype.convertUpcomingMeetingToMruDataItem=function(e){var t,n,i,r,o,a,s,c=e.upcomingMeetingInfo,l=null!==(t=new Date(c.start))&&void 0!==t?t:null,u=this.dateService.timespanInSeconds(l),d="TeamsForBusiness"===(null===(n=c.onlineMeeting)||void 0===n?void 0:n.onlineMeetingProvider),p=null!==(i=new Date(e.expiresAt))&&void 0!==i?i:null,f=new Date,h=e.itemGroups&&e.itemGroups.length>0&&-1!==e.itemGroups.indexOf("MeetingOnlineAttending");if(!this.inMockMode&&p&&f>p)return null;var m=u>0,b=m?this.locService.OfficeFeedYourUpcomingMeetingStarted:this.locService.OfficeFeedYourUpcomingMeeting;!m&&u>-60&&(b=this.locService.OfficeFeedYourUpcomingMeetingHappeningNow);var g=d?this.locService.JoinTeamsMeeting:this.locService.SuggestedActionJoinMeeting,v={formatString:b,plainText:b,people:null,reasonType:y.a.Meeting,timestamp:null!==(r=new Date(c.start))&&void 0!==r?r:null};return{Application:null,Category:e.category,DocId:null,DriveId:null,FileName:null,Title:null===(o=e.previewInfo)||void 0===o?void 0:o.text,Url:e.webUrl,WebUrl:e.webUrl,LastAccessedTime:l,FileType:"UpcomingMeeting",PathArray:null,Provenance:w.f[w.f.Substrate],UrlAlreadyEncoded:!0,Activity:v,FeedbackId:e.feedbackId,Attendees:c.attendees,Subject:c.subject,JoinUrl:null===(a=c.onlineMeeting)||void 0===a?void 0:a.joinUrl,MeetingStart:this.locService.formatTimeFromDate(new Date(c.start)),MeetingEnd:this.locService.formatTimeFromDate(new Date(c.end)),Location:null===(s=c.location)||void 0===s?void 0:s.displayName,Organizer:c.organizer,JoinMeetingText:g,IsUpcomingMeetingAccepted:h,IsTeamsMeeting:d}},t.prototype.convertNewsItemToMruDataItem=function(e){var t,n=this.locService.format(this.locService.OfficeFeedPostedBy,e.newsArticleInfo&&e.newsArticleInfo.byLine||""),i=this.locService.format(this.locService.OfficeFeedPostedBy,"<c0>"+(e.newsArticleInfo&&e.newsArticleInfo.byLine||"")+"</c0>"),r=e.createdBy&&e.createdBy.User||{},o={formatString:i,plainText:n,people:[{upn:r.Id,tag:"c0",name:r.DisplayName}],reasonType:y.a.News,timestamp:e.newsArticleInfo.firstPublishedDateTime?new Date(e.newsArticleInfo.firstPublishedDateTime):null},a=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null;return{Application:null,Category:e.category,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,FileName:e.name,Title:e.name,Url:e.uri,WebUrl:e.webUrl,LastAccessedTime:a,FileType:"NewsArticle",PathArray:e.containerInfo?[e.containerInfo.displayName]:null,Provenance:w.f[w.f.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:o,ThumbnailUrl:null===(t=e.previewInfo)||void 0===t?void 0:t.image,FeedbackId:e.feedbackId}},t.prototype.convertOfficeFeedActivityToActivityDescription=function(e){for(var t=e.reason||"",n=null,i=function(){var i=n[1];t=t.replace(n[0],(function(){return"<c"+i+">"+e.actors[i].User.DisplayName+"</c"+i+">"}))};null!==(n=this.regExp.exec(t));)i();return{formatString:t,plainText:k.a.stripTags(t),people:(e.actors||[]).map((function(e,t){return{upn:e&&e.User.email,tag:"c"+t,name:e.User.DisplayName}})),reasonType:"popularVideoInclusionReason"===e.kind?y.a.Trending:"meetingRecordingInclusionReason"===e.kind?y.a.Video:this.convertReasonTypeToActivityReason(e.inclusionKind),timestamp:e.dateTime?new Date(e.dateTime):null}},t.prototype.convertReasonTypeToActivityReason=function(e){return C.b.convertMruReasonTypeToActivityReason(C.a[e])},t.prototype.convertFileToMruDataItem=function(e,t){var n,i,r,o,a,s;void 0===t&&(t=!1);var c=e.lastModifiedDateTime?new Date(e.lastModifiedDateTime):null,l=e.sharePointIds,u=l&&{list_id:l.listId,list_item_unique_id:l.listItemUniqueId,site_id:l.siteId,site_url:null,web_id:l.webId},d=e.inclusionReasons&&e.inclusionReasons[0],p=void 0,f=void 0,h=void 0,m=!1,b=null;d&&!t&&(h=this.convertOfficeFeedActivityToActivityDescription(d),this.capabilitiesService.capabilities.recommendedTeamsLinkEnabled&&(p=d.sharingWebUrl),this.capabilitiesService.capabilities.recommendedDeepLinkEnabled&&(f=d.navigationId),(m="EmailAttachment"===d.inclusionKind)&&(b={AttachmentType:1,ConversationId:"",Subject:d.conversationSubject||""}));var g=m,v=this.fileType(e);v!==w.b.MeetingNotes&&v!==w.b.Whiteboard||(g=!0);var y="video"===e.category.toLowerCase()?"StreamsVideo":"Document",S="StreamsVideo"===y?null===(n=e.video)||void 0===n?void 0:n.mediaDuration:void 0,C="StreamsVideo"===y||"Custom"===e.subCategory?e.previewInfo.image:void 0,I=g?e.webUrl:e.uri;return{Application:w.b[v],Category:y,DocId:e.oneDriveItemInfo&&e.oneDriveItemInfo.itemId,DriveId:e.oneDriveItemInfo&&e.oneDriveItemInfo.driveId,Extension:(null===(i=null==e?void 0:e.file)||void 0===i?void 0:i.extension)||w.a.getFileExtensionFromUrl(I),FileName:e.name,Title:e.name,Url:I,WebUrl:e.webUrl,LastAccessedTime:c,FileType:w.b[v],PathArray:null!==(a=this.getPathArray(null===(r=e.containerInfo)||void 0===r?void 0:r.kind,null===(o=e.containerInfo)||void 0===o?void 0:o.displayName))&&void 0!==a?a:null,Provenance:w.f[w.f.Substrate],ResourceId:e.sharePointIds?e.sharePointIds.listItemUniqueId:"",UrlAlreadyEncoded:!0,Activity:h,SharepointInfo:u,IsEmailAttachment:m,EmailReference:b,IsCollab:e.is_collab,FeedbackId:e.feedbackId,NavigationId:f,TeamsDeepLink:p,ThumbnailUrl:C,MediaDuration:S,IconUrl:null===(s=e.appInfo)||void 0===s?void 0:s.iconUrl}},t.prototype.fileType=function(e){var t,n=w.a.fileTypeNameToFileType(e.subCategory);return n&&n!==w.b.None?n===w.b.OneNote&&"note"===(null===(t=e.file)||void 0===t?void 0:t.extension)&&(n=w.b.MeetingNotes):n=w.b.Unknown,n},t.prototype.getPathArray=function(e,t){return t?this.isOneDrive(e)&&t?[this.locService.format(this.locService.EdgeworthFilePathTitle,t)]:[t]:null},t.prototype.isOneDrive=function(e){var t=null==e?void 0:e.toLocaleLowerCase();return"onedrive"===t||"onedrivebusiness"===t},t.locParam="rs=",t.newSchema="forceNewSchema=",t.e2eLatencyHeader="x-end2endlatencyms",t.tamyPath="/PeoplePredictionsB2/MicrosoftFeed",t.tamyQueryParams="section=OfficeHomeTrending&scenario=OfficeHomeTrending",t}(I.a),P=n("keVe"),E=n("TOqr"),O=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d,p,f,h,m){var b=this;this.officefeedService=new A(e,p,i,n,t,f,r,o,a,s,c,u,d,h,m),l.subscribeToRouteChangeStart((function(e){e.currentRoute&&(o.config.officeFeedControlEnabled||o.config.officeFeedFlightEnabled)&&b.warmDocumentCache(e.currentRoute)}))}return e.prototype.getOfficeFeedService=function(){return this.officefeedService},e.prototype.warmDocumentCache=function(e){switch(e.route){case"OfficeHome":case"Pwa":this.officefeedService.getOfficeFeed()}},e.ɵprov=P.cc({factory:function(){return new e(P.dc(s.b),P.dc(o.a),P.dc(r.a),P.dc(b.a),P.dc(u.a),P.dc(a.a),P.dc(E.q),P.dc(i.b),P.dc(m.b),P.dc(l.a),P.dc(p.a),P.dc(d.a),P.dc(h.a),P.dc(g.a),P.dc(c.a),P.dc(f.b))},token:e,providedIn:"root"}),e}(),F=function(){function e(){}return e.ɵprov=P.cc({factory:function(){return function(e){return e.getOfficeFeedService()}(P.dc(O))},token:e,providedIn:"root"}),e}()},dQLD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("odspConfig")||{odspProvisioningCheckIntervals:null,odspProvisioningPendingImage:null,odspProvisioningStatusApiPath:null}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},dSKW:function(e,t,n){"use strict";function i(e){return e?"MyContent"===e?"Default":e.endsWith("Start")?"Start":e.endsWith("Templates")?"Templates":e.endsWith("Content")?"Content":"SearchPersonScoped"===e?"Person":"SearchSiteScoped"===e?"Site":"FormsGroupForms"===e?"GroupForms":"FormsMyForms"===e?"MyForms":"Default":"Other"}function r(e){return e?"MyContent"===e?e:e.endsWith("Start")||e.endsWith("Templates")||e.endsWith("Content")?e.replace("Start","").replace("Templates","").replace("Content",""):e.startsWith("Search")?"Search":e.startsWith("Forms")?"Forms":"OfficeHome"===e?"Home":e:""}function o(e){var t="Pwa"===(null==e?void 0:e.route)?"OfficeHome":null==e?void 0:e.route,n=void 0!==t?""+((null==e?void 0:e.app)?e.app:"")+t:void 0;return void 0!==n?n:"Unknown"}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},dmOj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("BaAg"),r=n("dFxn"),o=n("keVe"),a=function(){function e(e){var t=this,n=e.parse("titlesConfig");this.appTitleInfo=new Map,n&&n.appTitleConfigs&&(this.defaultTitle=n.defaultTitle,this.defaultIcon=n.defaultIcon,this.galleryTitle=n.galleryTitle,n.appTitleConfigs.forEach((function(e){t.appTitleInfo.set(i.a.fileTypeNameToFileType(e.app),e)})))}return e.prototype.getTitle=function(e,t){return e&&e.app&&this.appTitleInfo.has(e.app)?t||this.appTitleInfo.get(e.app).title:"AppGallery"===e.route?this.galleryTitle:this.defaultTitle},e.prototype.getFavicon=function(e){return e&&e.app&&this.appTitleInfo.has(e.app)&&this.appTitleInfo.get(e.app).icon||this.defaultIcon},e.ɵprov=o.cc({factory:function(){return new e(o.dc(r.a))},token:e,providedIn:"root"}),e}()},dvrM:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var i=n("keVe"),r=n("pzhl"),o=n("PkQn"),a=n("4/We"),s=n("W0EU"),c=i.xb({encapsulation:2,styles:[],data:{}});function l(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,4,"span",[["class","alert-message"]],null,null,null,null,null)),(e()(),i.zb(1,0,null,null,1,"ohp-icon-font",[["cssClass","alert-message__icon"],["iconFontName","Alert"]],null,null,null,r.b,r.a)),i.yb(2,638976,null,0,o.a,[a.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null),(e()(),i.zb(3,0,null,null,1,"span",[["class","alert-message__text"]],null,null,null,null,null)),(e()(),i.Yb(4,null,["",""]))],(function(e,t){e(t,2,0,"alert-message__icon","Alert")}),(function(e,t){e(t,4,0,t.component.message)}))}i.vb("ohp-alert-message",s.a,(function(e){return i.bc(0,[(e()(),i.zb(0,0,null,null,1,"ohp-alert-message",[],null,null,null,l,c)),i.yb(1,49152,null,0,s.a,[],null,null)],null,null)}),{message:"message"},{},[])},dx17:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("QjXU"),r=n("kaEK"),o=n("L/Tc"),a=n("QOOv"),s=n("pd4Y"),c=n("uH9+"),l=n("cgnd"),u=n("PBJH"),d=n("CVeG"),p=n("keVe"),f=function(){function e(e,t,n,i,r){this.timestampFormatService=t,this.locService=n,this.mruConfigService=i,this.dateService=r,this.userEmail=e.config.userPrincipalName}return e.prototype.activityDescription=function(e,t,n,i){if(void 0===i&&(i=!1),!e||0===e.length)return null;e=this.filterActivities(e,t);for(var r=new Map,a=0;a<e.length;a++){var s=e[a],c=s.action.type;r.has(c)?r.get(c).push(s):r.set(c,[s])}return r.has(o.a.Mention)?this.createMentionDescription(r.get(o.a.Mention),n,i):r.has(o.a.Comment)?this.createCommentDescription(r.get(o.a.Comment),n,i):r.has(o.a.Edit)?this.createEditDescription(r.get(o.a.Edit),n,i):null},e.prototype.displayedActivityType=function(e,t,n){if(!e||0===e.length)return o.a.None;n&&(e=this.filterActivities(e,t));for(var i=0,r=0,a=0,s=0;s<e.length;s++){var c=e[s].action.type;c===o.a.Mention?i++:c===o.a.Comment?r++:c===o.a.Edit&&a++}return i>0?o.a.Mention:r>0?o.a.Comment:a>0?o.a.Edit:o.a.None},e.prototype.filterActivities=function(e,t){var n=this;return e?e.filter((function(e){if(e&&e.action&&e.timestamp&&e.actor&&e.actor.user&&e.actor.user.email&&e.actor.user.displayName){var i=e.action;if(t&&e.timestamp<t)return!1;if(n.isCurrentUser(e.actor.user))return!1;if(i.type===o.a.Mention&&i.data){var r=i.data.mentionees;return r&&r.filter((function(e){return e&&e.user&&n.isCurrentUser(e.user)})).length>0}return i.type!==o.a.Unknown}return!1})):[]},e.prototype.isCurrentUser=function(e){return e&&(!!e.self||e.userPrincipalName===this.userEmail)},e.prototype.createMentionDescription=function(e,t,n){if(!e||!e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,s=i.timestamp,c=this.formatStringWithTime(s,"Mentioned",t,n,[a.displayName],o-1);return{formatString:c,plainText:d.a.stripTags(c),people:[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}],reasonType:r.a.Mention,timestamp:s}},e.prototype.createCommentDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=i.action.data,a=i.actor.user,s=i.timestamp,c="",l=null;if(e.length>1){var u=this.numDistinctActors(e);c=this.formatStringWithTime(s,"Commented",t,n,[a.displayName],u-1),l=[{upn:a.email,tag:"c0",name:a.displayName}]}else if(o&&o.isReply&&o.parentAuthor&&o.parentAuthor.user.displayName&&o.parentAuthor.user.email){var p=o.parentAuthor.user;this.isCurrentUser(p)?(c=this.formatStringWithTime(s,"RepliedYourComment",t,n,[a.displayName],0),l=[{upn:a.email,tag:"c0",name:a.displayName},{upn:this.userEmail,tag:"c1",name:this.userEmail}]):(c=this.formatStringWithTime(s,"RepliedOtherComment",t,n,[a.displayName,p.displayName],0),l=[{upn:a.email,tag:"c0",name:a.displayName},{upn:p.email,tag:"c1",name:p.displayName}])}else c=this.formatStringWithTime(s,"Commented",t,n,[a.displayName],0),l=[{upn:a.email,tag:"c0",name:a.displayName}];return{formatString:c,plainText:d.a.stripTags(c),people:l,reasonType:r.a.Comment,timestamp:s}},e.prototype.createEditDescription=function(e,t,n){if(0===e.length)return null;var i=e[0],o=this.numDistinctActors(e),a=i.actor.user,s=i.timestamp,c=this.formatStringWithTime(s,"Edited",t,n,[a.displayName],o-1);return{formatString:c,plainText:d.a.stripTags(c),people:[{upn:a.email,tag:"c0",name:a.displayName}],reasonType:r.a.Edit,timestamp:s}},e.prototype.formatStringWithTime=function(e,t,n,r,o,a){var s,c=a<=0?"":1===a?"OneOther":"Others",l=t+c,u=r?"NoDate":this.getActivityTimestampType(e,n);l+="FullDateThisYear"===u?"FullDate":u;var d=this.getTimestampPlaceholders(e,u),p=this.mruConfigService.config.activityStrings[l];return"OneOther"===c||""===c||o.push(this.locService.localizedNumberString(a)),o=o.concat(d),(s=this.locService).format.apply(s,Object(i.__spread)([p],o))},e.prototype.getActivityTimestampType=function(e,t){switch(this.timestampFormatService.getTimestampType(e)){case 0:return"NoDate";case 1:return"JustNow";case 2:return"MinAgo";case 3:return"HoursAgo";case 4:return t?"Yesterday":"YesterdayAt";case 5:return t?"DayOfWeek":"DayAndTimeOfWeek";case 6:return"FullDateThisYear";case 7:return"FullDate"}},e.prototype.getTimestampPlaceholders=function(e,t){var n=this.dateService.timespanInSeconds(e);switch(t){case"NoDate":case"JustNow":case"Yesterday":return null;case"MinAgo":return[this.locService.localizedNumberString(Math.round(n/60))];case"HoursAgo":return[this.locService.localizedNumberString(Math.round(n/3600))];case"YesterdayAt":return[this.locService.formatTimeFromDate(e)];case"DayOfWeek":return[this.locService.localizedWeekday(e)];case"DayAndTimeOfWeek":return[this.locService.localizedWeekday(e),this.locService.formatTimeFromDate(e)];case"FullDateThisYear":return[this.locService.localizedMonthDate(e)];case"FullDate":return[this.locService.localizedDateStringMedium(e)]}},e.prototype.numDistinctActors=function(e){return new Set(e.map((function(e){return e.actor.user.email}))).size},e.ɵprov=p.cc({factory:function(){return new e(p.dc(l.b),p.dc(c.a),p.dc(u.a),p.dc(a.a),p.dc(s.a))},token:e,providedIn:"root"}),e}()},dy1P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(e){return e.AADMyApps="AADMyApps",e.AboutMe="AboutMe",e.Access="Access",e.AdminPortal="AdminPortal",e.Audio="Audio",e.BecomeTheAdmin="BecomeTheAdmin",e.Bing="Bing",e.Bookings="Bookings",e.Calendar="Calendar",e.ClassNotebook="ClassNotebook",e.CloudPC="CloudPC",e.ComplianceCenter="ComplianceCenter",e.Create="Create",e.CustomerVoice="CustomerVoice",e.CRM="CRM",e.DocsCom="DocsCom",e.Documents="Documents",e.Dynamics365="Dynamics365",e.Dynamics365CI="Dynamics365CI",e.Dynamics365CSI="Dynamics365CSI",e.Dynamics365FraudProtection="Dynamics365FraudProtection",e.Dynamics365Invoicing="Dynamics365Invoicing",e.Dynamics365ProductInsights="Dynamics365ProductInsights",e.Dynamics365SalesInsights="Dynamics365SalesInsights",e.DynamicsApp="DynamicsApp",e.DynamicsNAV="DynamicsNAV",e.ERP="ERP",e.ExcelOnline="ExcelOnline",e.ExchangeAdmin="ExchangeAdmin",e.FamilySafety="FamilySafety",e.Fluid="Fluid",e.Forefront="Forefront",e.ForefrontAdmin="ForefrontAdmin",e.GraphApp="GraphApp",e.HighLander="HighLander",e.Invoicing="Invoicing",e.ISVStudio="ISVStudio",e.Kaizala="Kaizala",e.LineOfBusinessApp="LineOfBusinessApp",e.Lists="Lists",e.LoopComponent="Loop component",e.LogicFlows="LogicFlows",e.Mail="Mail",e.Marketing="Marketing",e.MeetingObject="Meeting Object",e.MeetingNotes="MeetingNotes",e.MicrosoftStream="MicrosoftStream",e.MSN="MSN",e.MyAnalytics="MyAnalytics",e.MyApps="MyApps",e.MyContent="MyContent",e.Feed="Feed",e.Netbreeze="Netbreeze",e.NewsArticle="NewsArticle",e.Newsfeed="Newsfeed",e.NonProfitPortal="NonProfitPortal",e.O365Settings="O365Settings",e.ODBAdmin="ODBAdmin",e.OfficeDotCom="OfficeDotCom",e.OfficeForms="OfficeForms",e.OfficeGraph="OfficeGraph",e.OfficeStore="OfficeStore",e.OneNoteOnline="OneNoteOnline",e.OWASettings="OWASettings",e.Park="Park",e.Parature="Parature",e.Partner="Partner",e.Paw="Paw",e.PDF="PDF",e.People="People",e.Photos="Photos",e.PlayLists="PlayLists",e.PowerApps="PowerApps",e.PowerBI="PowerBI",e.PowerPointOnline="PowerPointOnline",e.Privacy="Privacy",e.Project="Project",e.Publisher="Publisher",e.SecureScore="SecureScore",e.Rewards="Rewards",e.Security="Security",e.SendASmile="SendASmile",e.SharePoint="SharePoint",e.SharePointAdmin="SharePointAdmin",e.SharePointApp="SharePointApp",e.SISSyncAdmin="SISSyncAdmin",e.Skype="Skype",e.SkypeAdmin="SkypeAdmin",e.SkypeForBusiness="SkypeForBusiness",e.SkypeMeetings="SkypeMeetings",e.SkypeTeams="SkypeTeams",e.SpaceGallery="SpaceGallery",e.StaffHub="StaffHub",e.StaffNotebook="StaffNotebook",e.Sway="Sway",e.Tasks="Tasks",e.Text="Text",e.ThirdPartyApp="ThirdPartyApp",e.ToDo="ToDo",e.UnknownApp="UnknownApp",e.Video="Video",e.VisioOnline="VisioOnline",e.WAC="WAC",e.Whiteboard="Whiteboard",e.WindowsStore="WindowsStore",e.WordOnline="WordOnline",e.Yammer="Yammer",e}({})},e3cR:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l}));var i=n("QjXU"),r=n("obr3");function o(e,t,n){return void 0===n&&(n=1),Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,Object(r.b)(e,n,t)]}))}))}function a(e,t,n,r,o){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return"replace"!==r?[3,2]:[4,e.clear(n)];case 1:i.sent(),i.label=2;case 2:return a=e.transaction(n,"readwrite"),s=t.map((function(e,t){return a.store.put(e,o[t])})),[4,Promise.all(s)];case 3:return i.sent(),[4,a.done];case 4:return i.sent(),[2]}}))}))}function s(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.get(t,n)]}))}))}function c(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,e.getAll(t)]}))}))}function l(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return[2,e.delete(t,n)]}))}))}},ej7j:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},enhM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("QjXU"),r=n("uVU2"),o=n("GWL1");function a(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,a,s,c;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n={correlationId:t.correlationId,getAccessToken:t.getAccessToken,getIdentity:t.getIdentity,inMockMode:t.inMockMode,jwtAuthEnabled:t.jwtAuthEnabled,officeHomeApiRoot:t.officeHomeApiRoot,workload:t.workload},[4,Object(o.b)(n)];case 1:return(a=i.sent())&&a.length>0&&(s=[],c=!1,a.forEach((function(t){var n=e.find((function(e){return e.Id===t.Id}));n?Object(r.a)(n,t)?s.push(n):(s.push(n),c=!0):c=!0})),c)?[2,Object(o.c)(s,n)]:[2]}}))}))}},fGsv:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("QjXU"),r=n("lrJm"),o=n("hhzZ"),a=n("R7NL"),s=n("4/We"),c=n("/I02"),l=n("kpuN"),u=n("dFxn"),d=n("keVe"),p=function(){function e(e){this.config=e.parse("adminPolicyConfig")}return e.ɵprov=d.cc({factory:function(){return new e(d.dc(u.a))},token:e,providedIn:"root"}),e}(),f=n("wwmn"),h=n("casz"),m=n("xoWf"),b=n("pOWU"),g=n("TOqr"),v=function(e){function t(t,n,i,r,o,a,s,c,l,u,d){var p=e.call(this,o,c,s,"OfficeHome",a,l,d,u)||this;return p.globalErrorHandler=t,p.userDataStorageService=n,p.adminPolicyConfigService=i,p.capabilitiesService=r,p.fetchPolicyPromise=null,p.fetchCachedPolicyPromise=null,p}return Object(i.__extends)(t,e),t.prototype.getAdminPolicy=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.fetchCachedPolicy()];case 1:return(e=n.sent())?[2,e]:(this.fetchPolicyPromise||(this.fetchPolicyPromise=new Promise((function(e,n){var i=t.contextService.sharedContext.officeHomeApiRoot+"/"+t.adminPolicyConfigService.config.adminPolicyApiPath,r={responseType:"json",headers:new Map};t.get("Admin_Policy_Server_Request","Admin_Policy_Server",i,(function(i){i.instrument((function(e,n){e.ok||(t.fetchPolicyPromise=null)})).then((function(t){t.data&&t.data.Value||n("Null admin policies response."),e(t.data.Value)})).catch((function(e){t.fetchPolicyPromise=null,t.globalErrorHandler.handleError(e)}))}),n,r,"network-only")}))),[2,this.fetchPolicyPromise])}}))}))},t.prototype.fetchCachedPolicy=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){return(e={}).Action="FetchCachedAdminPolicyFromUserStorage",this.fetchCachedPolicyPromise||(this.fetchCachedPolicyPromise=new Promise((function(n){t.userDataStorageService.get(t.adminPolicyConfigService.config.cacheKey,t.capabilitiesService.capabilities.pwaEnabled?1:0).then((function(i){if(i&&i.Value){var r=new Date(i.LastUpdated).getTime()+60*i.CheckInInterval*1e3;r<Date.now()?(e.State="CacheExpired",e.DebugInfo="Cache Expired, ExpireTime:"+r,n(null)):(e.State="CacheFound",n(i.Value))}else e.State="NotFound",e.DebugInfo="No cached policies found.",n(null);t.instrumentationService.logDebugCacheEvent("Admin_Policy_Cache_Request",e)})).catch((function(e){t.fetchCachedPolicyPromise=null,t.globalErrorHandler.handleError(e)}))}))),[2,this.fetchCachedPolicyPromise]}))}))},t.ɵprov=d.cc({factory:function(){return new t(d.dc(r.b),d.dc(m.a),d.dc(p),d.dc(s.a),d.dc(l.b),d.dc(c.a),d.dc(a.a),d.dc(o.a),d.dc(f.a),d.dc(h.a),d.dc(g.q))},token:t,providedIn:"root"}),t}(b.a)},fKR7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return f}));var i,r=n("QjXU"),o=n("UWom"),a=n("hhzZ"),s=n("BaAg"),c=n("p6Zr"),l=n("cgnd"),u=n("lwM0"),d=n("pjz5"),p=n("L/Tc");!function(e){e[e.Recent=0]="Recent",e[e.Shared=1]="Shared",e[e.Trending=2]="Trending",e[e.Recommended=3]="Recommended",e[e.ClassNoteBook=4]="ClassNoteBook",e[e.News=5]="News",e[e.NoteBook=6]="NoteBook",e[e.Form=7]="Form",e[e.OfficeFeedDocument=8]="OfficeFeedDocument",e[e.EdgeworthDocument=9]="EdgeworthDocument",e[e.SharedForm=10]="SharedForm",e[e.StreamsVideo=11]="StreamsVideo",e[e.UpcomingMeeting=12]="UpcomingMeeting",e[e.MyAnalytics=13]="MyAnalytics"}(i||(i={}));var f=function(e){function t(t,n,r,a,f,h,m,b,g,v,y,S,w,C,I,T,k,_,A,P,E,O,F,D,R,M,x,L,U,N,j,W,B,z,V,H,q,G,Q,Z,K,X,J,Y,$,ee,te,ne,ie,re,oe,ae,se,ce,le,ue,de,pe,fe,he,me,be,ge,ve,ye,Se,we,Ce,Ie,Te,ke,_e,Ae,Pe,Ee,Oe,Fe){void 0===D&&(D=!1),void 0===R&&(R=!1),void 0===M&&(M=null),void 0===x&&(x=null),void 0===L&&(L=null),void 0===U&&(U=null),void 0===N&&(N=null),void 0===j&&(j=null),void 0===W&&(W=!1),void 0===B&&(B=!1),void 0===z&&(z=null),void 0===V&&(V=null),void 0===pe&&(pe=!1);var De=e.call(this,n,r,a,f,h,m,b,g,v,y,S,w,C,T,k,_,D,M,x,W,G?G.AttachmentType:void 0,B,pe)||this;if(De.format=t,De.sharingType=I,De.fromCache=P,De.application=E,De.resourceId=O,De.storageHost=F,De.isPinned=R,De.mruV2Category=L,De.mruV2Type=U,De.mruV2Id=N,De.activity=j,De.isEmailAttachment=W,De.createdDate=z,De.sharepointIds=V,De.sharing=H,De.isNew=q,De.emailReference=G,De.sharedByUsername=Q,De.sharedByEmail=Z,De.sharedById=K,De.thumbnailInfo=X,De.spoId=Y,De.isCollab=$,De.navigationId=te,De.thumbnails=ne,De.feedbackId=ie,De.serverDocId=re,De.createdBy=oe,De.teamsDeepLink=ae,De.ownerType=se,De.ownerId=ce,De.ownerTenantId=le,De.isDeleted=ue,De.isHidden=de,De.isSafeLink=pe,De.streamsThumbnailUrl=fe,De.startTime=he,De.endTime=me,De.location=be,De.locations=ge,De.attendees=ve,De.joinUrl=ye,De.organizer=Se,De.joinMeetingText=we,De.mediaDuration=Ce,De.subType=Ie,De.subTypeCategory=Te,De.taskInsight=ke,De.potentialAction=_e,De.activityUser=Ae,De.insightName=Pe,De.insightDescription=Ee,De.insightDescriptionPrefix=Oe,De.meetingArtifacts=Fe,De.mediaDurationRegex=new RegExp(/PT(\d+H)?(\d+M)?(\d*).*S?/),V||(De.sharepointIds={listId:null,listItemId:null,listItemUniqueId:null,siteId:null,siteUrl:null,webId:null}),De.documentUrl=b,t===i.Trending){var Re=De.url.match(/file=([\S]+?)(&|$)/i);if(Re&&Re.length>=2){var Me=Re[1];De.canonicalUrl=u.a.encodeUrl(x)+"/"+Me}else De.canonicalUrl=De.url;De.sharing={shared:!0}}else De.canonicalUrl=De.url||t===i.EdgeworthDocument&&De.webUrl,t===i.Shared&&(De.sharing={shared:!0});if(De.format===i.StreamsVideo&&De.mediaDuration){var xe=De.mediaDurationRegex.exec(De.mediaDuration);if(xe){var Le=xe[1],Ue=xe[2],Ne=xe[3];Le&&Le.length<3&&(Le="0"+Le),Ue&&Ue.length<3&&(Ue="0"+Ue),Ne&&Ne.length<2&&(Ne="0"+Ne),De.mediaDuration=(Le?Le.substring(0,Le.length-1)+":":"")+(Ue?Ue.substring(0,Ue.length-1)+":":"")+(Ne||"")}}if(b){if(!De.sharepointIds.siteUrl){var je=b.match(/https?:\/\/.*?\.sharepoint(-df)?\.com\/.*?\/.*?\//);je&&je.length&&(De.sharepointIds.siteUrl=je[0])}De.isMsftDogfood=b.lastIndexOf("microsoft-my.sharepoint-df.com")>-1||b.lastIndexOf("microsoft.sharepoint-df.com")>-1}if(s.a.referralFromFileLocation(De.url)===c.a.SharePoint&&(De.sharing={shared:!0}),De.lastModifiedBy&&De.lastModifiedBy.fullName&&De.lastModifiedBy.email&&De.lastModifiedTime&&(De.lastModifiedActivity=[{action:{type:p.a.Edit,data:{}},actor:{user:{displayName:De.lastModifiedBy.fullName,email:De.lastModifiedBy.email,userPrincipalName:De.lastModifiedBy.email},id:null},timestamp:De.lastModifiedTime}]),De._initialInflationCompleted=new o.a,De.initialInflationCompleted=De._initialInflationCompleted.asObservable(),"string"==typeof J&&(De.attribution=J),A===l.a.MSA)De.isOnPremOrVanity=!1;else if(ee&&ee.lastIndexOf("ONPREM")>=0)De.isOnPremOrVanity=!0;else if(ee&&ee.lastIndexOf("O365")>=0||De.fileType===s.b.Sway||De.fileType===s.b.Forms)De.isOnPremOrVanity=!1;else{var We=d.a.getHostName(De.url);De.isOnPremOrVanity=!(!We||-1!==We.lastIndexOf("sharepoint.com")||De.isMsftDogfood)}return De}return Object(r.__extends)(t,e),t.prototype.getFormEnumType=function(){if(this.subType)if("form"===this.subType.toLowerCase()&&this.subTypeCategory)switch(this.subTypeCategory.toLowerCase()){case"poll":case"teams poll":case"pptpoll":case"wordpoll":return"poll";case"assignments":return"assignments"}else if("poll"===this.subType.toLowerCase())return"poll";return"form"},t.prototype.getClickData=function(t,n,r){var o=e.prototype.getClickData.call(this,t,n,r,this.format===i.EdgeworthDocument);return o&&o.params&&(o.params.Area="Suggested_Action_Click"===t?a.b.SuggestedActions:"Recommended_Click"===t?a.b.Recommended:a.b.Documents,"boolean"==typeof this.isPinned&&(o.params.Pinned=this.isPinned.toString()),"boolean"==typeof this.isNew&&(o.params.ItemIsNew=this.isNew.toString()),this.sharing&&"boolean"==typeof this.sharing.shared&&(o.params.ItemIsShared=this.sharing.shared.toString())),o},t.prototype.getClickDataForPath=function(t,n,i){var r=e.prototype.getClickDataForPath.call(this,t,n,i);return r&&r.params&&(r.params.Area=a.b.Documents),r},t.prototype.copyInflationData=function(e,t){void 0===t&&(t=!1),e.activities&&!t&&(this.activities=e.activities.slice()),e.driveId&&(this.driveId=e.driveId),void 0===e.isNew||t||(this.isNew=e.isNew),e.sharepointIds.siteUrl&&(this.sharepointIds.siteUrl=e.sharepointIds.siteUrl),e.sharing&&!t&&(this.sharing=Object(r.__assign)({},e.sharing)),e.thumbnails&&(this.thumbnails=Object(r.__assign)({},e.thumbnails)),e.wopiData&&(this.wopiData=Object(r.__assign)({},e.wopiData))},t.prototype.inflationCompleted=function(){this._initialInflationCompleted.next(!0),this._initialInflationCompleted.complete()},t.prototype.shouldAddLoginHint=function(){return!this.isLocal&&!this.isOnPremOrVanity&&("OneDriveForBusiness"===this.source||"SharePoint"===this.source||"EmailAttachment"===this.source||this.fileType!==s.b.Sway&&this.fileType!==s.b.Forms&&this.fileType!==s.b.PowerBI)},t}(s.a)},"fVt+":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("zvoD"),r=n("3Vsh"),o=n("dFxn"),a=n("7Gwk"),s=n("uWZl"),c=n("4/We"),l=n("cgnd"),u=n("keVe"),d=function(){function e(e,t,n,i){this.capabilitiesService=e,this.configParserService=t,this.startupConfigService=n,this.eventService=i}return e.prototype.getConfig=function(){var e=this;if(!this.configPromise){if(this.startupConfigService.config.authType!==l.a.MSA)return Promise.reject();if(this.capabilitiesService.capabilities.isPwaInUwp)this.configPromise=Promise.resolve(this.configParserService.parse("consumerUserConsent"));else{var t=this.eventService.events.withScope(0).pipe(Object(i.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(r.a)(1)).toPromise(),n=s.a.fullPageReady();this.configPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("consumerUserConsent")}))}}return this.configPromise},e.ɵprov=u.cc({factory:function(){return new e(u.dc(c.a),u.dc(o.a),u.dc(l.b),u.dc(a.a))},token:e,providedIn:"root"}),e}()},fpaX:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return b}));var i=n("31lE"),r=n("Uqr9"),o=n("re3B"),a=n("4/We"),s=n("cgnd"),c=n("JH4S"),l=n("twlh"),u=n("hhzZ"),d=n("Vwd8"),p=n("keVe"),f=n("OtXi"),h=function(){function e(t,n,i,r,o,a,s){var c=this;this.clientStartupConfigService=n,this.activitySessionService=r,this.sessionActive=!1,this.ariaLogger=e.createAriaLogger(n.config,i,o,s,t),this.ariaLogger&&(this.sessionActive=!0,a.addUnloadEvent((function(){c.endAppSession(!t.capabilities.pwaEnabled)}),!0))}return e.createAriaLogger=function(t,n,r,o,a){if(!t.sharedClientStartupContext.ariaTenant||!t.sharedClientStartupContext.ariaCollectorUrl)return null;var c=e.initializeAriaLogManager(t.sharedClientStartupContext.ariaTenant,t.sharedClientStartupContext.ariaCollectorUrl),l=t.puid,u=i.AWTUserIdType.Unknown;if(l?t.authType===s.a.OrgId?u=i.AWTUserIdType.OrgIdPUID:t.authType===s.a.MSA&&(u=i.AWTUserIdType.MSAPUID):l=e.unknownUserId,c.getSemanticContext().setUserId(l,i.AWTPiiKind.NotSet,u),c.setContext("UserInfo.OMSTenantId",t.tenantId),c.setContext("AuthType",t.authTypeString),c.setContext("AuthVer",t.authVersion),c.setContext("CorpNet",t.sharedClientStartupContext.corpNet),c.setContext("CorrelationId",t.sharedClientStartupContext.correlationId),c.setContext("DevEnvironment",t.sharedClientStartupContext.devEnvironment),c.setContext("DeploymentEnvironment",t.sharedClientStartupContext.deploymentEnvironment),c.setContext("Geo",t.sharedClientStartupContext.geoName),c.setContext("RequestOrigin",t.sharedClientStartupContext.requestOrigin),c.setContext("SessionId",t.sharedClientStartupContext.sessionId),c.setContext("TestTraffic",t.sharedClientStartupContext.testTraffic),c.setContext("Workload",a.getWorkload()),c.setContext("ServerBuildDate",t.sharedClientStartupContext.buildDateUtc),c.setContext("ServerBuildId",t.sharedClientStartupContext.buildId),c.setContext("BundleBuildDate","2022-06-20 10:04:29.598"),c.setContext("BundleBuildId","473da5d9-89a3-e616-9cd1-883721a4e4bc"),c.setContext("EcsRing",t.sharedClientStartupContext.ecsRing),c.setContext("Flights",t.sharedClientStartupContext.flights+(t.sharedClientStartupContext.flights&&t.features?",":"")+t.features),n&&(c.setContext("Admin",n.user.isAdmin),c.setContext("IsSmb",n.user.isSmb),c.setContext("IsIw",n.user.isIw),c.setContext("IsEdu",n.user.isEdu),c.setContext("IsEduStudent",n.user.isEduStudent),c.setContext("IsEduFaculty",n.user.isEduFaculty),c.setContext("IsDynamics",n.user.isDynamics),c.setContext("ThemeId",n.user.themeId),c.setContext("IsFirstRelease",n.user.isFirstRelease)),r&&(c.setContext("FirstVisit",r.isFirstVisit()),c.setContext("FirstVisitAgeInDays",r.fullDaysSinceFirstVisit())),o){c.setContext("WrapperVersion",o.major+"."+o.minor+"."+o.build+"."+o.revision);var d=void 0;if(a.capabilities.isPwaInWebView2)d="WebView2";else if(a.capabilities.isPwaInUwp){var p=new RegExp("1[0-9]{2}10");d=(null==o?void 0:o.build)&&p.test(o.build.toString())?"UWP_fallback":"UWP"}d&&c.setContext("AppWorkloadType",d)}return e.startSession(c),c},e.endSession=function(t,n,r){window.disableLogs||(r=r||new i.AWTEventProperties,e.populateSessionProperties(r),t.logSession(i.AWTSessionState.Ended,r)),n?i.AWTLogManager.flushAndTeardown():i.AWTLogManager.flush(null)},e.prototype.trackEvent=function(t,n){if(this.ariaLogger){this.sessionActive||(e.startSession(this.ariaLogger),this.sessionActive=!0);var r=this.clientStartupConfigService.config,o=new i.AWTEventProperties;for(var a in o.setName(t),n)if(n.hasOwnProperty(a)){var s=n[a];s instanceof u.d?r.logPiiAllowed&&(r.logPiiInClearText?o.setProperty(a,s.value):o.setPropertyWithPii(a,s.value,s.kind)):o.setProperty(a,s)}this.ariaLogger.logEvent(o)}},e.prototype.endAppSession=function(t){if(this.ariaLogger&&this.sessionActive){var n=new i.AWTEventProperties,o=this.activitySessionService.endSession();if(o){var a=r.a.now()-o.inactivityStartTime;n.setProperty("ActivityDuration",Math.ceil(o.cumulativeDurationOfActivitySessions/1e3).toString()),n.setProperty("InactivityDuration",Math.ceil((o.cumulativeDurationBetweenActivitySessions+a)/1e3).toString()),n.setProperty("ItemCount",o.activitySessionsCount.toString()),n.setProperty("ClickCount",o.cumulativeClickCount.toString())}e.endSession(this.ariaLogger,t,n),this.sessionActive=!1}},e.startSession=function(t){if(!window.disableLogs){var n=new i.AWTEventProperties;e.populateSessionProperties(n),t.logSession(i.AWTSessionState.Started,n)}},e.populateSessionProperties=function(e){e.setProperty("LoggerId","Angular"),window.prelaunchMode&&e.setProperty("PrelaunchMode","true")},e.initializeAriaLogManager=function(t,n){var r={collectorUri:n,enableAutoUserSession:!1,propertyStorageOverride:{setProperty:function(t,n){return e.setProperty(t,n)},getProperty:function(t){return e.getProperty(t)}},disableCookiesUsage:!0};return document&&document.cookie&&e.legacyAriaCookies.forEach((function(t){document.cookie=t+e.removeCookieString})),i.AWTLogManager.initialize(t,r)},e.setProperty=function(t,n){e.propertyMap.set(t,n)},e.getProperty=function(t){return e.propertyMap.has(t)?this.propertyMap.get(t):""},e.unknownUserId="Unknown",e.legacyAriaCookies=["MicrosoftApplicationsTelemetryDeviceId","MicrosoftApplicationsTelemetryFirstLaunchTime"],e.removeCookieString="=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",e.propertyMap=new Map,e.ɵprov=p.cc({factory:function(){return new e(p.dc(a.a),p.dc(s.b),p.dc(c.a),p.dc(l.a),p.dc(d.b),p.dc(o.a),p.dc(f.a,8))},token:e,providedIn:"root"}),e}(),m=function(){function e(e,t,n,i){this.ariaService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){var e={};for(var t in this.params)e[t]=this.params[t];this.ariaService.trackEvent(this.streamName,e)},e}(),b=function(){function e(e){this.ariaService=e}return e.prototype.createEvent=function(e,t,n){return new m(this.ariaService,e,t,n)},e.prototype.flush=function(){this.ariaService.endAppSession(!0)},e.ɵprov=p.cc({factory:function(){return new e(p.dc(h))},token:e,providedIn:"root"}),e}()},"g/dT":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("kxm0"),r=n("W3Zz"),o=(n("hhzZ"),function(){function e(e,t){this.deviceDetector=e,this.instrumentationService=t}return e.prototype.ngOnInit=function(){var e={};e.DevicePlatform=r.d[this.deviceDetector.getDeviceInfo().platform.platformType],this.instrumentationService.logGenericEvent(this.pageName,e,[this.pageName]);var t=!0;window.prelaunchMode&&(t=!1),Object(i.d)({isIntentional:t,eventName:this.pageName})},e}())},g0MB:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n("w1PR");var i=function(){function e(e,t,n){this.elementReference=e,this.renderer=t,this.themingService=n,this.toolTipSpan=null}return e.prototype.ngAfterViewInit=function(){var e=this;this.elementReference.nativeElement.onfocus=function(){e.elementReference.nativeElement.title&&e.onEvent()},this.elementReference.nativeElement.onblur=function(){e.toolTipSpan&&e.renderer.removeChild(e.elementReference.nativeElement,e.toolTipSpan),e.toolTipDelayTimeout&&(clearTimeout(e.toolTipDelayTimeout),e.toolTipDelayTimeout=null)}},e.prototype.onEvent=function(){var e=this;this.toolTipDelay().then((function(){e.toolTipSpan=document.createElement("span"),e.toolTipSpan.classList.add("ohp-keyboardfocus-tooltip"),e.toolTipSpan.classList.add("ohpAppTheme"),e.toolTipSpan.classList.add("ms-fcl-nd"),e.toolTipSpan.classList.add("ms-bgc-w"),e.toolTipSpan.innerText=e.elementReference.nativeElement.title,e.renderer.appendChild(e.elementReference.nativeElement,e.toolTipSpan)}))},e.prototype.toolTipDelay=function(){var e=this;return new Promise((function(t){e.toolTipDelayTimeout=setTimeout((function(){t()}),1e3)}))},e}()},g92T:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var i=n("QjXU"),r=n("czhI"),o=n.n(r).a.create(),a=function(e,t){return"cache-only"===t?Promise.reject("Cache unsupported"):Promise.resolve(e)};function s(e,t,n){null==e||e.forEach((function(e){var t;(t=o.interceptors.request).use.apply(t,Object(i.__spread)(e))})),null==t||t.forEach((function(e){var t;(t=o.interceptors.response).use.apply(t,Object(i.__spread)(e))})),n&&(a=n)}},gB6C:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("8wW2"),r=n("AGMK"),o=(n("z0B0"),n("iPRk"));function a(){return{cancel:function(){return null},cancelAndRunNow:function(){return null},adjustPriority:function(){return null}}}var s,c=n("UY9y"),l=new(n.n(c).a)([],(function(e,t){return function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}(e,t)})),u=n("Zmq1"),d=n("VKX6"),p="Safari"===Object(u.a)().browser.browserType,f=p?function(e,t){return setTimeout((function(){var t=Object(d.a)();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Object(d.a)()-t))}})}))}:requestIdleCallback,h=(p||cancelIdleCallback,n("pdjy")),m=Object(r.a)(),b=!0;function g(){s||(s=f((function(e){m&&(m=!1,Object(o.a)("First_Idle_React")),s=null,function(e){for(;e&&e.timeRemaining()>0;){var t=l.pop();if(!t)break;if(!t.cancelled)try{t.work(e),t.completed=!0}catch(e){Object(i.a)().handleError(e,"DXUlK")}}l.peek()&&g()}(e)})))}function v(e,t){if(t===h.e)return e(),a();b&&(b=!1,Object(o.a)("First_Schedule_React"));var n={work:e,priority:t,cancelled:!1,completed:!1},i=function(e){var t=function(){return e.cancelled=!0};return{cancel:t,cancelAndRunNow:function(){e.cancelled||(t(),e.completed||(e.work(),e.completed=!0))},adjustPriority:function(n){return t(),e.completed?a():v(e.work,n)}}}(n);return l.push(n),g(),i}},gktR:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n("QjXU"),r=n("Dn7E"),o=n("laSs"),a=n("lrJm"),s=n("R7NL"),c=n("3GGT"),l=n("hhzZ"),u=n("kpuN"),d=n("uzn7"),p=n("wwmn"),f=n("casz"),h=n("xoWf"),m=n("pOWU"),b=n("/I02"),g=n("keVe"),v=n("TOqr"),y=function(e){function t(t,n,i,r,o,a,s,c,l,u){var d=e.call(this,t,i,n,"OfficeHome",r,o,a,s)||this;return d.localStorageService=c,d.userDataStorageService=l,d.globalErrorHandler=u,d.requestConfig={headers:new Map([["Accept","application/json"]])},d.alreadyCompleted=!1,d}return Object(i.__extends)(t,e),t.prototype.fetchFirstRunData=function(e,n,i){var r=this;return void 0===n&&(n=!1),new Promise((function(o){var a="_"+i,s=r.localStorageService.get(a)||r.createInitialFirstRunData(e);if(n)o(s);else{var c=!1;s.CompletedFirstRun&&(c=!0,o(s)),r.userDataStorageService.get(i,t.LoadFromUserStorageRemoteAttempts).then((function(e){e&&e.CompletedFirstRun?s.CompletedFirstRun||(c=!0,o(e),r.localStorageService.set(a,e)):s.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(s,i)})).catch((function(e){r.globalErrorHandler.handleError(e,"oZtOo"),s.CompletedFirstRun&&r.storeFirstRunDataInUserStorage(s,i)})).then((function(){c||(c=!0,o(s))}))}}))},t.prototype.updateFirstRunData=function(e,t,n,i){var r=this;void 0===i&&(i=!0),this.fetchFirstRunData(e.Version,!1,t).then((function(o){var a="_"+t,s=e.CompletedFirstRun;(o.CompletedFirstRun||e.StepsCompleted>=e.TotalSteps)&&(e.CompletedFirstRun=!0),e.FurthestCompleted=o.FurthestCompleted,(void 0===o.FurthestCompleted||e.StepsCompleted>o.FurthestCompleted)&&(e.FurthestCompleted=e.StepsCompleted),r.localStorageService.set(a,e),r.storeFirstRunDataInUserStorage(e,t),i&&r.instrumentFirstRunData(e,n,s)}))},t.prototype.forceRefreshAndGetLicenseStatus=function(){var e=this;return new Promise((function(n,i){e.get("Office_Consumer_License_Fetch","Office_Consumer_License_Fetch",e.contextService.sharedContext.officeHomeApiRoot+t.ConsumerLicenseStatusEndpoint+"?"+t.ConsumerLicenseStatusForceRefreshQuery,(function(e){e.instrument((function(e,t){t.HttpCode=e.ok?c.a.OK.toString():c.a.UnexpectedResponse.toString()})).then((function(e){n(e.data)}))}),(function(t){e.globalErrorHandler.handleError(t,"wCBHa"),i(t)}),e.requestConfig,"network-only")}))},t.prototype.isRetriableError=function(e){return e===c.a.Throttled},t.prototype.createInitialFirstRunData=function(e){return{CompletedFirstRun:!1,StepsCompleted:0,Version:e}},t.prototype.storeFirstRunDataInUserStorage=function(e,t){this.userDataStorageService.set(t,e)},t.prototype.instrumentFirstRunData=function(e,t,n){var i={};i.FirstRunStepsCompleted=e.StepsCompleted.toString(),i.FirstRunTotalSteps=e.TotalSteps?e.TotalSteps.toString():"0",i.FirstRunVersion=e.Version.toString(),i.FirstRunFurthestCompleted=e.FurthestCompleted.toString(),i.FirstRunUserDismissedCallout=n.toString(),e.CompletedFirstRun&&!this.alreadyCompleted&&(this.instrumentationService.logGenericEvent("First_Run_Completed",i),Object(r.a)({featureName:"FirstRun",eventName:"First_Run_Completed",params:i}),this.alreadyCompleted=!0),e.CompletedFirstRun&&void 0===t||(i.ItemCategory=t,this.instrumentationService.logImpressionEvent("First_Run_Impression",i),Object(o.a)({eventName:"First_Run_Impression",area:t}))},t.firstRunDataKey="FirstRunData",t.LoadFromUserStorageRemoteAttempts=2,t.ConsumerLicenseStatusEndpoint="/api/license/consumer",t.ConsumerLicenseStatusForceRefreshQuery="forceRefresh=true",t.ɵprov=g.cc({factory:function(){return new t(g.dc(u.b),g.dc(s.a),g.dc(l.a),g.dc(b.a),g.dc(p.a),g.dc(v.q),g.dc(f.a),g.dc(d.a),g.dc(h.a),g.dc(a.b))},token:t,providedIn:"root"}),t}(m.a)},gmml:function(e,t,n){"use strict";n.r(t);var i=n("QjXU"),r=n("keVe"),o=n("zvoD"),a=n("3Vsh"),s=n("0XE2"),c=n("lrJm"),l=n("hZW2"),u=n("wwmn"),d=n("BMb5"),p=n("cgnd"),f=n("6cfW"),h=new r.q("SERVICE_WORKER_REGISTRATION_HANDLERS"),m=n("+2OL"),b=n("JWB6"),g=n("xaJZ"),v=n("511z"),y=n("5MEU"),S=new r.q("SERVICE_WORKER_GET_REGISTRATION_BY_SCOPE"),w=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d){this.serviceWorkerConfigService=e,this.serviceWorkerEnabled=t,this.hasServiceWorkerApi=n,this.windowService=i,this.startupConfigService=r,this.globalErrorHandler=o,this.workloadQueryParameterValue=a,this.officeHomeApiConfig=s,this.serviceWorkerStateService=c,this.documentService=l,this.registrationHandlers=u,this.getRegistrationByScope=d}return e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a,s,c,l,u,d,p,h,m,b,g,v;return Object(i.__generator)(this,(function(y){switch(y.label){case 0:if(!this.hasServiceWorkerApi)return[2];this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker,y.label=1;case 1:return y.trys.push([1,11,,12]),"Controlled"!==this.serviceWorkerStateService.currentState?[3,3]:[4,this.serviceWorkerContainer.getRegistration(this.getRegistrationByScope?this.serviceWorkerConfigService.config.scope:void 0)];case 2:e=y.sent(),y.label=3;case 3:if(!this.serviceWorkerEnabled)return[3,8];n=(t=this.serviceWorkerConfigService.config).scriptUrl,r=t.scope,(o=new URLSearchParams).append("cdnDomain",this.startupConfigService.config.cdnDomain),o.append(this.officeHomeApiConfig.config.workloadQueryParameter,this.workloadQueryParameterValue),a=new URLSearchParams(this.windowService.nativeWindow.location.search),s=this.getFlightsForRegistrationUrl();try{for(c=Object(i.__values)(s),l=c.next();!l.done;l=c.next())o.append("serviceWorkerFlight",l.value)}catch(e){g={error:e}}finally{try{l&&!l.done&&(v=c.return)&&v.call(c)}finally{if(g)throw g.error}}return this.startupConfigService.config.automatedTestRunning&&(u=a.get("envType"),o.append("envType",u)),d=n+"?"+o.toString(),e?(p=this.windowService.nativeWindow.location.origin,h=e.active.scriptURL.toLowerCase()!==(p+d).toLowerCase(),m=e.scope.toLowerCase()!==(p+r).toLowerCase(),h||m?[4,this.registerServiceWorker(d,r)]:[3,5]):[3,6];case 4:e=y.sent(),y.label=5;case 5:return[3,8];case 6:return[4,this.registerServiceWorker(d,r)];case 7:e=y.sent(),y.label=8;case 8:return e&&this.registrationHandlers?[4,Promise.all(this.registrationHandlers.map((function(t){return t.handleRegistration(e)})))]:[3,10];case 9:y.sent(),y.label=10;case 10:return[3,12];case 11:return b=y.sent(),Object(f.a)(b)?[2]:(this.globalErrorHandler.handleError(b,"qKgQM"),[3,12]);case 12:return[2]}}))}))},e.prototype.registerServiceWorker=function(e,t){var n=this;return new Promise((function(i){var r=function(){i(n.serviceWorkerContainer.register(e,{scope:t})),n.windowService.nativeWindow.removeEventListener("load",r)};"complete"===n.documentService.nativeDocument.readyState?r():n.windowService.nativeWindow.addEventListener("load",r)}))},e.prototype.getFlightsForRegistrationUrl=function(){var e=this.startupConfigService.config.sharedClientStartupContext.flights,t=this.serviceWorkerConfigService.config,n=t.serviceWorkerAllowedFlights,r=t.pilotFlights,o=new Set(Object(i.__spread)(e.split(","),r));return n.filter((function(e){return o.has(e)}))},e.ɵprov=r.cc({factory:function(){return new e(r.dc(m.a),r.dc(g.a),r.dc(v.a),r.dc(d.b),r.dc(p.b),r.dc(c.b),r.dc(y.a),r.dc(u.a),r.dc(b.a),r.dc(l.a),r.dc(h,8),r.dc(S,8))},token:e,providedIn:"root"}),e}(),C=n("31lE"),I=n("fpaX"),T=n("hhzZ"),k=n("Uqr9");function _(e,t,n){if(void 0===n&&(n=!0),n&&console.error(e),t){var i=I.b.createAriaLogger(t);if(i){var r=!1;try{Zone.assertZonePatched()}catch(e){r=!0}var o=window.queuedEvents||[],a=window.queuedMarks,s="number"==typeof window.windowsDataSecuritySetting?window.windowsDataSecuritySetting:3;if(k.b.performanceLoggingSupported(window)){var c=function(e,t,n){(n=n||{}).Latency=t.toString(),n.ItemCategory="Bootstrapper",o.push({streamName:"Performance_Dump",eventName:e,eventParams:n,metrics:[],securityThreshold:0})},l=function(e,t,n){(n=n||{}).Error=e,n.DebugInfo=t,n.ItemCategory="Bootstrapper",o.push({streamName:"Generic_Event",eventName:"Performance_Mark_Failure",eventParams:n,metrics:[],securityThreshold:0})};a&&a.splice(0,a.length).forEach((function(e){var t=e.measureFrom||"navigationStart";try{window.performance.measure(e.markName,t,e.markName)}catch(n){return void l(e.markName,"Failed to record <"+e.markName+"> starting from <"+t+">: exception is thrown",e.eventParams)}var n=window.performance.getEntriesByName(e.markName,"measure");if(n&&n.length){var i=Math.ceil(n[0].duration);c(e.markName,i,e.eventParams)}else l(e.markName,"Failed to record <"+e.markName+">: measure missing",e.eventParams)})),k.b.getBrowserTimingMeasures(window,(function(e,t){l(e,t)})).forEach((function(e){c(e.name,e.duration)}))}o.length>0&&(o.forEach((function(e){if(!((e.securityThreshold||0)>s)){var t=new C.AWTEventProperties,n=e.eventParams;if(n)for(var r in n)n.hasOwnProperty(r)&&t.setProperty(r,n[r]);t.setName(e.streamName),t.setProperty("EventName",e.eventName),t.setProperty("AppSecurityLevel",s),i.logEvent(t)}})),window.queuedEvents=[]);var u=e&&e.stack||"Browser did not provide stack trace",d=e&&e.message||"No Error Message Provided";d.lastIndexOf(".")!==d.length-1&&(d+=".");var p="Fatal error preventing Angular bootstrap: "+d+" Zone error: "+r,f=function(e){var t=new C.AWTEventProperties;return t.setName(e),t.setProperty("EventName","Unhandled_Exception"),t.setProperty("ItemCategory","Bootstrap"),t.setProperty("Error",T.a.filterPii(p)),t.setProperty("AppSecurityLevel",s),t},h=f("Generic_Event");t.logPiiAllowed&&h.setPropertyWithPii("DebugInfo",u,t.logPiiInClearText?C.AWTPiiKind.NotSet:C.AWTPiiKind.GenericData),i.logEvent(h);var m=f("Generic_Debug_Cache_2");m.setProperty("DebugInfo",u),i.logEvent(m),I.b.endSession(i,!0)}}}var A,P,E,O=n("twlh"),F=function(){function e(e,t,n,i){this.activitySessionService=e,this.streamName=t,this.params=n,this.metrics=i}return e.prototype.record=function(){"Generic_Click"===this.streamName&&this.activitySessionService.incrementClick()},e}(),D=function(){function e(e){this.activitySessionService=e}return e.prototype.createEvent=function(e,t,n){return new F(this.activitySessionService,e,t,n)},e.prototype.flush=function(){},e.ɵprov=r.cc({factory:function(){return new e(r.dc(O.a))},token:e,providedIn:"root"}),e}(),R=n("HQCr"),M=function(){function e(){}return e.setup=function(t){if(document.body&&document.body.addEventListener){var n=-1!==navigator.appVersion.toUpperCase().indexOf("MSIE")?"click":"mousedown";document.body.addEventListener(n,(function(n){e.processClick(n,t)}))}},e.processClick=function(t,n){for(var i=t.srcElement||t.target;i&&(!i.tagName||!e.supportedClickTargets.hasOwnProperty(i.tagName.toUpperCase()));)i=i.parentElement||i.parentNode;if(i){var r=i.getAttribute("data-clicklog");if(!r||"CUSTOM"!==r.toUpperCase()){var o=i.id||"Unknown",a=i.getAttribute("data-referral");null!=a&&0!==a.length||(a=e.referralFromElement(i));var s=i.getAttribute("data-referral-platform"),c=i.getAttribute("data-area");null!=c&&0!==c.length||(c=e.areaFromElement(i));var l=!!i.getAttribute("data-nav");e.logGenericClick(o,c,a,s,l,n),Object(R.a)(o,null!=c?c:"Other",a)}}},e.logGenericClick=function(e,t,n,i,r,o){o.logClickEvent("Generic_Click",e,t,n,i,void 0,void 0,void 0,r)},e.areaFromElement=function(e){var t=e.id||null;if(t&&t.length){var n="O365_";if(0===t.lastIndexOf(n,n.length))return T.b.Shell;var i="obf-";if(0===t.lastIndexOf(i,i.length))return T.b.Feedback}var r=e.classList||null;if(r&&r.length)for(var o="o365cs-",a=0;a<r.length;a++)if(0===r.item(a).lastIndexOf(o,o.length))return T.b.Shell;return null},e.referralFromElement=function(e){var t=e.id||null;if(t&&t.length){var n="O365_AppTile_";if(0===t.lastIndexOf(n,n.length)){var i=t.substring(n.length),r="Shell";return 0===i.lastIndexOf(r,r.length)&&(i=i.substring(r.length)),i}var o=e.classList||null;if(o&&o.length&&o.contains("o365cs-nav-appTile"))return t}return null},e.supportedClickTargets={A:!0,IMG:!0,AREA:!0,INPUT:!0,BUTTON:!0},e}(),x=n("p6wn"),L=n("Vwd8"),U=n("9WrL"),N=n("kpuN"),j=n("Dn7E"),W=n("R7NL"),B=n("/I02"),z=n("dFxn"),V=function(){function e(e){this.config=e.parse("authStateConfig")||{authTicketExpiryIntervalInMinutes:0,checkAuthStateEnabled:!1,checkAuthStateEndpoint:null,checkAuthStateIntervalInSeconds:0,reauthenticationForAccessTokenPermanentErrorIntervalInMinutes:0}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(z.a))},token:e,providedIn:"root"}),e}(),H=n("7Gwk"),q=n("Z0U4"),G=n("WLAd"),Q=n("X+PR"),Z=function(){function e(e,t,n,i,r,o,a,s,c,l,u){this.contextService=e,this.configService=t,this.officeHomeApiConfigService=n,this.instrumentationService=i,this.instrumentedHttp=r,this.eventService=o,this.pageVisibilityService=a,this.route=s,this.globalErrorHandler=c,this.windowService=l,this.routeService=u,this.currentState="SignedIn",this.initialized=!1,this.checkAuthStateTimeout=null,this.accessTokenService=null}return e.prototype.initialize=function(e){var t=this;if(this.initialized)throw new c.a("Not allowed to call AuthStateService.initialize() more than once");this.initialized=!0,this.accessTokenService=e;var n=this.configService.config;if(n.checkAuthStateEnabled&&n.checkAuthStateEndpoint){var i=this.contextService.sharedContext;this.checkAuthStateEndpoint=i.officeHomeApiRoot+"/"+n.checkAuthStateEndpoint,this.checkAuthStateRequestOptions={headers:new Map},this.queryParamProcessor=new Promise((function(e,n){i.inMockMode||e(),t.officeHomeApiConfigService.config.mockRequestHeader||e(),t.route.queryParams.pipe(Object(o.a)((function(e){return Object.keys(e).length>0})),Object(a.a)(1)).toPromise().then((function(n){for(var i in n)i&&n.hasOwnProperty(i)&&"mockchecklogin"===i.toLowerCase()&&t.checkAuthStateRequestOptions.headers.set(t.officeHomeApiConfigService.config.mockRequestHeader,n[i]);e()})).catch((function(e){t.globalErrorHandler.handleError(e,"Jrzf6"),n(e)}))})),this.watchAuthTicketExpiry(),this.watchAccessTokenPermanentError(),this.watchPageVisibilityChanges(),this.scheduleCheckAuthState(),this.setupActivityTimeoutSignoutListener()}},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.watchAuthTicketExpiry=function(){var e=this;if(this.configService.config.authTicketExpiryIntervalInMinutes>0){var t,n=6e4*this.configService.config.authTicketExpiryIntervalInMinutes,i=Date.now();this.routeService.subscribeToRouteChangeEnd((function(r){if("Content"===r.currentRoute.route)t&&(e.windowService.nativeWindow.clearTimeout(t),t=void 0);else if(!t){var o=Math.max(n-(Date.now()-i),0);t=e.windowService.nativeWindow.setTimeout((function(){"SignedIn"===e.currentState&&e.updateCurrentState({LoginState:"Expired"})}),o)}}))}},e.prototype.watchAccessTokenPermanentError=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.accessTokenService.hasPermanentAuthError()];case 1:return n.sent()&&(e=this.configService.config.reauthenticationForAccessTokenPermanentErrorIntervalInMinutes)>0&&this.windowService.nativeWindow.setTimeout((function(){"SignedIn"===t.currentState&&t.updateCurrentState({LoginState:"ReauthenticationRequired"})}),6e4*e),[2]}}))}))},e.prototype.watchPageVisibilityChanges=function(){var e=this;this.windowService.nativeWindow.setTimeout((function(){e.pageVisibilityService.addOnVisibilityChanged((function(){e.pageVisibilityService.isVisible()&&e.checkAuthState()}))}),1e3*this.configService.config.checkAuthStateIntervalInSeconds)},e.prototype.scheduleCheckAuthState=function(){var e=this;"SignedIn"===this.currentState&&!this.checkAuthStateTimeout&&this.configService.config.checkAuthStateIntervalInSeconds>0&&(this.checkAuthStateTimeout=this.windowService.nativeWindow.setTimeout((function(){return e.checkAuthState()}),1e3*this.configService.config.checkAuthStateIntervalInSeconds))},e.prototype.checkAuthState=function(){var e=this;this.checkAuthStateTimeout&&(this.windowService.nativeWindow.clearTimeout(this.checkAuthStateTimeout),this.checkAuthStateTimeout=null),this.queryParamProcessor.then((function(){if("SignedIn"===e.currentState&&e.pageVisibilityService.isVisible())return e.instrumentedHttp.get("Check_Login_Request","Check_Login",e.checkAuthStateEndpoint,e.checkAuthStateRequestOptions,"network-only").then((function(t){var n=t.data;n&&"SignedIn"===e.currentState&&e.updateCurrentState(n)}))})).catch((function(t){e.globalErrorHandler.handleError(t,"QGMJO")})).then((function(){return e.scheduleCheckAuthState()}))},e.prototype.updateCurrentState=function(e){var t=e.LoginState;if(this.currentState!==t){this.currentState=t;var n={};n.State=this.currentState,this.instrumentationService.logGenericEvent("Auth_State_Changed",n),Object(j.a)({featureName:"Auth",eventName:"Auth_State_Changed",params:n}),this.eventService.broadcastEvent({name:"authStateChanged",args:[e]})}},e.prototype.setupActivityTimeoutSignoutListener=function(){var e=this;this.windowService.nativeWindow.addEventListener("message",(function(t){if(t&&t.data){var n=void 0;try{n=JSON.parse(t.data)}catch(e){}n&&"abtSignOutEventForHost"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityAuto"}),n&&"abtSignOutEventForHostUserGenerated"===n.eventId&&e.updateCurrentState({LoginState:"SignedOutBasedOnActivityUserClick"})}}))},e.ɵprov=r.cc({factory:function(){return new e(r.dc(B.a),r.dc(V),r.dc(u.a),r.dc(T.a),r.dc(W.a),r.dc(H.a),r.dc(G.a),r.dc(Q.a),r.dc(c.b),r.dc(d.b),r.dc(q.a))},token:e,providedIn:"root"}),e}(),K=n("4/We"),X=n("uWZl"),J=0,Y=!1;function $(e){var t=this,r=e.injector,u=r.get(H.a),d=function(e){try{if(0!==J)return!1;if(J=1,e&&!r.get(l.a).nativeDocument.getElementById("ShellInfoLoaded"))return J=0,!1;r.get(w).initialize();var o=r.get(q.a),a=r.get(b.a);o.start();var s=r.get(T.a);M.setup(s);var d=Math.ceil(A);s.logPerformanceEvent("App_Begin_Bootstrap",d),s.logPerformanceEvent("App_Complete_Bootstrap",Math.ceil(P)-d),r.get(O.a).initialize(s);var f=r.get(K.a),h=f&&f.capabilities.otherFlights||"",m=Object(p.c)(),g=m&&m.sharedClientStartupContext.flights?m.sharedClientStartupContext.flights:"";if(m.sharedClientStartupContext.flights=g+(g?",":"")+h,s instanceof x.a){s.registerOfficeRouteService(o),s.registerServiceWorkerStateService(a,!0);var v=r.get(L.a),y=r.get(D),S=r.get(I.a);s.registerEventFactories([v,y,S])}m.sharedClientStartupContext.oTelEnabled&&r.get(U.a).bootstrapOfficeStart(),Y=!0;var C=r.get(N.b);return r.get(Z).initialize(C),(u=r.get(H.a)).broadcastEvent({name:"appInitialized",args:[]}),function(e,o){Object(i.__awaiter)(t,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(i){return o&&(r.get(U.a).bootstrapOfficeStart(),t=Promise.all([n.e(0),n.e(192)]).then(n.bind(null,"3xKL")),e?Promise.all([n.e(0),n.e(626)]).then(n.bind(null,"hfNz")).then((function(e){e.prefetchNorthStar(),t.then((function(e){e.prefetchEdgeworthData()}))})):t.then((function(e){e.prefetchEdgeworthData()}))),[2]}))}))}(f.capabilities.northStarEnabled,f.capabilities.edgeworthReactEnabled),f.capabilities.showSearch&&s.logGenericEvent("Search_Capability"),r.get(L.b).isFirstVisit()&&s.logGenericEvent("First_Site_Visit"),J=2,!0}catch(e){J=0;var k=!1;if(Y){var F=r.get(c.b);F&&(F.handleError(e,"b0g6P"),k=!0)}return k||_(e,E),!1}};Object(s.a)()?d(!1):d(!0)||(u.events.withScope(0).pipe(Object(o.a)((function(e){return"shellInfoLoaded"===e.name})),Object(a.a)(1)).toPromise().then((function(){return d(!1)})),X.a.shellAndConfigsReady().then((function(){return d(!1)})))}var ee=n("l98w"),te=n("Ft/N"),ne=n("kvyl");function ie(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,r(t+n)];case 1:return o=i.sent(),[4,e.digest({name:"SHA-256"},o)];case 2:return a=i.sent(),[2,Object(ne.a)(new Uint8Array(a))]}}))}))}var re=n("Epfv"),oe=n("pgLp"),ae=n("bN7T"),se=n("jsgn");function ce(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,window.navigator.serviceWorker.getRegistration()];case 1:return[4,e.sent().unregister()];case 2:return e.sent(),window.location.reload(),[2]}}))}))}function le(e,t){var n=new URLSearchParams(window.location.search).get(t);n&&e.searchParams.set(t,n)}function ue(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),le(r=new URL(window.location.origin+"/api/shellandconfigdata"),"mockauth"),le(r,"envType"),le(r,"flight"),r.searchParams.set("workload","officehome"),[4,fetch(r.toString(),{headers:(a={},a[ee.b]=e,a[te.a]=t,a["X-OfficeHome-UserId"]=n,a)})];case 1:return[2,(o=i.sent()).ok?o:null];case 2:return i.sent(),[2,null];case 3:return[2]}}))}))}var de=n("B9sP"),pe=n("W3Zz"),fe=function(){function e(){}return e.prototype.runWhenIdle=function(e){return requestIdleCallback(e)},e.prototype.cancelIdleCallback=function(e){cancelIdleCallback(e)},e}(),he=function(){function e(){}return e.prototype.runWhenIdle=function(e){var t=k.a.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(k.a.now()-t))}})}),1)},e.prototype.cancelIdleCallback=function(e){clearTimeout(e)},e}(),me=function(e){return e.config.automatedTestRunning?new de.e:new de.f},be=function(){return function(){return P=k.a.now()}},ge=function(){return window.queuedEvents||[]},ve=function(){return window.queuedMarks||[]},ye=function(e,t){return e.config.automatedTestRunning||t.deviceInfo.browser.browserType===pe.a.Safari?new he:new fe},Se=function(){return function(){}}(),we=n("XjVN"),Ce=n("SPVw"),Ie=n("b7yv"),Te=n("3g20"),ke=n("vXf5"),_e=n("BaAg"),Ae=n("fGsv"),Pe=n("CMIS"),Ee=n("3GGT"),Oe=n("casz"),Fe=function(){function e(e){this.config=e.parse("userStorageConfig")}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(z.a))},token:e,providedIn:"root"}),e}(),De=function(){function e(e,t,n,i,r,o,a,s,c,l){this.accessTokenService=e,this.contextService=t,this.instrumentationService=n,this.instrumentedHttp=i,this.authStateService=r,this.officeHomeApiConfigService=o,this.userDataStorageConfigService=a,this.globalErrorHandler=c,this.scheduler=l,null!=t.sharedContext.officeHomeApiRoot&&a.config&&null!=a.config.userStorageEndpoint&&(this.serviceUrl=t.sharedContext.officeHomeApiRoot+"/"+a.config.userStorageEndpoint);var u=s.parse("userStorageCache")||{firstUse:!1,firstUseTimestamp:0,content:{}};this.firstUse=u.firstUse,this.firstUseTimestamp=u.firstUseTimestamp,this.masterCollection=u.content}return e.prototype.get=function(e,t){var n=this;return void 0===t&&(t=1),new Promise((function(r,o){if(n.masterCollection.hasOwnProperty(e)){var a=Object(i.__assign)({},n.masterCollection[e]);r(a)}else if(n.firstUse||t<1)r(void 0);else if("SignedIn"===n.authStateService.getCurrentState())if(n.serviceUrl){var s=0,c=function(i,a,l){n.instrumentedHttp.get(i,a,n.serviceUrl+"/"+e+"/",l||{},"network-only").instrument((function(t,n){n.ElementId=e,n.Retry=s.toString()})).then((function(e){return r(e.data)})).catch((function(u){n.globalErrorHandler.handleError(u,"Bn3rc"),u&&u.status===Ee.a.NotFound?r(void 0):u.status!==Ee.a.Forbidden&&s<t-1?(s++,c(i,a,l)):o("Failed to get value from user data storage for <"+e+"> key. Status code: "+u.status)}))};n.request(c,"OfficeHomeStorage_Read_Request","OfficeHomeStorage_Read",o)}else o("User storage does not support roaming");else o("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.set=function(e,t){var n=this;return new Promise((function(r,o){"SignedIn"===n.authStateService.getCurrentState()?(n.masterCollection[e]=Object(i.__assign)({},t),n.serviceUrl?n.request((function(i,a,s){if((s=s||{}).headers||(s.headers=new Map),!n.officeHomeApiConfigService.config.jwtAuthEnabled&&!n.contextService.sharedContext.inMockMode){if(!n.contextService.getCsrfToken())return n.instrumentationService.logErrorEvent("Csrf_Token_Error"),Object(Pe.a)({eventName:"Csrf_Token",errorType:"User_Storage_Error"}),void o("CSRF token missing");s.headers.set("AjaxSessionKey",n.contextService.getCsrfToken())}var c=function(){return n.instrumentedHttp.put(i,a,n.serviceUrl+"/"+e+"/",t,s).instrument((function(t,n){n.ElementId=e})).then((function(){return r(null)})).catch((function(t){n.globalErrorHandler.handleError(t,"J7GBR"),o("Failed to update or create value in roaming user data storage for <"+e+"> key. Status code: "+t.status)}))};n.userDataStorageConfigService.config.deferWrite?n.scheduler.scheduleWork((function(){c()}),4):c()}),"OfficeHomeStorage_Write_Request","OfficeHomeStorage_Write",o):o("User storage does not support roaming")):o("User has to be signed in to access storage for <"+e+"> key.")}))},e.prototype.request=function(e,t,n,i){var r=this;this.officeHomeApiConfigService.config.jwtAuthEnabled?this.accessTokenService.getAccessToken("OfficeHome").then((function(o){if(!o.success)return r.instrumentationService.logRequestEvent(t,Ee.a.TokenUnavailable,-1,"string"==typeof o.error?o.error:""),void i("Token Unavailable");var a={headers:new Map([["Authorization","Bearer "+o.token]])};e(t,n,a)})):e(t,n)},e.prototype.isFirstUse=function(){return this.firstUse},e.prototype.getFirstUseTimestamp=function(){return this.firstUseTimestamp},e.ɵprov=r.cc({factory:function(){return new e(r.dc(N.b),r.dc(B.a),r.dc(T.a),r.dc(W.a),r.dc(Z),r.dc(u.a),r.dc(Fe),r.dc(z.a),r.dc(c.b),r.dc(Oe.a))},token:e,providedIn:"root"}),e}(),Re=n("dmOj"),Me=n("5aVq"),xe=n("w1PR"),Le=n("Ax7d"),Ue=n("LQqy"),Ne=n("PBJH"),je=n("ufVG"),We=n("fVt+"),Be=n("JH4S"),ze=n("Hp80"),Ve=n("k+kJ"),He=n("uUrA"),qe=function(){function e(e,t,n,i,r,o){this.documentService=e,this.uploadConfigService=t,this.uploadButtonService=n,this.accessTokenService=i,this.isConsumer=r,this.capabilitiesService=o,this.enabled=!!this.uploadConfigService.config&&this.uploadConfigService.config.dragAndDropEnabled}return e.prototype.onDragOver=function(e){var t=this;this.enabled&&this.isLocalFile(e.dataTransfer.types)?(e.dataTransfer.dropEffect="copy",this.showOutline(),clearTimeout(this.timeoutTracker),this.timeoutTracker=setTimeout((function(){t.hideOutline()}),300)):e.dataTransfer.dropEffect="none"},e.prototype.onDrop=function(e){var t=this;if(this.enabled&&this.isLocalFile(e.dataTransfer.types)&&e.dataTransfer.files.length>0){var n=e.dataTransfer.files;this.accessTokenService.getAccessToken(this.isConsumer&&!this.capabilitiesService.capabilities.graphApiForV2ConsumerEnabled?"OneDrive":"Graph",!1,null,this.isConsumer||this.uploadConfigService.config.capPopupEnabled,{category:"Upload"}).then((function(){t.uploadFiles(n)})),clearTimeout(this.timeoutTracker),this.hideOutline()}},e.prototype.uploadFiles=function(e){1===e.length?this.uploadButtonService.uploadFile(e[0],null,He.a.createGuid(),"upload-drop",Ve.d.DragAndDrop):this.uploadButtonService.uploadFiles(e,He.a.createGuid(),"upload-drop",Ve.d.DragAndDrop)},e.prototype.showOutline=function(){this.documentService.addCssClassToElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.hideOutline=function(){this.documentService.removeCssClassFromElement(this.documentService.nativeDocument.getElementById(e.ScrollContentId),e.DragAndDropStyle)},e.prototype.isLocalFile=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("Files"!==n&&"application/x-moz-file"!==n)return!1}return!0},e.ScrollContentId="officeHome__scroll-content",e.DragAndDropStyle="drag-and-drop--outline",e}(),Ge=n("vHlr"),Qe=n("JScD"),Ze=n("c8Ce"),Ke=function(){function e(e,t,n,i,r,o,a){this.documentService=e,this.eventService=t,this.titleService=n,this.windowService=i,this.router=r,this.injector=o,this.changeDetectorRef=a,this.backgroundStyle={},this.feedbackEnabled=!1,this.isSearchPage=!1,this.officeHomeClass=[],this.searchUXGeneralFeedbackEnabled=!1,this.viewInitializationCompleted=!1,this.viewListenersInitialized=!1}return e.prototype.ngOnInit=function(){var e=this;this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"appInitialized"===e.name})),Object(a.a)(1)).toPromise().then((function(){var t=e.injector.get(pe.b),i=e.injector.get(Qe.a),r=e.injector.get(Ge.a),s=e.injector.get(N.b);e.searchConfigService=e.injector.get(Te.a),e.startupConfigService=e.injector.get(p.b),e.capabilitiesService=e.injector.get(K.a),e.contextService=e.injector.get(B.a),e.instrumentationService=e.injector.get(T.a),e.officeRouteService=e.injector.get(q.a),e.officeTitleService=e.injector.get(Re.a),e.themingService=e.injector.get(xe.b),e.userProfileService=e.injector.get(L.b),e.featureCalloutService=e.injector.get(Ce.a),e.locService=e.injector.get(Ne.a),e.reactShellConfigService=e.injector.get(je.a);var c=e.injector.get(Le.a),l=e.injector.get(Be.a);e.userStorageService=e.injector.get(De),e.isStandalone=c.isStandalone,e.isMobile=t.isMobileDevice();var u=e.capabilitiesService.capabilities;e.showMobileAppBanner=e.isMobile||t.isTabletDevice(),e.uploadEnabled=(u.oneDriveUploadEnabled||u.swayCreateNewEnabled)&&!!i.config,e.supportCentralEnabled=u.supportCentralEnabled&&!e.isMobile,e.isConsumer=e.startupConfigService.config.authType===p.a.MSA,e.bottomTrayEnabled=u.bottomTrayEnabled,e.searchEnabled=u.showSearch&&!!e.searchConfigService.config&&!u.mobileCustomSearchEnabled,e.fluidSupportEnabled=u.fluidSupportEnabled,e.showPremiumUpsellModal=!1,e.nativeSearchEnabled=e.searchEnabled&&u.nativeSearchInHeaderEnabled,e.leftNavReact=e.capabilitiesService.capabilities.leftNavReact&&!e.capabilitiesService.capabilities.appBarEnabled;var d=e.capabilitiesService.capabilities.leftNavReact||e.capabilitiesService.capabilities.appBarEnabled;e.appBarEnabled=e.capabilitiesService.capabilities.appBarEnabled,e.appGalleryReactEnabled=e.capabilitiesService.capabilities.appGalleryReactEnabled,e.stayingAware=d&&e.capabilitiesService.capabilities.stayingAwareEnabled,e.customPivots=d&&e.capabilitiesService.capabilities.quickAccessV1CustomPivotEnabled,e.themeRootCssClass=ke.b,e.toastContainer=e.capabilitiesService.capabilities.contentActionsEnabled,e.wacHostEnabled=e.capabilitiesService.openWithUIHost,e.isIE=t.deviceInfo.browser.browserType===pe.a.IE,e.webVitalsEnabled=e.capabilitiesService.capabilities.webVitalsEnabled,e.memoryProfilingEnabled=e.capabilitiesService.capabilities.memoryProfilingEnabled,e.fluentThemeRefreshEnabled=e.capabilitiesService.capabilities.fluentRefresh,e.fluentHeaderEnabled=e.capabilitiesService.capabilities.fluentHeader,e.actionContextMenuEnabled=u.contentActionsEnabled&&e.capabilitiesService.capabilities.contentActionsOHomeEnabled;var f=e.capabilitiesService.capabilities.newUserShelfOverride,h=e.capabilitiesService.capabilities.newConsumerOverride,m=e.capabilitiesService.capabilities.newUserShelfEnabled&&e.capabilitiesService.capabilities.createCenterEnabled,b=e.capabilitiesService.capabilities.newConsumerExperienceEnabled,g=e.userStorageService.isFirstUse(),v=e.isConsumer&&(b&&m||h||f)&&!e.isMobile,y=!e.isConsumer&&(f||m)&&!e.isMobile;(y||v)&&(e.showNewCommercialUserShelfExpanded=y&&(g||f),e.showNewConsumerExperiences=e.contextService.isNewConsumerUserExperience=v&&(g||f||h),g?e.userProfileService.incrementMetric("Impressions_Since_First_Visit"):e.userProfileService.doesMetricExist("Impressions_Since_First_Visit").then((function(t){if(t){e.userProfileService.incrementMetric("Impressions_Since_First_Visit");var n=e.userProfileService.getInitialMetric("Impressions_Since_First_Visit");n&&n.count<=5&&(e.showNewUserShelfCollapsed=y,e.showNewConsumerExperiences=e.contextService.isNewConsumerUserExperience=v||f||h)}}))),e.injector.get(Ie.a).getConfig().then((function(t){e.firstRunEnabled=!l.user.hasNoLicense&&!!t&&!!t.model,e.featureCalloutSubscription=e.featureCalloutService.callouts.subscribe((function(t){e.loadFeatureCalloutModule=t.length>0}))})),e.scheduler=e.injector.get(Oe.a),e.isConsumer?e.capabilitiesService.capabilities.userConsentCallEnabled?e.injector.get(We.a).getConfig().then((function(t){e.feedbackEnabled=0===t.userConsent&&u.showFeedback&&!e.isMobile,0===t.userConsent&&e.prepareUpsellButton()})):(e.feedbackEnabled=u.showFeedback&&!e.isMobile,e.prepareUpsellButton()):e.capabilitiesService.capabilities.adminPolicyEnabled?(e.adminPolicyService=e.injector.get(Ae.a),e.adminPolicyService.getAdminPolicy().then((function(t){e.feedbackEnabled=!!t&&u.showFeedback&&!e.isMobile&&t.SendFeedback.State}))):e.feedbackEnabled=u.showFeedback&&!e.isMobile,e.officeHomeClass=["angular-root"],e.backgroundStyle["background-image"]="url("+e.contextService.sharedContext.fluentHeroImageUrl+")",e.setupNavigationHandler(),e.viewInitializationCompleted=!0,e.shellHeader=e.documentService.nativeDocument.getElementById("ReactShellHeader"),e.mobileMenusEnabled=e.capabilitiesService.capabilities.mobileContextMenusEnabled,e.isMobile&&e.instrumentationService.logGenericEvent("Mobile_View",{},["Mobile_View"]),e.viewMetric=e.userProfileService.getInitialMetric(e.isMobile?"Mobile_View":"Home_PageView"),!e.isIE&&(e.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"firstRunModalOpen"===e.name})),Object(a.a)(1)).toPromise().then((function(){e.officeHomeClass.push("blur-background"),e.shellHeader.classList.add("blur-background")})),e.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"firstRunModalClosed"===e.name||"premiumTemplatesUpsellClosed"===e.name})),Object(a.a)(1)).toPromise().then((function(){var t=e.officeHomeClass.indexOf("blur-background");t>=0&&e.officeHomeClass.splice(t,1),e.shellHeader.classList.remove("blur-background")}))),e.fluentThemeRefreshEnabled&&(e.fluentProviderClassSubscription=e.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"fluentClassNameChanged"===e.name}))).subscribe((function(t){e.themeRootCssClass=ke.b+" "+t.args[0],e.changeDetectorRef.detectChanges()}))),e.dragAndDropUtility=new qe(e.documentService,i,r,s,e.isConsumer,e.capabilitiesService),e.injector.get(Me.a).getShellShim().then((function(t){if(t.Header&&t.Header.OnShyHeaderModeChanged((function(t){if(t)e.officeHomeClass.push("angular-root--hidden-shell");else{var n=e.officeHomeClass.indexOf("angular-root--hidden-shell");n>=0&&e.officeHomeClass.splice(n,1)}e.changeDetectorRef.detectChanges()})),t.GetResourceLoader){var n=t.GetResourceLoader();u.nativeSearchInHeaderEnabled?n.registerResourceCallback((function(t){4!==t&&e.scheduler.scheduleWork((function(){n.loadNext()}),void 0===t||3===t?4:1)})):e.scheduler.scheduleWork((function(){n.loadAll()}),4)}})),e.isConsumer&&e.scheduler.scheduleWork((function(){Promise.all([n.e(4),n.e(656)]).then(n.bind(null,"T8N+")).then((function(t){e.meetNowButtonUtility=new t.MeetNowButton(e.contextService,e.eventService,e.injector)}))}),4),e.changeDetectorRef.detectChanges()})),this.dialogOpenSubscription=this.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"premiumTemplatesUpsellStarted"===e.name}))).subscribe((function(){e.injector.get(Ze.a).getConfig().then((function(t){t&&t.model&&(e.showPremiumUpsellModal=!0)}))})),this.dialogCloseSubscription=this.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"premiumTemplatesUpsellClosed"===e.name}))).subscribe((function(){e.showPremiumUpsellModal=!1})),this.searchUXGeneralFeedbackSubscription=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"searchUXGeneralFeedbackEnabled"===e.name}))).subscribe((function(){e.searchUXGeneralFeedbackEnabled=!0}))},e.prototype.ngDoCheck=function(){this.viewInitializationCompleted&&(this.viewListenersInitialized||(this.viewListenersInitialized=!0,this.setAuthStateListener()),this.router.navigated||this.router.initialNavigation())},e.prototype.ngOnDestroy=function(){var e;this.authStateChangeSubscription&&this.authStateChangeSubscription.unsubscribe(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe(),this.routeChangeEndSubscription&&this.routeChangeEndSubscription.unsubscribe(),this.backgroundImageSubscription&&this.backgroundImageSubscription.unsubscribe(),this.featureCalloutSubscription&&this.featureCalloutSubscription.unsubscribe(),this.upsellButtonUtility&&this.upsellButtonUtility.unsubscribe(),this.meetNowButtonUtility&&this.meetNowButtonUtility.unsubscribe(),this.dialogOpenSubscription&&this.dialogOpenSubscription.unsubscribe(),this.dialogCloseSubscription&&this.dialogCloseSubscription.unsubscribe(),this.searchUXGeneralFeedbackSubscription&&this.searchUXGeneralFeedbackSubscription.unsubscribe(),null===(e=this.fluentProviderClassSubscription)||void 0===e||e.unsubscribe()},e.prototype.onWindowResize=function(){this.eventService.broadcastEvent({name:"windowResized",args:[]})},e.prototype.onWindowFocus=function(){this.eventService.broadcastEvent({name:"windowFocused",args:[]})},e.prototype.onBeforeInstall=function(e){this.eventService.broadcastEvent({name:"beforeInstallPrompt",args:[e]})},e.prototype.onAppInstalled=function(){var e=this.isMobile?"App_Added_To_Home_Screen_Mobile":"App_Added_To_Home_Screen_Desktop";this.instrumentationService.logGenericEvent(e,{},[e])},e.prototype.onResize=function(e){var t=e.width,n=e.height;this.contentWidth!==t&&(this.contentWidth=t,this.eventService.broadcastEvent({name:"contentWidthChanged",args:[t]})),this.contentHeight!==n&&(this.contentHeight=n,this.eventService.broadcastEvent({name:"contentHeightChanged",args:[n]}))},e.prototype.dragoverHandler=function(e){e.preventDefault(),this.dragAndDropUtility.onDragOver(e)},e.prototype.dropHandler=function(e){e.preventDefault(),this.dragAndDropUtility.onDrop(e)},e.prototype.shouldShowFeedbackButton=function(){return this.feedbackEnabled&&!this.onWacContentPage&&!this.onM365AppsPage&&!(this.isSearchPage&&this.searchUXGeneralFeedbackEnabled)},e.prototype.setAuthStateListener=function(){var e=this;this.authStateChangeSubscription=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"authStateChanged"===e.name}))).subscribe((function(t){var n=t.args[0],i=null==n?void 0:n.LoginState,r=e.capabilitiesService.capabilities.accountSwitchingEnabled;if(r&&"AccountMismatch"===i){var o=e.windowService.nativeWindow;o.MastInteraction.UpdateAccount(n.CurrentAccountPuid,{authenticatedState:1,idp:n.CurrentAccountType,upn:n.CurrentAccountUpn},!0),o.MastInteraction.ShowPrompt("SwitchAccount")}else if(e.capabilitiesService.capabilities.redirectWhenSignedOutFromWorkloads&&"SignedOut"===i||!r&&"AccountMismatch"===i){e.flushLogs();var a=e.getSignOutLandingUrl();a?e.windowService.nativeWindow.open(a,"_self"):e.windowService.nativeWindow.location.reload(!1)}else if(e.capabilitiesService.capabilities.reloadWhenAuthExpired&&"Expired"===i||e.capabilitiesService.capabilities.reloadWhenReauthRequired&&"ReauthenticationRequired"===i||e.capabilitiesService.capabilities.reloadWhenPolicyCheckFailed&&"PolicyCheckFailed"===i)e.onWacContentPage||(e.flushLogs(),e.windowService.nativeWindow.location.reload(!1));else if(e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityAuto"===i){e.flushLogs();var s=e.locService.format(e.contextService.sharedContext.signOutUrlTemplate,encodeURIComponent(e.contextService.sharedContext.abtSignoutPath+"?rs="+e.contextService.sharedContext.officeMarket+"&build="+e.startupConfigService.config.sharedClientStartupContext.buildId+"&ru="+encodeURIComponent(e.windowService.nativeWindow.location.pathname+e.windowService.nativeWindow.location.search)+"&upn="+e.startupConfigService.config.userPrincipalName));e.windowService.nativeWindow.open(s,"_self")}else e.capabilitiesService.capabilities.activityBasedTimeoutEnabled&&"SignedOutBasedOnActivityUserClick"===i&&(e.flushLogs(),e.windowService.nativeWindow.open(e.reactShellConfigService.reactShellConfig.logoutUrl,"_self"))}))},e.prototype.setupNavigationHandler=function(){var e=this,t=this.officeRouteService.getRouteChangeStartObservable(),n=this.officeRouteService.getRouteChangeEndObservable();this.routeChangeSubscription=t.subscribe((function(t){var n=t.currentRoute.route;if("Content"!==n){var i=e.officeTitleService.getTitle(t.currentRoute),r=void 0;"MyForms"===n?r=e.locService.MyFormsHeroTitle:"GroupForms"===n&&(r=e.locService.GroupFormsTitle),e.titleService.setTitle(r?i+" - "+r:i)}e.loadShareControlModuleForContentPage="Content"===n,e.capabilitiesService.capabilities.wacHostMoveToFolderEnabled&&(e.loadMoveToFolderModuleForContentPage="Content"===n),e.nativeSearchEnabled=("Content"!==n||!t.currentRoute.app||t.currentRoute.app!==_e.b.Fluid)&&e.searchEnabled&&e.capabilitiesService.capabilities.nativeSearchInHeaderEnabled,e.documentService.updateFavicon(e.officeTitleService.getFavicon(t.currentRoute)),e.isSearchPage="Search"===n||"SearchSiteScoped"===n,e.onM365AppsPage="M365Apps"===n,e.onAppGallery="AppGallery"===n,e.onHomePage="OfficeHome"===n,e.onMyContentPage="MyContent"===n,e.onFeedPage="Feed"===n,e.newOfficeTwoExperience=e.capabilitiesService.capabilities.quickAccessV1Enabled&&e.capabilitiesService.capabilities.edgeworthEnabled,e.newOfficeHomePageExperience=e.onHomePage&&e.newOfficeTwoExperience,e.sidePopUpEnabled="MyForms"===n||"GroupForms"===n||"Start"===n&&t.currentRoute.app===_e.b.Forms,e.createOneNotePageEnabled=e.capabilitiesService.capabilities.createOneNotePageEnabled&&!(e.onHomePage&&e.capabilitiesService.capabilities.createCenterEnabled),e.taskModule=e.capabilitiesService.capabilities.m365AppsEnabled,e.hideCustomSearch=e.capabilitiesService.capabilities.nativeSearchInHeaderEnabled,e.showFASTBreadcrumb="SearchSiteScoped"===n,e.showWorkspaceNav="AppGallery"===n&&!e.appGalleryReactEnabled})),this.routeChangeEndSubscription=n.subscribe((function(t){e.onContentPage="Content"===t.currentRoute.route,e.onWacContentPage=e.onContentPage&&t.currentRoute.app!==_e.b.Fluid,e.onFluidContentPage=e.onContentPage&&t.currentRoute.app===_e.b.Fluid})),this.backgroundImageSubscription=Object(we.b)(this.themingService.themeShades,t).subscribe((function(t){var n=Object(i.__read)(t,2),r=n[0],o=n[1].currentRoute;e.showBackgroundImage=r.theme.reactShellTheme&&!r.theme.reactShellTheme.IsDarkMode&&("App"===r.theme.themeType||"Default"===r.theme.themeType)&&!!e.contextService.sharedContext.fluentHeroImageUrl&&!e.capabilitiesService.capabilities.leftNavReact&&!e.isConsumer&&!(o&&o.app)&&"AppGallery"!==o.route}))},e.prototype.flushLogs=function(){this.instrumentationService.flush()},e.prototype.getSignOutLandingUrl=function(){var e,t,n=this.contextService.sharedContext.signOutRedirectUrl;if(!n)return n;var r=this.windowService.nativeWindow.location.search;if(!r)return n;r.startsWith("?")&&(r=r.substr(1));var o=n.split("#"),a=2===o.length?o[1]:"",s=(o=o[0].split("?"))[0],c=2===o.length?o[1]:"",l=r.split("&");try{for(var u=Object(i.__values)(l),d=u.next();!d.done;d=u.next()){var p=d.value,f=p.split("=")[0].toLowerCase();"auth"!==f&&"mockauth"!==f&&(c+=(c?"&":"")+p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return n=s,c&&(n+="?"+c),a&&(n+="#"+a),n},e.prototype.prepareUpsellButton=function(){var e=this;this.scheduler.scheduleWork((function(){n.e(660).then(n.bind(null,"r8hs")).then((function(t){e.upsellButtonUtility=new t.UpsellButton(e.injector.get(Ue.a),e.contextService,e.eventService,e.injector,e.officeRouteService,e.capabilitiesService,e.injector.get(ze.a))}))}),4)},e}(),Xe=n("fYis"),Je=n("TOqr"),Ye=n("dvrM"),$e=n("W0EU"),et=n("pzhl"),tt=n("PkQn"),nt=n("xSeq"),it=n("xJIt"),rt=n("cj6A"),ot=n("R0N1"),at=n("lUkk"),st=n("rTyw"),ct=n("BJFG"),lt=n("ExL+"),ut=n("hoyd"),dt=n("pjz5"),pt=function(){function e(e){this.config=e.parse("appTilesConfig")||{coreAppIds:[],mobileAppIds:[],myAccountUrl:null,resources:null,segmentSpecificAppIds:[]}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(z.a))},token:e,providedIn:"root"}),e}(),ft=function(){function e(e,t,n,i,o,a,s,c,l,u,d){this.appTilesConfigService=e,this.capabilitiesService=t,this.contextService=n,this.eventService=i,this.instrumentationService=o,this.workloadsService=a,this.appLauncherService=s,this.locService=c,this.changeDetectorRef=l,this.themingService=u,this.shellService=d,this.unpinWorkload=new r.n}return Object.defineProperty(e.prototype,"forceWhiteBackground",{get:function(){return this._forceWhiteBackground},set:function(e){this._forceWhiteBackground=e,this.setBackgroundColor()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showHover",{get:function(){return this._showHover},set:function(e){this._showHover=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this,t=this.appTilesConfigService.config;this.isProvisioned=!!this.workload.Url,this.ariaLabel=this.workload.Text,this.thirdPartyIconAriaLabel=this.locService.format(this.locService.ThirdPartyIconAriaLabel,this.workload.Text),this.preloadPath=this.workload.InAppNav?"Start":dt.a.getOrigin(this.workload.Url),this.removeAppAriaLabel=this.locService.RemoveDocumentActionTitle,this.isProvisioned?(this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(t){e.appColor=t&&e.workload.ChangeColorInDarkMode?"white":""}))),this.setBackgroundColor()):this.provisioningText=t.resources&&t.resources.ProvisioningTileText},e.prototype.ngOnChanges=function(e){e.hasOwnProperty("workload")&&(this.elementId=e.workload.currentValue.Id+"_link",this.setBackgroundColor(),this.iconLoaded=this.iconLoaded&&e.workload.currentValue.ThirdPartyIcon===e.workload.previousValue.ThirdPartyIcon)},e.prototype.ngOnDestroy=function(){this.themeShadesSubscription&&this.themeShadesSubscription.unsubscribe()},e.prototype.mouseOverTile=function(){this.workload.Url&&(this.showHover=!0),this.checkedODSPProvisioningStatus||this.workload.FileType!==_e.b.SharePoint&&this.workload.FileType!==_e.b.OneDrive||(this.shellService.initializeProvisioningStatus(),this.checkedODSPProvisioningStatus=!0)},e.prototype.onTileClick=function(e){var t=this;if(this.showHover=!1,this.workload.Url||!e){var i="_blank"===this.contextService.sharedContext.defaultLinkTarget;i||this.instrumentTileClick("Web"),this.capabilitiesService.capabilities.contentLauncherEnabled?Promise.all([n.e(0),n.e(1),n.e(2)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchApp({action:"OpenAppTile",event:e,appName:t.workload.Text,url:t.workload.Url}).then((function(e){i&&t.instrumentTileClick(e.result)}))})):this.appLauncherService.launchApp(this.workload,e,"OpenAppTile").then((function(e){i&&t.instrumentTileClick(e)}))}else e.preventDefault()},e.prototype.unfocusTile=function(){this.showHover=!1},e.prototype.instrumentTileClick=function(e){var t=e?this.workload.Referral:"",n=T.b.AppTiles,i={};i.State=this.inExpandedView?"expanded":"reduced",i.ReferralType=this.workloadsService.getReferralType(this.workload).toString(),this.instrumentationService.logClickEvent("Generic_Click",this.elementId,n,t,"Native"===e?"Native":"Web",i,[],0,this.workload.InAppNav),Object(at.a)({id:this.elementId,area:n,result:t?"Refer":"Navigate",target:t?Object(st.a)(t):"Other"}),this.eventService.broadcastEvent({name:"appTileClick",args:[this.workload.AppId]})},e.prototype.instrumentRightClick=function(){var e={};e.ElementId=this.elementId,this.instrumentationService.logGenericEvent("App_Tile_Right_Click",e)},e.prototype.onIconLoad=function(){var e=this;setTimeout((function(){e.iconLoaded=!0,e.changeDetectorRef.markForCheck()}))},e.prototype.onIconError=function(){var e=this;setTimeout((function(){e.iconLoaded=!1,e.changeDetectorRef.markForCheck()}))},e.prototype.unpinApp=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return e&&e.preventDefault(),this.unpinWorkload.emit({item:this.workload}),[2]}))}))},e.prototype.setBackgroundColor=function(){this.setWhiteBackground=this.forceWhiteBackground},e}(),ht=r.xb({encapsulation:2,styles:[],data:{}});function mt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-icon-font",[],null,null,null,et.b,et.a)),r.yb(1,638976,null,0,tt.a,[K.a],{iconFontCssClass:[0,"iconFontCssClass"],iconFontName:[1,"iconFontName"],isThirdParty:[2,"isThirdParty"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.workload.IconUnicodeCodepointCssClass+" app-tile-icon--small",n.workload.IconFont,n.workload.IsThirdParty)}),null)}function bt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,0,"img",[["aria-hidden","true"],["class","workload-item__icon--image"]],[[8,"hidden",0],[8,"src",4],[1,"alt",0]],[[null,"load"],[null,"error"]],(function(e,t,n){var i=!0,r=e.component;return"load"===t&&(i=!1!==r.onIconLoad()&&i),"error"===t&&(i=!1!==r.onIconError()&&i),i}),null,null))],null,(function(e,t){var n=t.component;e(t,0,0,!n.iconLoaded,n.workload.ThirdPartyIcon,n.thirdPartyIconAriaLabel)}))}function gt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"span",[["class","workload-item-text--provisioning--fluent"]],null,null,null,null,null)),(e()(),r.Yb(1,null,[" "," "]))],null,(function(e,t){e(t,1,0,t.component.provisioningText)}))}function vt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,2,"span",[["class","workload-item__unpin ms-fcl-nd ms-fcl-tp-h ms-fcl-tp-f ms-bgc-g40-h ms-bgc-g40-f"],["role","button"],["tabindex","0"]],[[1,"aria-label",0],[8,"title",0]],[[null,"click"],[null,"keyup.enter"],[null,"keyup.space"],[null,"focus"],[null,"blur"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.enter"===t&&(i=!1!==r.unpinApp(n)&&i),"keyup.space"===t&&(i=!1!==r.unpinApp(n)&&i),"focus"===t&&(i=!1!==r.mouseOverTile()&&i),"blur"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),(e()(),r.zb(1,0,null,null,1,"ohp-icon-font",[["iconFontName","X"]],null,null,null,et.b,et.a)),r.yb(2,638976,null,0,tt.a,[K.a],{iconFontName:[0,"iconFontName"]},null)],(function(e,t){e(t,2,0,"X")}),(function(e,t){var n=t.component;e(t,0,0,n.removeAppAriaLabel,n.removeAppAriaLabel)}))}function yt(e){return r.bc(2,[(e()(),r.zb(0,0,null,null,26,"div",[["class","workload-item animated-tile"]],null,[[null,"mouseover"],[null,"contextmenu"],[null,"mouseleave"]],(function(e,t,n){var i=!0,r=e.component;return"mouseover"===t&&(i=!1!==r.mouseOverTile()&&i),"contextmenu"===t&&(i=!1!==r.instrumentRightClick()&&i),"mouseleave"===t&&(i=!1!==r.unfocusTile()&&i),i}),null,null)),(e()(),r.zb(1,0,null,null,25,"a",[["class","o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f"],["data-clicklog","custom"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[8,"id",0],[8,"href",4],[1,"aria-label",0],[8,"target",0]],[[null,"focus"],[null,"blur"],[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var i=!0,o=e.component;return"mouseenter"===t&&(i=!1!==r.Ob(e,5).onMouseEnter()&&i),"mouseleave"===t&&(i=!1!==r.Ob(e,5).onMouseLeave()&&i),"focus"===t&&(i=!1!==o.mouseOverTile()&&i),"blur"===t&&(i=!1!==o.unfocusTile()&&i),"click"===t&&(i=!1!==o.onTileClick(n)&&i),i}),null,null)),r.yb(2,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(3,{"workload-item--provisioning":0,"workload-item--provisioned workload-item--fluent--provisioned":1,"ms-bgc-w":2}),r.yb(4,4210688,null,0,nt.a,[r.l,r.h],{focusOnLoad:[0,"focusOnLoad"],detectChanges:[1,"detectChanges"]},null),r.yb(5,16384,null,0,it.a,[rt.a],{preloadPath:[0,"preloadPath"]},null),r.yb(6,81920,null,0,ot.a,[B.a],null,null),(e()(),r.zb(7,0,null,null,8,"span",[["class","workload-item__icon"]],null,null,null,null,null)),r.yb(8,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(9,{"workload-item__icon--3rd-party-image":0}),r.yb(10,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(11,{color:0}),(e()(),r.ib(16777216,null,null,1,null,mt)),r.yb(13,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,bt)),r.yb(15,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(16,0,null,null,8,"div",[["class","workload-item__name"]],[[8,"id",0]],null,null,null,null)),r.yb(17,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(18,{color:0}),(e()(),r.zb(19,0,null,null,5,"div",[["class","workload-item__text"]],[[8,"title",0]],null,null,null,null)),r.yb(20,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(21,{"workload-item__text--third-party":0,"ms-fcl-nd":1}),(e()(),r.Yb(22,null,[" "," "])),(e()(),r.ib(16777216,null,null,1,null,gt)),r.yb(24,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,vt)),r.yb(26,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,!n.isProvisioned,n.isProvisioned,n.setWhiteBackground);e(t,2,0,"o365cs-base workload-item__link ms-bgc-w-h ms-bgc-w-a ms-bgc-w-f",i),e(t,4,0,n.focusOnLoad,!0),e(t,5,0,n.preloadPath),e(t,6,0);var r=e(t,9,0,n.workload.IsThirdParty);e(t,8,0,"workload-item__icon",r);var o=e(t,11,0,n.isProvisioned?n.appColor||n.workload.Color:"");e(t,10,0,o),e(t,13,0,!n.workload.ThirdPartyIcon||!n.iconLoaded),e(t,15,0,n.workload.ThirdPartyIcon);var a=e(t,18,0,n.showHover&&n.isProvisioned?n.appColor||n.workload.Color:"");e(t,17,0,a);var s=e(t,21,0,n.workload.IsThirdParty,!n.showHover);e(t,20,0,"workload-item__text",s),e(t,24,0,!n.isProvisioned),e(t,26,0,n.pinnedApp)}),(function(e,t){var n=t.component;e(t,1,0,r.Gb(1,"",n.elementId,""),r.Gb(1,"",n.workload.Url,""),n.ariaLabel,r.Ob(t,6).target),e(t,16,0,r.Gb(1,"",n.elementId,"_text")),e(t,19,0,n.workload.Text),e(t,22,0,n.workload.Text)}))}r.vb("ohp-app-tile",ft,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,yt,ht)),r.yb(1,770048,null,0,ft,[pt,K.a,B.a,H.a,T.a,ut.a,ct.a,Ne.a,r.h,xe.b,lt.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{workload:"workload",inExpandedView:"inExpandedView",focusOnLoad:"focusOnLoad",pinnedApp:"pinnedApp",forceWhiteBackground:"forceWhiteBackground"},{unpinWorkload:"unpinWorkload"},[]);var St=n("gZ+X"),wt=n("XWg3"),Ct=n("sVeK"),It=n("laSs"),Tt=n("+ucO"),kt=n("+YV+"),_t=n("7wk3"),At=n("6Po3"),Pt=n("6nG3"),Et=n("U8M1"),Ot=n("uzn7"),Ft=n("9MHL"),Dt=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d,p,f,h,m){this.appGalleryConfigService=e,this.appTilesConfigService=t,this.capabilitiesService=n,this.consumerInstallConfigService=i,this.floodgateService=r,this.instrumentationService=o,this.performanceService=a,this.officeRouteService=s,this.startupConfigService=c,this.workloadsService=l,this.browserPaintMeasurementService=u,this.localStorageService=d,this.createMenuService=p,this.oneDriveUploadService=f,this.browserPaintService=h,this.changeDetector=m,this.fullBleedTheming=!1,this.fullBleedFontColor="",this.fullBleedBackplateEnabled=!1,this.fullBleedBackplateStyle={},this.rectangularMobileMaxInitialItems=4,this.appGalleryRoute="AppGallery",this.createMenuEnabled=!1}return e.prototype.ngAfterViewInit=function(){var t=this;e.loggedMarker||(this.performanceService.mark("App_Tiles_Ready"),e.loggedMarker=!0),this.previousRouteSubscription=this.officeRouteService.subscribeToRouteChangeEnd((function(e){return t.previousRoute=e.previousRoute?e.previousRoute.route:null})),this.appGalleryLinkSubscription=this.appGalleryLink.changes.subscribe((function(e){"AppGallery"===t.previousRoute&&e&&1===e.length&&t.browserPaintService.runAfterPaint((function(){e.first.nativeElement.focus(),t.appGalleryLinkSubscription.unsubscribe()}))})),this.browserPaintMeasurementService.recordWhenPainted("App_Tiles")},e.prototype.ngOnInit=function(){var e=this;this.componentArea=T.b.AppTiles;var t=this.appTilesConfigService.config.resources;this.sectionTitle=t&&t.AppTilesHeader,this.provisioningAlertText=t&&t.ProvisioningAlertText,this.showLessAppTilesText=t&&t.ShowLessAppTiles,this.exploreYourAppsAriaLabel=t&&t.ExploreYourAppsAriaLabel,this.exploreYourAppsText=t&&t.ExploreYourAppsText,this.appTilesLandmarkAriaLabel=t&&t.AppTilesListLandmarkAriaLabel,this.myAccountLinkText=t&&t.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.isConsumer=this.startupConfigService.config.authType===p.a.MSA,this.bottomTrayEnabled=this.capabilitiesService.capabilities.bottomTrayEnabled,this.isConsumer&&this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Pt.b.NotDetected;e.isPaidConsumer=!(n===Pt.b.NotSubscribed||n===Pt.b.NonActive||n===Pt.b.NotDetected)})),this.createMenuService.createButtonEnabledPromise.then((function(t){e.createMenuEnabled=e.createMenuEnabled||t})),this.oneDriveUploadService.uploadEnabledPromise.then((function(t){e.createMenuEnabled=e.createMenuEnabled||t})),this.initWorkloads()},e.prototype.ngOnDestroy=function(){this.appGalleryLinkSubscription&&this.appGalleryLinkSubscription.unsubscribe(),this.previousRouteSubscription&&this.previousRouteSubscription.unsubscribe(),this.thirdPartyWorkloadsSubscription&&this.thirdPartyWorkloadsSubscription.unsubscribe()},e.prototype.onUnpinWorkload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.workloadsService.unpinWorkload(e.item)];case 1:return t.sent(),this.workloads=this.workloads.filter((function(t){return!(t.AppId===e.item.AppId&&t.CollectorId===e.item.CollectorId)})),this.changeDetector.detectChanges(),[2]}}))}))},e.prototype.trackByWorkloadId=function(e,t){return t.Id},e.prototype.isShowingReducedAppTiles=function(){return"Reduced"===this.appTilesState},e.prototype.getDisplayedAppTilesCount=function(){return this.isShowingReducedAppTiles()?Math.min(this.reducedTilesCount,this.workloads.length):this.workloads.length},e.prototype.navigateToAppsPage=function(e){null==e||e.preventDefault(),this.officeRouteService.navigateTo({route:"AppGallery"})},e.prototype.initWorkloads=function(){var e=this;this.isConsumer?this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){return e.setupWorkloads(t)})):this.workloadsService.getWorkloads().then((function(t){return e.setupWorkloads(t)}))},e.prototype.setupWorkloads=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return t=this.appTilesConfigService.config,this.workloads=e.map((function(e){return Object(i.__assign)({},e)})),this.appGalleryConfigService.config&&(this.workloads.length>0?this.showAppGalleryLink=!0:this.thirdPartyWorkloadsSubscription=this.workloadsService.getThirdPartyWorkloads().subscribe((function(e){e.length>0&&(r.showAppGalleryLink=!0,r.thirdPartyWorkloadsSubscription.unsubscribe())}))),this.showProvisioningAlert=this.workloads.some((function(e){return!e.Url})),n=!1,this.workloads.forEach((function(e,t){e.ClickCount>0&&r.capabilitiesService.capabilities.showFloodgate&&r.capabilitiesService.capabilities.officeHomeFloodgate&&!n&&(n=!0)})),n&&this.floodgateService.recordFloodgate(["ClickedOneApp"]),this.sortTiles(t.mobileAppIds),[4,this.setUpReducedTiles()];case 1:return o.sent(),this.isConsumer||this.showAppGalleryLink&&(this.instrumentationService.logImpressionEvent("ExploreAllYourApps_Impression"),Object(It.a)({eventName:"ExploreAllYourApps_Impression",area:this.componentArea})),this.workloadsService.getAdditionalWorkloads().then((function(e){var t;e&&e.length>0&&(e=e.filter((function(e){return!e.IsNativeClientOnlyApp||r.localStorageService.get("AppClicked_"+e.Id)})),r.workloadsService.populateWorkloadFields(e),(t=r.workloads).splice.apply(t,Object(i.__spread)([r.reducedTilesCount,0],e)),r.reducedTilesCount+=e.length)})),[2]}}))}))},e.prototype.setUpReducedTiles=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(t){return this.workloads?[2,this.workloadsService.getCoreSegmentAndFrequentApps().then((function(t){e.appTilesState="Reduced",e.reducedTilesCount=t.length,e.logImpressionRenderedItems(e.getDisplayedAppTilesCount())}))]:[2]}))}))},e.prototype.sortTiles=function(e){if(e){var t=this.workloads.slice(0,this.workloads.length);this.workloads=this.workloads.sort((function(n,i){for(var r=0;r<e.length;r++){var o=e[r];if(n.Id===o)return-1;if(i.Id===o)return 1}for(r=0;r<t.length;r++){if(t[r]===n)return-1;if(t[r]===i)return 1}return 0}))}},e.prototype.logImpressionRenderedItems=function(e){var t=[];this.workloads&&(t=this.workloads.slice(0));var n=function(n){return t.reduce((function(t,i,r){return r<e&&(n&&i.Url||!n&&!i.Url)?t+(0===t.length?"":";")+i.Id:t}),"")},i={};i.RenderSize=e.toString(),i.Distribution=n(!0);var r=n(!1);i.Provisioning=r,i.State="Mobile",i.TotalSize=this.workloads?this.workloads.length.toString():"0",i.Action=this.appTilesState,this.instrumentationService.logImpressionEvent("App_Tiles_Impression",i)},e.loggedMarker=!1,e}(),Rt=r.xb({encapsulation:2,styles:[],data:{animation:[{type:7,name:"fadeOut",definitions:[{type:1,expr:":leave",animation:{type:10,animation:{type:8,animation:[{type:6,styles:{opacity:1},offset:null},{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"{{ fadeDuration }} 0ms linear"}],options:{params:{fadeDuration:"100ms"}}},options:null},options:null}],options:{}}]}});function Mt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,4,"div",[["class","tiles-section__alert--fluent ms-fcl-nd"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(2,{color:0}),(e()(),r.zb(3,0,null,null,1,"ohp-alert-message",[],null,null,null,Ye.b,Ye.a)),r.yb(4,49152,null,0,$e.a,[],{message:[0,"message"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,4,0,n.provisioningAlertText)}),null)}function xt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,yt,ht)),r.yb(1,770048,null,0,ft,[pt,K.a,B.a,H.a,T.a,ut.a,ct.a,Ne.a,r.h,xe.b,lt.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"],forceWhiteBackground:[2,"forceWhiteBackground"]},null)],(function(e,t){var n=t.component;e(t,1,0,t.parent.context.$implicit,t.parent.context.index>=n.reducedTilesCount,n.fullBleedTheming)}),null)}function Lt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tile",[],null,null,null,yt,ht)),r.yb(1,770048,null,0,ft,[pt,K.a,B.a,H.a,T.a,ut.a,ct.a,Ne.a,r.h,xe.b,lt.a],{workload:[0,"workload"],inExpandedView:[1,"inExpandedView"]},null)],(function(e,t){e(t,1,0,t.parent.context.$implicit,!1)}),null)}function Ut(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,4,"div",[["class","tiles__content"]],null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,xt)),r.yb(2,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Lt)),r.yb(4,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,!n.isConsumer),e(t,4,0,n.isConsumer)}),null)}function Nt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.zb(1,0,null,null,7,"cdk-virtual-scroll-viewport",[["class","virtual-scroll-tiles cdk-virtual-scroll-viewport"],["itemSize","100"],["maxBufferPx","100"],["minBufferPx","50"],["orientation","horizontal"]],[[2,"cdk-virtual-scroll-orientation-horizontal",null],[2,"cdk-virtual-scroll-orientation-vertical",null]],null,null,St.b,St.a)),r.Tb(6144,null,wt.b,null,[wt.d]),r.yb(3,540672,null,0,wt.a,[],{itemSize:[0,"itemSize"],minBufferPx:[1,"minBufferPx"],maxBufferPx:[2,"maxBufferPx"]},null),r.Tb(1024,null,wt.h,wt.j,[wt.a]),r.yb(5,245760,null,0,wt.d,[r.l,r.h,r.z,[2,wt.h],[2,Ct.b],wt.f,[2,wt.i]],{orientation:[0,"orientation"]},null),(e()(),r.ib(16777216,null,0,2,null,Ut)),r.yb(7,409600,null,0,wt.c,[r.O,r.L,r.s,[1,wt.d],r.z],{cdkVirtualForOf:[0,"cdkVirtualForOf"],cdkVirtualForTrackBy:[1,"cdkVirtualForTrackBy"]},null),r.Qb(0,Je.r,[])],(function(e,t){var n=t.component;e(t,3,0,"100","50","100"),e(t,5,0,"horizontal"),e(t,7,0,r.Zb(t,7,0,r.Ob(t,8).transform(n.workloads,0,n.getDisplayedAppTilesCount())),n.trackByWorkloadId)}),(function(e,t){e(t,1,0,"horizontal"===r.Ob(t,5).orientation,"horizontal"!==r.Ob(t,5).orientation)}))}function jt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,12,"div",[["class","explore-apps--fluent"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"explore-apps--backplate":0}),(e()(),r.zb(3,0,[[1,0],["appGalleryLink",1]],null,9,"a",[["class","explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["href","#"],["id","explore-your-apps"]],[[1,"aria-label",0],[1,"data-area",0],[1,"data-nav",0]],[[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],(function(e,t,n){var i=!0,o=e.component;return"mouseenter"===t&&(i=!1!==r.Ob(e,7).onMouseEnter()&&i),"mouseleave"===t&&(i=!1!==r.Ob(e,7).onMouseLeave()&&i),"click"===t&&(i=!1!==o.navigateToAppsPage(n)&&i),i}),null,null)),r.yb(4,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(5,{"explore-apps__text--backplate":0}),r.yb(6,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.yb(7,16384,null,0,it.a,[rt.a],{preloadPath:[0,"preloadPath"]},null),(e()(),r.zb(8,0,null,null,4,"div",[["class","centered-flex-container"]],null,null,null,null,null)),(e()(),r.zb(9,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.Yb(10,null,["",""])),(e()(),r.zb(11,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,et.b,et.a)),r.yb(12,638976,null,0,tt.a,[K.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedBackplateEnabled);e(t,1,0,"explore-apps--fluent",i);var r=e(t,5,0,n.fullBleedBackplateEnabled);e(t,4,0,"explore-apps__text--fluent ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a",r),e(t,6,0,n.fullBleedBackplateStyle),e(t,7,0,n.appGalleryRoute),e(t,12,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,3,0,n.exploreYourAppsAriaLabel,n.componentArea,!0),e(t,10,0,n.exploreYourAppsText)}))}function Wt(e){return r.bc(0,[r.Ub(671088640,1,{appGalleryLink:1}),(e()(),r.zb(1,0,null,null,9,"div",[["class","app-tiles-list-component"],["role","navigation"]],[[1,"aria-label",0],[24,"@fadeOut",0]],null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,Mt)),r.yb(3,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(4,0,null,null,6,"div",[["class","tiles-section__container mobile-tiles-section__container"]],null,null,null,null,null)),(e()(),r.zb(5,0,null,null,3,"div",[["class","mobile-tiles--outer"]],null,null,null,null,null)),(e()(),r.zb(6,0,null,null,2,"div",[["class","fluent-tiles mobile-tiles--inner"]],null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,Nt)),r.yb(8,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,jt)),r.yb(10,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.showProvisioningAlert),e(t,8,0,n.workloads),e(t,10,0,n.showAppGalleryLink&&!n.bottomTrayEnabled)}),(function(e,t){e(t,1,0,t.component.appTilesLandmarkAriaLabel,void 0)}))}r.vb("ohp-app-tiles-list",Dt,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Wt,Rt)),r.yb(1,4440064,null,0,Dt,[Tt.a,pt,K.a,Ue.a,Et.a,T.a,k.b,q.a,p.b,ut.a,_t.a,Ot.a,kt.a,Ft.a,At.a,r.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{fullBleedTheming:"fullBleedTheming",fullBleedFontColor:"fullBleedFontColor",fullBleedBackplateEnabled:"fullBleedBackplateEnabled",fullBleedBackplateStyle:"fullBleedBackplateStyle"},{},[]);var Bt=function(){return function(){}}(),zt=r.xb({encapsulation:2,styles:[],data:{}});function Vt(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,3,"div",[["class","tiles-section section--fluent consumer-tiles-section"]],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,2,"div",[["class","width-restrictor width-restrictor--responsive"]],null,null,null,null,null)),(e()(),r.zb(2,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Wt,Rt)),r.yb(3,4440064,null,0,Dt,[Tt.a,pt,K.a,Ue.a,Et.a,T.a,k.b,q.a,p.b,ut.a,_t.a,Ot.a,kt.a,Ft.a,At.a,r.h],null,null)],(function(e,t){e(t,3,0)}),null)}r.vb("ohp-app-tiles-section",Bt,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tiles-section",[],null,null,null,Vt,zt)),r.yb(1,49152,null,0,Bt,[],null,null)],null,null)}),{},{},[]);var Ht=n("7IJ8"),qt=n("QhWD"),Gt=n("RsrG"),Qt=n("g/dT"),Zt=n("QtYd"),Kt=n("OOtI"),Xt=n("QOOv"),Jt=n("7Rc8"),Yt=n("dOgD"),$t=n("RJiy"),en=n("mNaV"),tn=n("f0qX"),nn=n("W3xQ"),rn=n("vcPZ"),on=n("CVeG"),an=n("gktR"),sn=n("sH0/"),cn=function(){function e(e,t,n,i,r,s,c,l,u,d,f,h,m,b,g,v,y,S,w,C,I){var T=this;this.capabilitiesService=e,this.consumerInstallConfigService=t,this.contextService=n,this.documentService=i,this.eventService=r,this.featureCalloutService=s,this.firstRunConfigService=c,this.firstRunDataService=l,this.globalErrorHandler=u,this.instrumentationService=d,this.locService=f,this.performanceService=h,this.shellShimService=m,this.startupConfigService=b,this.themingService=g,this.userConsentService=v,this.userContextService=y,this.userProfileService=S,this.windowService=w,this.initialized=!1,this.disabled=!C.isDesktopDevice()||!I.config||I.config.hideInTestMode,this.disabled||(this.config=I.config,this.isCommercialUser=this.startupConfigService.config.authType===p.a.OrgId,this.isTrialEligible=!1,this.leftNavShowing=this.capabilitiesService.capabilities.leftNavReact,this.paidConsumerModalShown=!1,this.theme="light",this.installButtonResponsePromise=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"installButtonResponse"===e.name})),Object(a.a)(1)).toPromise().then((function(e){if(e.args&&e.args.length)return Promise.resolve(e.args[0])})),this.consumerSubscriptionStatusPromise=this.consumerInstallConfigService.getConfig().then((function(e){return e&&e.currentSkuInfo&&e.currentSkuInfo.skuType})),this.startupConfigService.config.authType===p.a.MSA&&this.consumerSubscriptionStatusPromise.then((function(e){T.paidConsumerModalShown=!(e===Pt.b.NotSubscribed||e===Pt.b.NonActive||e===Pt.b.NotDetected)})),this.userConsentPromise=this.isCommercialUser?Promise.resolve(null):this.userConsentService.getConfig(),this.modalFreClosedPromise=this.firstRunConfigService.getConfig().then((function(e){var t;return T.isTrialEligible=!!(null===(t=null==e?void 0:e.model)||void 0===t?void 0:t.isTrialEligible),T.showModalFre=!!e&&!!e.model&&!!e.model.slides,T.showModalFre?r.events.withScope(0).pipe(Object(o.a)((function(e){return"firstRunModalClosed"===e.name})),Object(a.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve()})),this.appBarShowingPromise=this.capabilitiesService.capabilities.appBarEnabled?this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"appBarReady"===e.name})),Object(a.a)(1)).toPromise().then((function(){return Promise.resolve()})):Promise.resolve())}return e.prototype.ngOnDestroy=function(){var e;null===(e=this.themeShadesSubscription)||void 0===e||e.unsubscribe()},e.prototype.initializeFirstRun=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.disabled||this.initialized?[2]:(this.initialized=!0,this.capabilitiesService.capabilities.darkModeEnabled&&(this.themeShadesSubscription=this.themingService.darkModeSubscription.subscribe((function(e){n.theme=e?"dark":"light"}))),this.firstRunVersion=this.config.version,[4,this.fetchFirstRun()]);case 1:return e=i.sent(),[4,this.getCallouts(e.CompletedFirstRun)];case 2:return(t=i.sent()).length&&(this.initCalloutActions(t),this.setupFirstCallout(e,t),this.featureCalloutService.addCallouts(t)),this.performanceService.mark("FRE_Ready"),[2]}}))}))},e.prototype.fetchFirstRun=function(){return this.firstRunDataService.fetchFirstRunData(this.firstRunVersion,!1,an.a.firstRunDataKey)},e.prototype.getCallouts=function(e){var t=this.config.tuiFlowInTestMode,n=this.capabilitiesService.capabilities.freNewCalloutsEnabled;return"0"===t?e?this.getReturningUserCallouts():n?this.getFirstRunCalloutsV2():this.getFirstRunCalloutsV1():"1"===t?this.getFirstRunCalloutsV1():"2"===t?this.getFirstRunCalloutsV2():"3"===t?this.getReturningUserCallouts():void 0},e.prototype.getFirstRunCalloutsV2=function(){var e=this,t=this.userContextService.user.isEdu;return new Promise((function(n,r){Promise.all([e.shellShimService.afterShellPlusLoaded,e.modalFreClosedPromise,e.consumerSubscriptionStatusPromise,e.userConsentPromise,e.installButtonResponsePromise,e.appBarShowingPromise]).then((function(r){var o=Object(i.__read)(r,4),a=o[0],s=o[2],c=o[3],l=new Array,u=a,d=e.isFreeConsumer(s),p=e.userCanViewUpsell(d,c);e.detectDomElements(),u&&e.appLauncherElement&&l.push(new rn.a(e.appLauncherElement,"AppLauncher",T.b.FirstRun,e.locService.FirstRunFindMoreAppsTitle,e.isCommercialUser?e.locService.FirstRunFindMoreAppsSubtitleCommercial:e.locService.FirstRunFindMoreAppsSubtitleConsumer,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.isCommercialUser?t?e.config.findMoreAppsEduSvg:e.config.findMoreAppsCommercialSvg:e.config.findMoreAppsConsumerSvg)),e.adminCenterButtonElement&&e.userContextService.user.isAdmin&&l.push(new rn.a(e.adminCenterButtonElement,"AdminTile",T.b.FirstRun,t?e.locService.FirstRunManageSchoolTitle:e.locService.FirstRunManageOrganizationTitle,e.locService.FirstRunManageOrganizationSubtitleNext,null,null,null,null,null,!0,null,null,null,null,-240,null,240,e.config.adminCenterSvg[e.theme])),e.createNewButtonElement&&l.push(new rn.a(e.createNewButtonElement,"NewButton",T.b.FirstRun,e.locService.FirstRunCreateHereTitle,e.locService.FirstRunCreateHereSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.createSvg[e.theme])),e.myContentButtonElement&&e.isCommercialUser&&l.push(new rn.a(e.myContentButtonElement,"MyContent",T.b.FirstRun,e.locService.FirstRunManageContentTitle,e.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.manageContentSvg)),e.uploadButtonElement&&l.push(new rn.a(e.uploadButtonElement,"Upload",T.b.FirstRun,e.locService.FirstRunUploadExistingContentTitle,e.locService.FirstRunUploadExistingContentSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.uploadContentSvg)),e.consumerBuyButtonElement&&p&&l.push(new rn.a(e.consumerBuyButtonElement,"BuyOffice",T.b.FirstRun,e.locService.FirstRunUpgradeAnyTimeTitle,e.capabilitiesService.capabilities.buyMicrosoft365Enabled?e.locService.FirstRunUpgradeAnyTimeSubtitleTemp:e.locService.FirstRunUpgradeAnyTimeSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.upgradeSvg)),e.installButtonElement&&!d&&e.config.installButtonCalloutEnabled&&l.push(new rn.a(e.installButtonElement,"Install",T.b.FirstRun,e.locService.FirstRunDownloadAppsTitle,e.locService.FirstRunDownloadAppsSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.officeMobileAppSvg)),e.feedbackContainerElement&&l.push(new rn.a(e.feedbackContainerElement,"Feedback",T.b.FirstRun,e.locService.FirstRunYoureAllSetTitle,e.locService.FirstRunYoureAllSetSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.allSetSvg,!0)),e.userProfileService.incrementMetric("Fre_New_Callouts_Impression");var f={};f.FirstRunTotalSteps=l.length.toString(),f.State="first-run",e.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",f),Object(j.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:f}),n(l)})).catch((function(t){e.globalErrorHandler.handleError(t,"LAtlv"),r()}))}))},e.prototype.getFirstRunCalloutsV1=function(){var t=this;return new Promise((function(n,r){Promise.all([t.shellShimService.afterShellPlusLoaded,t.installButtonResponsePromise,t.modalFreClosedPromise,t.consumerSubscriptionStatusPromise,t.userConsentPromise]).then((function(r){var o=Object(i.__read)(r,5),a=o[0],s=o[1],c=o[3],l=o[4],u=new Array,d=t.capabilitiesService.capabilities.eduPageTourFreEnabled&&t.userContextService.user.isEdu;if(t.capabilitiesService.capabilities.pwaCommercialNonEduFreEnabled&&t.capabilitiesService.capabilities.pwaEnabled){var p=t.documentService.nativeDocument.querySelector(".fast-hero-search");p&&u.push(new rn.a(p,"SearchBar",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunCommercialNonEduSearchBoxMessagePwa),"")),(m=t.documentService.nativeDocument.getElementById("create-menu-dropdown-link"))&&u.push(new rn.a(m,"NewButton",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunCommercialNonEduCreateNewMessagePwa),""));var f=t.documentService.nativeDocument.querySelector(".list-header__title--carousel");f&&u.push(new rn.a(f,"Recommended",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunCommercialNonEduRecommendedMessagePwa),""));var h=t.documentService.nativeDocument.getElementById("tab-list-header-link-shared-mru");return h&&u.push(new rn.a(h,"SharedTab",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunCommercialNonEduSharedWithMeMessagePwa),"")),void n(u)}if(t.capabilitiesService.capabilities.pwaFreeConsumerFreEnabled&&t.capabilitiesService.capabilities.pwaEnabled&&(c===Pt.b.NonActive||c===Pt.b.NotSubscribed)){var m;(m=t.documentService.nativeDocument.getElementById("create-menu-dropdown-link"))&&u.push(new rn.a(m,"NewButton",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunConsumerCreateNewCalloutPwa),"")),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new rn.a(I,"OneDriveTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunConsumerOneDriveCalloutPwa),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing));var b=t.documentService.nativeDocument.getElementById("consumer-buy-button"),g=t.capabilitiesService.capabilities.altaBrandingChangesEnabled&&t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutMessage:"",v=t.capabilitiesService.capabilities.altaBrandingChangesEnabled&&t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutLegalText:"";!b||l&&0!==l.userConsent||u.push(new rn.a(b,"BuyOffice",T.b.FirstRun,on.a.stripTags(t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.isTrialEligible?t.locService.FirstRunConsumerTryMicrosoft365CalloutTitle:t.locService.FirstRunConsumerBuyOfficeCalloutPwaAlta:t.locService.FirstRunConsumerBuyOfficeCalloutPwa),on.a.stripTags(g),["generic-button--fluent--secondary","ms-bgc-w","ms-fcl-tp","box-shadow--major"],["generic-button--fluent--primary","ms-bgc-tp","ms-fcl-w"],null,!1,!1,!1,"",!1,null,null,null,on.a.stripTags(v)))}if(t.userContextService.user.isEdu){if(t.userContextService.user.isEduFaculty){if(d)return(w=t.documentService.nativeDocument.getElementById("ShellSkypeTeams_link"))&&t.isElementInViewport(w)&&u.push(new rn.a(w,"TeamsTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunEduFacultyPageTourV2TeamsCallout),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u);var y=t.documentService.nativeDocument.getElementById("ShellOfficeForms_link");y&&t.isElementInViewport(y)&&u.push(new rn.a(y,"FormsTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunFacultyFormsMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing));var S=t.documentService.nativeDocument.getElementById("ShellOneNoteOnline_link");return S&&t.isElementInViewport(S)&&u.push(new rn.a(S,"OneNoteTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunFacultyOneNoteMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new rn.a(I,"OneDriveTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunEduOneDriveMessageUpdated),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u)}var w;if(t.userContextService.user.isEduStudent&&d)return(w=t.documentService.nativeDocument.getElementById("ShellSkypeTeams_link"))&&t.isElementInViewport(w)&&u.push(new rn.a(w,"TeamsTile",T.b.FirstRun,on.a.stripTags(t.locService.FirstRunEduStudentPageTourV2TeamsCallout),"",["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),void n(u)}if((t.isCommercialUser||t.paidConsumerModalShown)&&s&&s.length){var C=t.documentService.nativeDocument.querySelector(".install-button");if(C&&!t.capabilitiesService.capabilities.pwaEnabled&&t.config.installButtonCalloutEnabled&&u.push(new rn.a(C,"Install",T.b.FirstRun,s,t.paidConsumerModalShown?t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.locService.PageTourGetOfficeMessageAlta:t.locService.PageTourGetOfficeMessage:t.locService.FirstRunInstallSubtitle,["generic-button--fluent--primary","ms-bgc-tp","ms-fcl-w","box-shadow--major"],["generic-button--fluent--secondary","ms-bgc-w","ms-fcl-tp"])),t.paidConsumerModalShown&&!t.capabilitiesService.capabilities.pwaEnabled&&((I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new rn.a(I,"OneDriveTile",T.b.FirstRun,t.locService.PageTourNewDocumentTitle,t.locService.PageTourNewDocumentMessage,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(k=t.documentService.nativeDocument.querySelector(".my-account__link"))&&u.push(new rn.a(k,"MyAccount",T.b.FirstRun,t.locService.PageTourMyAccountTitle,t.locService.PageTourMyAccountMessage,["my-account__link--hover-style"]))),t.paidConsumerModalShown&&t.capabilitiesService.capabilities.pwaEnabled){var I,k,_=t.documentService.nativeDocument.getElementById("ShellWordOnline_link");_&&t.isElementInViewport(_)&&u.push(new rn.a(_,"WordTile",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout1Title,t.locService.FirstRunPaidConsumerCallout1Subtitle,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(I=t.documentService.nativeDocument.getElementById("ShellDocuments_link"))&&t.isElementInViewport(I)&&u.push(new rn.a(I,"OneDriveTile",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout2Title,t.locService.FirstRunPaidConsumerCallout2Subtitle,["workload-item--fluent--hover-style","ms-bgc-w"],null,null,null,null,t.leftNavShowing)),(k=t.documentService.nativeDocument.querySelector(".my-account__link"))&&u.push(new rn.a(k,"MyAccount",T.b.FirstRun,t.locService.FirstRunPaidConsumerCallout3Title,t.locService.FirstRunPaidConsumerCallout3Subtitle,["my-account__link--hover-style"]))}if(t.showModalFre||t.paidConsumerModalShown)return void n(u)}var A=a,P=t.windowService.innerWidth,E=t.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu");if(A&&E&&P>e.minWidthForCalloutShell&&u.push(new rn.a(E,"AppLauncher",T.b.FirstRun,t.locService.FirstRunAppLauncherTitle,t.capabilitiesService.capabilities.altaBrandingChangesEnabled?t.locService.FirstRunAppLauncherAltaSubtitle:t.locService.FirstRunAppLauncherSubtitle)),t.userContextService.user.isAdmin){var O=t.documentService.nativeDocument.getElementById("ShellAdmin_link");O&&t.isElementInViewport(O)&&u.push(new rn.a(O,"AdminTile",T.b.FirstRun,t.locService.FirstRunAdminTitle,t.locService.FirstRunAdminSubtitle,null,null,null,null,null,t.leftNavShowing))}n(u)})).catch((function(e){t.globalErrorHandler.handleError(e,"k1Drr"),r()}))}))},e.prototype.getReturningUserCallouts=function(){var e=this,t=this.userProfileService.doesMetricExist("Fre_New_Callouts_Impression");return new Promise((function(n,r){Promise.all([e.shellShimService.afterShellPlusLoaded,e.modalFreClosedPromise,e.consumerSubscriptionStatusPromise,e.userConsentPromise,t,e.appBarShowingPromise]).then((function(t){var r=Object(i.__read)(t,5),o=r[0],a=r[2],s=r[3],c=r[4];e.detectDomElements();var l=new Array,u=o,d=e.isFreeConsumer(a),p=e.userCanViewUpsell(d,s);if(e.capabilitiesService.capabilities.freNewCalloutsEnabled&&(!c||e.contextService.sharedContext.inMockMode)){l.push(Promise.resolve(new rn.a(e.appLauncherElement,"Welcome",e.contextService.isEdgeworth?T.b.Edgeworth:T.b.Documents,e.locService.FirstRunWelcomeBackTitle,e.locService.FirstRunWelcomeBackSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.welcomeBackSvg,!1,!0,"Returning_User_Callouts_Impression"))),u&&e.appLauncherElement&&(l.push(Promise.resolve(new rn.a(e.appLauncherElement,"AppLauncher",T.b.FirstRun,e.locService.FirstRunFindMoreAppsTitle,e.locService.FirstRunFindMoreAppsSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.isCommercialUser?e.userContextService.user.isEdu?e.config.findMoreAppsEduSvg:e.config.findMoreAppsCommercialSvg:e.config.findMoreAppsConsumerSvg,!1,!1,"Returning_User_Callouts_Impression"))),e.createNewButtonElement&&l.push(Promise.resolve(new rn.a(e.createNewButtonElement,"NewButton",T.b.FirstRun,e.locService.ExpandedCreateCapabilitiesTitle,e.locService.FirstRunExpandedCreateCapabilitiesSubittle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.createSvg[e.theme],!1,!1,"Returning_User_Callouts_Impression"))),e.myContentButtonElement&&e.isCommercialUser&&l.push(Promise.resolve(new rn.a(e.myContentButtonElement,"MyContent",T.b.FirstRun,e.locService.FirstRunManageContentTitle,e.locService.FirstRunManageContentSubtitle,null,null,null,null,null,!0,null,null,null,null,null,null,null,e.config.manageContentSvg,!1,!1,"Returning_User_Callouts_Impression"))),e.consumerBuyButtonElement&&p&&l.push(Promise.resolve(new rn.a(e.consumerBuyButtonElement,"BuyOffice",T.b.FirstRun,e.locService.FirstRunUpgradeAnyTimeTitle,e.capabilitiesService.capabilities.buyMicrosoft365Enabled?e.locService.FirstRunUpgradeAnyTimeSubtitleTemp:e.locService.FirstRunUpgradeAnyTimeSubtitle,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.upgradeSvg,!1,!1,"Returning_User_Callouts_Impression"))),e.feedbackContainerElement&&l.push(Promise.resolve(new rn.a(e.feedbackContainerElement,"Feedback",T.b.FirstRun,e.locService.FirstRunYoureAllSetTitle,e.locService.FirstRunYoureAllSetSubtitleReturningUser,null,null,null,null,null,!1,null,null,null,null,null,null,null,e.config.allSetSvg,!0,!1,"Returning_User_Callouts_Impression"))));var f={};f.FirstRunTotalSteps=l.length.toString(),f.State="after-first-run",e.instrumentationService.logGenericEvent("Fre_New_Callouts_Event",f),Object(j.a)({featureName:"FirstRun",eventName:"Fre_New_Callouts_Event",params:f}),e.userProfileService.incrementMetric("Fre_New_Callouts_Impression")}Promise.all(l).then((function(e){return n(e.filter((function(e){return null!==e})))}))})).catch((function(t){e.globalErrorHandler.handleError(t,"Cgjwv"),r()}))}))},e.prototype.isFreeConsumer=function(e){return!this.isCommercialUser&&(e===Pt.b.NonActive||e===Pt.b.NotSubscribed)},e.prototype.userCanViewUpsell=function(e,t){return e&&(!t||0===t.userConsent)},e.prototype.isElementInViewport=function(e){var t=e.getBoundingClientRect();return t.top+t.height<this.windowService.nativeWindow.innerHeight},e.prototype.initCalloutActions=function(e){var t=this,n=e.length,i=function(i){var r=e[i];r&&t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:i+1,Version:t.firstRunVersion,TotalSteps:n},an.a.firstRunDataKey,r.calloutType)};e.forEach((function(e,r){e.buttonIdPrefix="first-run-step-"+r+"-"+e.calloutType.toLowerCase(),e.onAction=r===n-1?function(e){0!==e&&(3===e?i(r-1):t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:n,Version:t.firstRunVersion,TotalSteps:n},an.a.firstRunDataKey))}:function(e){0!==e&&(1===e?t.firstRunDataService.updateFirstRunData({CompletedFirstRun:!0,StepsCompleted:r+1,Version:t.firstRunVersion,TotalSteps:n},an.a.firstRunDataKey):i(2===e?r+1:r-1))}}))},e.prototype.setupFirstCallout=function(e,t){for(var n=e.Version!==this.firstRunVersion?0:void 0!==e.FurthestCompleted&&e.FurthestCompleted<t.length?e.FurthestCompleted:e.StepsCompleted<t.length?e.StepsCompleted:0,i=0;i<n;i++)t[i].completed=!0;this.firstRunDataService.updateFirstRunData({CompletedFirstRun:!1,StepsCompleted:n+1,Version:this.firstRunVersion,TotalSteps:t.length},an.a.firstRunDataKey,t[n].calloutType)},e.prototype.detectDomElements=function(){this.appLauncherElement=this.documentService.nativeDocument.getElementById("O365_MainLink_NavMenu"),this.adminCenterButtonElement=this.documentService.nativeDocument.getElementById("A28790FE-989B-48F6-90D8-D4996159C8D1")||this.documentService.nativeDocument.getElementById("ShellAdmin_link"),this.createNewButtonElement=this.documentService.nativeDocument.getElementById("83D3F491-B586-4266-8738-89776471BF21")||this.documentService.nativeDocument.getElementById("left-nav-create-center"),this.myContentButtonElement=this.documentService.nativeDocument.getElementById("F57D5D29-4967-495C-A648-F7AB66BF8572"),this.uploadButtonElement=this.documentService.nativeDocument.getElementById("upload-button-Edgeworth")||this.documentService.nativeDocument.getElementById("upload-button-QuickAccess")||this.documentService.nativeDocument.getElementById("upload-button"),this.installButtonElement=this.documentService.nativeDocument.getElementById("install-dropdown-link")||this.documentService.nativeDocument.getElementById("installbutton-MSA-RedirectToMyAccountPage"),this.consumerBuyButtonElement=this.documentService.nativeDocument.getElementById("consumer-buy-button"),this.feedbackContainerElement=this.documentService.nativeDocument.getElementById("feedbackContainer")},e.minWidthForCalloutShell=1024,e.ɵprov=r.cc({factory:function(){return new e(r.dc(K.a),r.dc(Ue.a),r.dc(B.a),r.dc(l.a),r.dc(H.a),r.dc(Ce.a),r.dc(Ie.a),r.dc(an.a),r.dc(c.b),r.dc(T.a),r.dc(Ne.a),r.dc(k.b),r.dc(Me.a),r.dc(p.b),r.dc(xe.b),r.dc(We.a),r.dc(Be.a),r.dc(L.b),r.dc(d.b),r.dc(pe.b),r.dc(sn.a))},token:e,providedIn:"root"}),e}(),ln=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d){this.calendarConfigService=e,this.capabilitiesService=t,this.consumerInstallConfigService=n,this.eventService=i,this.firstRunConfigService=r,this.firstRunCalloutsService=o,this.instrumentationService=a,this.locService=s,this.mruConfigService=c,this.userContextService=l,this.workloadsService=u,this.clientStartupConfigService=d,this.coreWorkloadIds=["ShellWordOnline","ShellExcelOnline","ShellPowerPointOnline","ShellMail"]}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=this.clientStartupConfigService.config.authType===p.a.MSA;this.showSuggestedActions=t.suggestedActionsEnabled,this.showTilesSection=!t.appsInHero&&!t.leftNavReact,this.showCalendar=!t.edgeworthEnabled&&t.calendarEnabled&&!!this.calendarConfigService.config,this.bottomTrayEnabled=t.bottomTrayEnabled,this.showPlaces=this.clientStartupConfigService.config.authType===p.a.OrgId&&!t.edgeworthEnabled,this.leftNavEmptyImage=t.leftNavEmptyImage,this.leftNavEmptyStateString=this.locService.LeftNavNonWXPEmptyStateString,this.leftNavEmptyStateSubtitle=this.locService.LeftNavNonWXPEmptyStateSubtitleString,Promise.all([this.firstRunConfigService.getConfig(),this.consumerInstallConfigService.getConfig()]).then((function(r){var o=Object(i.__read)(r,2),a=o[0],s=o[1],c=s&&s.currentSkuInfo?s.currentSkuInfo.skuType:Pt.b.NotDetected;if((!a||!a.model||t.modalFreCalloutEnabled||!(c===Pt.b.NonActive||c===Pt.b.NotSubscribed||c===Pt.b.NotDetected)||e.userContextService.user.isEduFaculty||t.eduPageTourFreEnabled&&e.userContextService.user.isEdu)&&!e.userContextService.user.hasNoLicense&&e.firstRunCalloutsService.initializeFirstRun(),n){var l={};l.SkuType=Pt.b[c],e.instrumentationService.logGenericEvent("ConsumerSkuLoaded",l),Object(j.a)({featureName:"Upsell",eventName:"ConsumerSkuLoaded",area:"Other",params:{SkuType:Pt.b[c]}})}}));var r,s=Promise.resolve(!1),c=this.mruConfigService.config;c.recommendedEnabled&&(s=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"recommendedDataReady"===e.name})),Object(tn.a)((function(e){return e.args[0]>0})),Object(a.a)(1)).toPromise()),r=c.showZeroExperience?Promise.resolve(!0):this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"mruDataReady"===e.name})),Object(tn.a)((function(e){return e.args[0]>0})),Object(a.a)(1)).toPromise();var l=Promise.resolve(!1);this.showCalendar&&(l=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"calendarDataReady"===e.name})),Object(tn.a)((function(e){return e.args[0]>0})),Object(a.a)(1)).toPromise());var u=Promise.resolve(!1);u=this.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"announcementsReady"===e.name})),Object(tn.a)((function(e){return e.args[0]>0})),Object(a.a)(1)).toPromise();var d=this.workloadsService.getWorkloads().then((function(t){return t.filter((function(t){return e.coreWorkloadIds.indexOf(t.Id)>=0})).length>0}));Promise.all([s,r,d,l,u]).then((function(t){var n=Object(i.__read)(t,5);n[0]||n[1]||n[2]||n[3]||n[4]||(e.showEmptyNavState=!0)}))},e}(),un=r.xb({encapsulation:2,styles:[],data:{}});function dn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tiles-section",[],null,null,null,Vt,zt)),r.yb(1,49152,null,0,Bt,[],null,null)],null,null)}function pn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,4,"div",[["class","left-nav-empty-content-state__container"]],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,0,"img",[["class","left-nav-empty-content-state__image"]],[[8,"src",4]],null,null,null,null)),(e()(),r.zb(2,0,null,null,1,"div",[["class","left-nav-empty-content-state__text"]],null,null,null,null,null)),(e()(),r.Yb(3,null,["",""])),(e()(),r.zb(4,0,null,null,0,"div",[["class","left-nav-empty-content-state__subtitle ms-fcl-tp"]],[[8,"innerHTML",1]],null,null,null,null))],null,(function(e,t){var n=t.component;e(t,1,0,n.leftNavEmptyImage),e(t,3,0,n.leftNavEmptyStateString),e(t,4,0,n.leftNavEmptyStateSubtitle)}))}function fn(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"places#PlacesModule")}),null)}function hn(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"calendar#CalendarModule")}),null)}function mn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,12,"div",[["ohpInstrumentPageView","Home_PageView"]],null,null,null,null,null)),r.yb(1,81920,null,0,Qt.a,[pe.b,T.a],{pageName:[0,"pageName"]},null),(e()(),r.ib(16777216,null,null,1,null,dn)),r.yb(3,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(4,0,null,null,8,"div",[["role","main"]],null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,pn)),r.yb(6,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(7,0,null,null,1,"ohp-documents-component",[],null,null,null,Zt.b,Zt.a)),r.yb(8,245760,null,0,Kt.a,[K.a,H.a,Xt.a,Ne.a,Jt.a,Yt.a,kt.a,$t.a,Ft.a,Qe.a,p.b,p.b,en.a,B.a],{firstSection:[0,"firstSection"],headless:[1,"headless"],isSuggestedActions:[2,"isSuggestedActions"]},null),(e()(),r.ib(16777216,null,null,1,null,fn)),r.yb(10,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,hn)),r.yb(12,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,"Home_PageView"),e(t,3,0,n.showTilesSection),e(t,6,0,n.showEmptyNavState),e(t,8,0,!n.showTilesSection&&!n.bottomTrayEnabled,!0,n.showSuggestedActions),e(t,10,0,n.showPlaces),e(t,12,0,n.showCalendar)}),null)}var bn=r.vb("ohp-home",ln,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-home",[],null,null,null,mn,un)),r.yb(1,114688,null,0,ln,[nn.a,K.a,Ue.a,H.a,Ie.a,cn,T.a,Ne.a,Xt.a,Be.a,ut.a,p.b],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),gn=n("VrZ9"),vn=n("MRNN"),yn=n("rPZ4"),Sn=n("Zy3K"),wn=n("WJRI"),Cn=n("kVgv"),In=n("ICP0"),Tn=n("Q6ee"),kn=n("y3b+"),_n=n("iX+N"),An=n("PTf4"),Pn=n("AlWG"),En=n("pd4Y"),On=function(){function e(t,n,i){this.dateService=t,this.locService=n,this.userContextService=i,this.currentGreetingText=this.generateGreeting(),this.greetingSubject=new Pn.a(this.currentGreeting),this.setupTimer(e.MorningStartHour),this.setupTimer(e.AfternoonStartHour),this.setupTimer(e.EveningStartHour)}return Object.defineProperty(e.prototype,"greetingObservable",{get:function(){return this.greetingSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentGreeting",{get:function(){return this.currentGreetingText},enumerable:!0,configurable:!0}),e.prototype.setupTimer=function(e){var t=this,n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),e,0,0,0);i<n&&i.setUTCDate(i.getUTCDate()+1);var r=i.getTime()-n.getTime();setTimeout((function(){t.updateGreeting(),t.setupTimer(e)}),r)},e.prototype.updateGreeting=function(){var e=this.generateGreeting();e!==this.currentGreetingText&&(this.currentGreetingText=e,this.greetingSubject.next(this.currentGreetingText))},e.prototype.generateGreeting=function(){var t,n=this.userContextService.user.displayName,i=this.dateService.getCurrentDate().getHours();return t=i>=e.MorningStartHour&&i<e.AfternoonStartHour?n?this.locService.WelcomeMorningWithName:this.locService.WelcomeMorningNoName:i>=e.AfternoonStartHour&&i<e.EveningStartHour?n?this.locService.WelcomeAfternoonWithName:this.locService.WelcomeAfternoonNoName:n?this.locService.WelcomeEveningWithName:this.locService.WelcomeEveningNoName,n&&(t=this.locService.format(t,n)),t},e.MorningStartHour=4,e.AfternoonStartHour=12,e.EveningStartHour=18,e.ɵprov=r.cc({factory:function(){return new e(r.dc(En.a),r.dc(Ne.a),r.dc(Be.a))},token:e,providedIn:"root"}),e}(),Fn=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d,p,f,h,m,b,g){this.activatedRoute=e,this.appGalleryConfigService=t,this.appTilesConfigService=n,this.capabilitiesService=i,this.consumerInstallConfigService=r,this.contextService=o,this.deviceDetector=a,this.eventService=s,this.installConfigService=c,this.locService=l,this.officeRouteService=u,this.searchConfigService=d,this.themingService=p,this.welcomeContentService=f,this.windowService=h,this.workloadsService=m,this.startupConfigService=b,this.wacStartConfigService=g,this.backgroundStyle={},this.bleedBackgroundStyle={},this.heroImageStyle={},this.heroLeftImageStyle={},this.heroRightImageStyle={},this.heroTitleGradient={},this.fullBleedBackplateStyle={},this.isSearchSiteScoped=!1}return e.prototype.ngOnInit=function(){var e=this,t=this.capabilitiesService.capabilities,n=!!this.appGalleryConfigService.config,i=t.wacStartPageEnabled;if(this.appsInHero=t.appsInHero,this.bottomTrayEnabled=t.bottomTrayEnabled,this.searchEnabled=t.showSearch&&!!this.searchConfigService.config,this.pwaEnabled=t.pwaEnabled,this.isConsumer=this.startupConfigService.config.authType===p.a.MSA,this.isMobile=this.deviceDetector.isMobileDevice(),this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.showAppTilesHeroTitle=this.appsInHero&&!this.bottomTrayEnabled,this.myAccountLinkText=this.appTilesConfigService.config.resources.MyAccountConsumerLinkText,this.myAccountUrl=this.appTilesConfigService.config.myAccountUrl,this.leftNavReact=t.leftNavReact,this.quickAccessEnabled=t.quickAccessV1Enabled,this.fluentRefresh=t.fluentRefresh,this.appBarEnabled=t.appBarEnabled,this.announcementListenerAdded=!1,this.suggestedActions=t.suggestedActionsEnabled,this.isConsumer?this.consumerInstallConfigService.getConfig().then((function(t){var n=t&&t.currentSkuInfo?t.currentSkuInfo.skuType:Pt.b.NotDetected;e.isPaidConsumer=!(n===Pt.b.NotSubscribed||n===Pt.b.NonActive||n===Pt.b.NotDetected),n!==Pt.b.NotSubscribed&&n!==Pt.b.NonActive||e.installConfigService.config.dimeEnabled&&e.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"convertedToPaid"===e.name})),Object(a.a)(1)).toPromise().then((function(){e.isPaidConsumer=!0}))})):this.isPaidConsumer=!1,this.greetingSubscription=this.welcomeContentService.greetingObservable.subscribe((function(t){e.heroTitle&&(!e.currentRoute||"OfficeHome"===e.currentRoute||"Pwa"===e.currentRoute||"AppGallery"===e.currentRoute&&e.isConsumer)&&(e.heroTitle=t)})),this.searchEnabled||n||i){var r=void 0;r=this.officeRouteService.hasNavigated()?this.officeRouteService.getRouteChangeEndObservable():Object(In.a)(this.officeRouteService.getRouteChangeStartObservable().pipe(Object(a.a)(1)),this.officeRouteService.getRouteChangeEndObservable()),this.routeSubscription=r.subscribe((function(t){e.setHeroFlags(t)})),this.changeTitleSubscription=this.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"changeTitle"===e.name}))).subscribe((function(t){if(t&&t.args&&t.args.length){var n=t.args;e.heroTitle=e.isConsumer&&e.onAppGalleryPage?e.welcomeContentService.currentGreeting:n[0],e.accessibilityTitle=n.length>1?n[1]:e.heroTitle}}))}else this.showApps=this.appsInHero&&!this.leftNavReact,this.showInstall=!0,this.showInstallButton=!0,this.heroTitle=this.welcomeContentService.currentGreeting,this.accessibilityTitle=this.locService.AuthPageTitle;this.fullBleedSubscription=this.themingService.fullBleedTheming.subscribe((function(t){var n=t.bleedColor,i=t.themeData,r=t.bleedFontColor;e.fullBleedThemingEnabled=t.shouldFullBleed,e.fullBleedColor=n,e.fullBleedFontColor=e.fullBleedThemingEnabled?r:"",e.activeThemeId=i.theme.themeId;var o=i.theme.reactShellTheme;e.fullBleedImages=o?o.FullBleedImages:null,e.setResizeSubscription(),e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)}))},e.prototype.ngAfterViewInit=function(){var e=this.contextService.sharedContext;this.appsInHero||(e.heroImageUrl&&(this.backgroundStyle["background-image"]="url("+e.heroImageUrl+")"),this.heroTitleGradient["background-image"]="url("+e.heroTitleGradientImageUrl+")"),this.setResizeSubscription()},e.prototype.ngAfterViewChecked=function(){var e,t,n,i;if(!this.announcementListenerAdded){var r=null===(t=null===(e=this.heroAnnouncement)||void 0===e?void 0:e.nativeElement)||void 0===t?void 0:t.getElementsByClassName("new-stream-announcement"),o=null===(i=null===(n=this.heroAnnouncement)||void 0===n?void 0:n.nativeElement)||void 0===i?void 0:i.getElementsByClassName("classic-stream-announcement");r&&r[0]&&r[0].addEventListener("focus",(function(){r[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),o&&o[0]&&(o[0].addEventListener("focus",(function(){o[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"end"})})),this.announcementListenerAdded=!0)}},e.prototype.ngOnDestroy=function(){this.greetingSubscription&&this.greetingSubscription.unsubscribe(),this.routeSubscription&&this.routeSubscription.unsubscribe(),this.changeTitleSubscription&&this.changeTitleSubscription.unsubscribe(),this.resizeSubscription&&this.resizeSubscription.unsubscribe(),this.fullBleedSubscription&&this.fullBleedSubscription.unsubscribe()},e.prototype.backToSearchPage=function(){this.officeRouteService.back({route:"Search"})},e.prototype.setResizeSubscription=function(){var e=this;this.resizeSubscription||(this.resizeSubscription=this.eventService.events.withScope(1).pipe(Object(o.a)((function(e){return"contentWidthChanged"===e.name||"windowResized"===e.name})),Object(Tn.a)(10)).subscribe((function(t){e.setFullBleedBackground(e.fullBleedThemingEnabled,e.fullBleedImages,e.fullBleedColor,e.windowService.innerWidth)})))},e.prototype.setHeroFlags=function(e){var t=this,n=e.currentRoute;if(this.currentRoute=n?n.route:null,this.onCreatePage="Create"===this.currentRoute,this.onSearchPage="Search"===this.currentRoute||"SearchSiteScoped"===this.currentRoute||"SearchPersonScoped"===this.currentRoute,this.onAppGalleryPage="AppGallery"===this.currentRoute,this.onHomePageOrPwa=!this.currentRoute||"OfficeHome"===this.currentRoute||"Pwa"===this.currentRoute,this.showApps=this.onHomePageOrPwa&&this.appsInHero&&!this.leftNavReact,this.showFASTBreadcrumb="SearchSiteScoped"===this.currentRoute,this.appContext=n?n.app:null,this.hideConsumerBackgroundImage=this.isConsumer&&!this.onHomePageOrPwa,this.announcementMarkup=Object(An.a)(this.locService,this.wacStartConfigService,this.appContext),this.onAppGalleryPage&&this.workloadsService.getWorkloads().then((function(e){t.store=e.find((function(e){return"ShellOfficeStore"===e.Id}))})),this.showInstall=this.onHomePageOrPwa||this.onAppGalleryPage,this.showWelcomeBadge=this.capabilitiesService.capabilities.welcomeBadgeEnabled&&this.onHomePageOrPwa,this.showInstallButton=this.capabilitiesService.capabilities.isPwaInUwp&&this.installConfigService.config.pwaInstallMoveEnabled?this.onAppGalleryPage:this.onHomePageOrPwa||this.onAppGalleryPage,this.showHeroButtons=this.onAppGalleryPage||this.onHomePageOrPwa,this.onSearchPage||!this.activatedRoute.snapshot.queryParams.q||this.isConsumer){var i=this.eventService.whenEventFired("exitSearchInSearchBox",0),r=this.eventService.whenEventFired("isContextualRailEnabled",0);this.backButtonId="back-button",this.backButtonAriaLabel="";var o=Promise.resolve(!1);switch(this.defaultBackRoute=null,this.onTemplatesPage=!1,this.currentRoute){case"Search":case"SearchPersonScoped":this.isConsumer&&(this.accessibilityTitle=this.locService.SearchResults),this.backButtonId="search-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:this.pwaEnabled?"Pwa":"OfficeHome"},this.componentArea=T.b.SearchResults,o=i.then((function(e){return!e.args[0]}));break;case"SearchSiteScoped":this.backButtonId="search-site-scoped-close-button",this.backButtonAriaLabel=this.locService.CloseSearchResultsAriaLabel,this.defaultBackRoute={route:"Search"},o=i.then((function(e){return!e.args[0]}));break;case"AppGallery":this.accessibilityTitle=this.locService.AppGalleryHeroTitle,this.backButtonId="app-gallery-close-button",this.componentArea=T.b.AppGalleryHero;break;case"Templates":o=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:n.app},this.onTemplatesPage=!0,this.componentArea=T.b.Templates;break;case"MyForms":case"GroupForms":o=Promise.resolve(!0),this.defaultBackRoute={route:"Start",app:n.app};break;case"Start":break;default:this.componentArea=T.b.Hero}this.isSearchSiteScoped="SearchSiteScoped"===this.currentRoute,this.setShowBack(o),this.setContextualRail(r.then((function(e){return e.args[0]}))),this.heroTitle=this.onHomePageOrPwa?this.welcomeContentService.currentGreeting:this.accessibilityTitle,this.showCreateLocation=this.onTemplatesPage&&this.appContext!==_e.b.Sway&&this.appContext!==_e.b.Forms,this.noGutter=this.fluentRefresh||this.quickAccessEnabled&&"OfficeHome"===this.currentRoute&&!this.isConsumer}else this.officeRouteService.navigateTo({route:"Search"},!0)},e.prototype.setShowBack=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.showBackButton=n.sent(),this.showAppTilesHeroTitle=!this.bottomTrayEnabled&&(this.showBackButton||this.showFASTBreadcrumb||this.onHomePageOrPwa&&this.appsInHero),[2]}}))}))},e.prototype.setContextualRail=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return t=this,[4,e];case 1:return t.isContextualRailEnabled=n.sent(),[2]}}))}))},e.prototype.setFullBleedBackground=function(e,t,n,i){var r=xe.b.eduThemeBackplateOverrides[this.activeThemeId];this.fullBleedBackplateEnabled=r&&i<640&&this.fullBleedThemingEnabled,this.fullBleedBackplateStyle=this.fullBleedBackplateEnabled?Object.assign({color:this.fullBleedFontColor},r):{color:this.fullBleedFontColor},this.bleedBackgroundStyle=e?{"background-color":n}:{};var o=e&&t?t.Type:null;this.isPatternImage=o===xe.a.Pattern,this.hasSideImages=o===xe.a.Side,this.heroLeftImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroRightImageStyle=this.getBackgroundImageStyle(this.hasSideImages&&t?t.Side:null),this.heroImageStyle=this.getBackgroundImageStyle(e&&t?this.themingService.getEduHeaderImageForWidth(t,i):null)},e.prototype.getBackgroundImageStyle=function(e){return e&&e.length?{"background-image":"url("+e+")"}:{}},e}(),Dn=r.xb({encapsulation:2,styles:[],data:{}});function Rn(e){return r.bc(0,[(e()(),r.zb(0,0,[[1,0],["heroAnnouncement",1]],null,2,"div",[["class","hero-announcementMarkup ms-fcl-ns"]],[[8,"innerHTML",1]],null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1})],(function(e,t){var n=t.component,i=e(t,2,0,!n.noGutter,n.noGutter);e(t,1,0,"hero-announcementMarkup ms-fcl-ns",i)}),(function(e,t){e(t,0,0,t.component.announcementMarkup)}))}function Mn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"div",[["class","hero-title-gradient"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroTitleGradient)}),null)}function xn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--left"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroLeftImageStyle)}),null)}function Ln(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"div",[["class","hero-background__image hero-background__image--right"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null)],(function(e,t){e(t,1,0,t.component.heroRightImageStyle)}),null)}function Un(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,9,"div",[["class","hero-background--full-bleed"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),(e()(),r.ib(16777216,null,null,1,null,xn)),r.yb(3,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(4,0,null,null,3,"div",[["class","hero-background__image"]],null,null,null,null,null)),r.yb(5,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(6,{"hero-background__image--pattern":0,"hero-background__image--center":1}),r.yb(7,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),(e()(),r.ib(16777216,null,null,1,null,Ln)),r.yb(9,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.bleedBackgroundStyle),e(t,3,0,n.hasSideImages);var i=e(t,6,0,n.isPatternImage,!n.isPatternImage);e(t,5,0,"hero-background__image",i),e(t,7,0,n.heroImageStyle),e(t,9,0,n.hasSideImages)}),null)}function Nn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"welcome__title--fluent":0}),(e()(),r.Yb(3,null,[" "," "]))],(function(e,t){var n=e(t,2,0,t.component.fluentRefresh);e(t,1,0,"ms-fontWeight-light welcome__title--consumer",n)}),(function(e,t){e(t,3,0,t.component.heroTitle)}))}function jn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,6,"div",[["class","welcome__badge--container"]],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,3,"h1",[["class","ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge"]],null,null,null,null,null)),r.yb(2,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(3,{"welcome__title--fluent":0}),(e()(),r.Yb(4,null,[" "," "])),(e()(),r.zb(5,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(6,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){var n=e(t,3,0,t.component.fluentRefresh);e(t,2,0,"ms-fontWeight-light welcome__title--consumer welcome__title--consumer-with-badge",n),e(t,6,0,"welcome-badge-react#WelcomeBadgeReactModule")}),(function(e,t){e(t,4,0,t.component.heroTitle)}))}function Wn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-icon-font",[["cssClass","diamond-web"],["iconFontName","Diamond"]],null,null,null,et.b,et.a)),r.yb(1,638976,null,0,tt.a,[K.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"]},null)],(function(e,t){e(t,1,0,"diamond-web","Diamond")}),null)}function Bn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link_new my-account__link_color my-account__link_new_hover_text_decoration my-account__link_margin"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(2,{color:0}),r.yb(3,81920,null,0,ot.a,[B.a],null,null),(e()(),r.ib(16777216,null,null,1,null,Wn)),r.yb(5,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.Yb(7,null,["",""])),(e()(),r.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,et.b,et.a)),r.yb(9,638976,null,0,tt.a,[K.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fullBleedFontColor);e(t,1,0,i),e(t,3,0),e(t,5,0,n.isPaidConsumer),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,r.Ob(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function zn(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install#InstallModule",i)}),null)}function Vn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,6,"div",[["class","hero__buttons-container hero-button-section--consumer"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"hero-button-section--consumer--fluent":0}),(e()(),r.ib(16777216,null,null,1,null,Bn)),r.yb(4,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,zn)),r.yb(6,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.fluentRefresh);e(t,1,0,"hero__buttons-container hero-button-section--consumer",i),e(t,4,0,n.isPaidConsumer&&!n.showWelcomeBadge),e(t,6,0,n.showInstall)}),null)}function Hn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,11,"div",[["class","hero-image-container__overlay"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"hero-image-container__overlay--consumer":0,"hero-image-container__overlay--consumer--fluent":1}),(e()(),r.zb(3,0,null,null,8,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.yb(4,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(5,{"width-restrictor width-restrictor--responsive":0,"width-restrictor--no-gutter":1,"hero-content--end-aligned":2}),(e()(),r.ib(16777216,null,null,1,null,Nn)),r.yb(7,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,jn)),r.yb(9,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Vn)),r.yb(11,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.isConsumer,n.isConsumer&&n.fluentRefresh);e(t,1,0,"hero-image-container__overlay",i);var r=e(t,5,0,!n.noGutter,n.noGutter,n.fluentRefresh);e(t,4,0,"hero-content--flex",r),e(t,7,0,!n.showWelcomeBadge),e(t,9,0,n.showWelcomeBadge),e(t,11,0,n.isConsumer)}),null)}function qn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-back-button",[],null,null,null,gn.b,gn.a)),r.yb(1,245760,null,0,vn.a,[K.a,B.a,Ne.a,q.a],{elementId:[0,"elementId"],backButtonAriaLabel:[1,"backButtonAriaLabel"],defaultBackRoute:[2,"defaultBackRoute"],responsive:[3,"responsive"],focusOnLoad:[4,"focusOnLoad"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.backButtonId,n.backButtonAriaLabel,n.defaultBackRoute,n.onTemplatesPage,n.onAppGalleryPage)}),null)}function Gn(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"welcome-badge-react#WelcomeBadgeReactModule")}),null)}function Qn(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"bread-crumb#FastBreadcrumbModule")}),null)}function Zn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,9,"h1",[["class","ms-fontWeight-light welcome__title ms-fcl-nd"],["id","hero-heading"]],null,[[null,"click"]],(function(e,t,n){var i=!0,r=e.component;return"click"===t&&(i=!1!==(r.showFASTBreadcrumb&&r.backToSearchPage())&&i),i}),null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"welcome__title--centered":0,"welcome__title--small":1,"welcome__title--responsive":2,"welcome__title--fluent":3}),r.yb(3,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(4,{color:0}),(e()(),r.Yb(5,null,[" "," "])),(e()(),r.ib(16777216,null,null,1,null,Gn)),r.yb(7,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Qn)),r.yb(9,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa&&!n.fluentRefresh,!n.fluentRefresh,n.fluentRefresh);e(t,1,0,"ms-fontWeight-light welcome__title ms-fcl-nd",i);var r=e(t,4,0,n.fullBleedFontColor);e(t,3,0,r),e(t,7,0,n.showWelcomeBadge),e(t,9,0,n.showFASTBreadcrumb)}),(function(e,t){e(t,5,0,t.component.heroTitle)}))}function Kn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,2,"div",[["class","hero__create-location"]],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,1,"ohp-create-location",[],null,null,null,yn.b,yn.a)),r.yb(2,114688,null,0,Sn.a,[K.a,Ne.a],{app:[0,"app"]},null)],(function(e,t){e(t,2,0,t.component.appContext)}),null)}function Xn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,Kn)),r.yb(2,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,2,0,t.component.showCreateLocation)}),null)}function Jn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,3,"a",[["class","generic-button generic-button--fluent generic-button--fluent--primary ms-bgc-tp ms-fcl-w ms-bgc-w-h ms-bgc-w-a ms-fcl-tp-h ms-fcl-tp-a ms-fcl-w-f"],["data-referral","OfficeStore"],["id","app-gallery-store-link"],["ohpDefaultLinkTarget",""],["rel","noopener"]],[[1,"data-area",0],[8,"href",4],[8,"target",0]],null,null,null,null)),r.yb(2,81920,null,0,ot.a,[B.a],null,null),(e()(),r.zb(3,0,null,null,1,"b",[["class","generic-button__text"]],null,null,null,null,null)),(e()(),r.Yb(4,null,["",""]))],(function(e,t){e(t,2,0)}),(function(e,t){var n=t.component;e(t,1,0,n.componentArea,n.store.Url,r.Ob(t,2).target),e(t,4,0,n.store.Text)}))}function Yn(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,9,"a",[["class","widget-attribution__link my-account__link ms-fcl-tda ms-fcl-tda-h ms-fcl-tdr-f ms-fcl-tdr-a"],["id","my-account-link"],["ohpDefaultLinkTarget",""]],[[8,"href",4],[1,"aria-label",0],[8,"target",0]],null,null,null,null)),r.yb(1,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),r.Rb(2,{color:0}),r.yb(3,81920,null,0,ot.a,[B.a],null,null),(e()(),r.zb(4,0,null,null,1,"ohp-icon-font",[["class","diamond-pwa ms-fcl-tda"],["iconFontName","Diamond"]],null,null,null,et.b,et.a)),r.yb(5,638976,null,0,tt.a,[K.a],{iconFontName:[0,"iconFontName"]},null),(e()(),r.zb(6,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r.Yb(7,null,["",""])),(e()(),r.zb(8,0,null,null,1,"ohp-icon-font",[["cssClass","link-arrow"],["iconFontName","ArrowRight"],["size","14"]],null,null,null,et.b,et.a)),r.yb(9,638976,null,0,tt.a,[K.a],{cssClass:[0,"cssClass"],iconFontName:[1,"iconFontName"],size:[2,"size"]},null)],(function(e,t){var n=e(t,2,0,t.component.fullBleedFontColor);e(t,1,0,n),e(t,3,0),e(t,5,0,"Diamond"),e(t,9,0,"link-arrow","ArrowRight","14")}),(function(e,t){var n=t.component;e(t,0,0,n.myAccountUrl,n.myAccountLinkText,r.Ob(t,3).target),e(t,7,0,n.myAccountLinkText)}))}function $n(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{componentArea:0,showInstallButton:1,appFilter:2}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.componentArea,n.showInstallButton,"Office");e(t,1,0,"install#InstallModule",i)}),null)}function ei(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,8,null,null,null,null,null,null,null)),(e()(),r.zb(1,0,null,null,7,"div",[["class","section__buttons-container hero__buttons-container"]],null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,Jn)),r.yb(3,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Yn)),r.yb(5,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(6,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.ib(16777216,null,null,1,null,$n)),r.yb(8,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,3,0,n.onAppGalleryPage&&n.store),e(t,5,0,n.isPaidConsumer&&!n.onAppGalleryPage&&!n.showWelcomeBadge),e(t,8,0,n.showInstall)}),null)}function ti(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,10,"div",[["class","hero-content--flex"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(2,{"hero-content--centered":0,"hero-content--small":1,"hero-content":2,"hero-content--aligned":3,"hero-content--suggested-actions":4}),(e()(),r.ib(16777216,null,null,1,null,qn)),r.yb(4,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Zn)),r.yb(6,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Xn)),r.yb(8,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,ei)),r.yb(10,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,i=e(t,2,0,n.onTemplatesPage&&!n.fluentRefresh,n.onHomePageOrPwa,!n.isSearchSiteScoped&&!n.fluentRefresh,n.fluentRefresh,n.suggestedActions);e(t,1,0,"hero-content--flex",i),e(t,4,0,n.showBackButton),e(t,6,0,n.heroTitle||n.showFASTBreadcrumb),e(t,8,0,!n.onAppGalleryPage),e(t,10,0,n.showHeroButtons)}),null)}function ni(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app-tiles-list",[],null,null,null,Wt,Rt)),r.yb(1,4440064,null,0,Dt,[Tt.a,pt,K.a,Ue.a,Et.a,T.a,k.b,q.a,p.b,ut.a,_t.a,Ot.a,kt.a,Ft.a,At.a,r.h],{fullBleedTheming:[0,"fullBleedTheming"],fullBleedFontColor:[1,"fullBleedFontColor"],fullBleedBackplateEnabled:[2,"fullBleedBackplateEnabled"],fullBleedBackplateStyle:[3,"fullBleedBackplateStyle"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.fullBleedThemingEnabled,n.fullBleedFontColor,n.fullBleedBackplateEnabled,n.fullBleedBackplateStyle)}),null)}function ii(e){return r.bc(0,[r.Ub(671088640,1,{heroAnnouncement:0}),(e()(),r.zb(1,0,null,null,1,"ohp-title-announcer",[],null,null,null,wn.b,wn.a)),r.yb(2,49152,null,0,Cn.a,[],{announcement:[0,"announcement"]},null),(e()(),r.zb(3,0,null,null,21,"div",[["class","hero-section"]],null,null,null,null,null)),r.yb(4,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(5,{"hero-section--padded":0,"hero-section__2dot0--padded":1,"hero-section__homepage--padded":2,"hero-section-mobile--padded":3}),r.yb(6,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),(e()(),r.ib(16777216,null,null,1,null,Rn)),r.yb(8,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Mn)),r.yb(10,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Un)),r.yb(12,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Hn)),r.yb(14,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(15,0,null,null,9,"div",[],null,null,null,null,null)),r.yb(16,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{ngClass:[0,"ngClass"]},null),r.Rb(17,{"width-restrictor":0,"width-restrictor--responsive":1,"width-restrictor--no-gutter":2,"breadcrumb-width-restrictor":3,"breadcrumb-width-restrictor-fallback":4}),(e()(),r.zb(18,0,null,null,6,"div",[["class","hero-container"]],[[1,"role",0],[1,"aria-labelledby",0]],null,null,null,null)),r.yb(19,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(20,{"hero-image-container--fluent":0,"hero-image-container":1}),(e()(),r.ib(16777216,null,null,1,null,ti)),r.yb(22,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,ni)),r.yb(24,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.accessibilityTitle);var i=e(t,5,0,(n.appsInHero||n.hideConsumerBackgroundImage)&&!(n.bottomTrayEnabled&&n.onAppGalleryPage)&&!n.onSearchPage&&!n.onCreatePage,n.onCreatePage||n.onHomePageOrPwa&&n.appBarEnabled,n.onHomePageOrPwa&&!n.leftNavReact,n.bottomTrayEnabled);e(t,4,0,"hero-section",i),e(t,6,0,n.hideConsumerBackgroundImage?"":n.backgroundStyle),e(t,8,0,void 0!==n.announcementMarkup),e(t,10,0,!n.appsInHero&&!n.hideConsumerBackgroundImage),e(t,12,0,n.fullBleedThemingEnabled),e(t,14,0,!n.appsInHero&&!n.hideConsumerBackgroundImage);var r=e(t,17,0,!n.noGutter,!n.noGutter&&n.heroTitle,n.noGutter,!n.heroTitle,!n.isContextualRailEnabled);e(t,16,0,r);var o=e(t,20,0,!n.appsInHero&&!n.hideConsumerBackgroundImage,!n.appsInHero&&!n.hideConsumerBackgroundImage);e(t,19,0,"hero-container",o),e(t,22,0,n.showAppTilesHeroTitle),e(t,24,0,n.showApps)}),(function(e,t){var n=t.component;e(t,18,0,n.showAppTilesHeroTitle?"region":void 0,n.showAppTilesHeroTitle?"hero-heading":void 0)}))}r.vb("ohp-hero",Fn,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-hero",[],null,null,null,ii,Dn)),r.yb(1,12828672,null,0,Fn,[Q.a,Tt.a,pt,K.a,Ue.a,B.a,pe.b,H.a,kn.a,Ne.a,q.a,Te.a,xe.b,On,d.b,ut.a,p.b,_n.a],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]);var ri=function(){function e(e,t,n,i){var r=this;this.capabilitiesService=e,this.officeRouteService=t,this.themingService=n,this.locService=i;var o={id:"home",title:this.locService.HomeTabTitle,ariaLabel:this.locService.HomeTabAriaLabel,routes:["OfficeHome","Start","Templates"],iconClass:"Home"},a={id:"apps",title:this.locService.AppsTabTitle,ariaLabel:this.locService.AppsTabAriaLabel,routes:["AppGallery"],iconClass:"Waffle"};this.tabs=this.capabilitiesService.capabilities.showSearch?[o,{id:"search",title:this.locService.SearchTabTitle,ariaLabel:this.locService.SearchTabAriaLabel,routes:["Search"],iconClass:"Search"},a]:[o,a],this.activeTabId=t.getRouteChangeStartObservable().pipe(Object(tn.a)((function(e){var t=e.currentRoute.route,n=r.tabs.find((function(e){return r.isActive(e,t)}));return n?n.id:"Home"}))),this.isDarkMode=this.themingService.themeShades.pipe(Object(tn.a)((function(e){return!(!e.theme||!e.theme.reactShellTheme)&&e.theme.reactShellTheme.IsDarkMode})))}return e.prototype.trackByTabId=function(e,t){return t.id},e.prototype.navigateTo=function(t){this.officeRouteService.navigateTo({route:t.routes[0]},!1,null,e.LastBottomTrayTab)},e.prototype.isActive=function(e,t){return e.routes.indexOf(t)>=0},e.LastBottomTrayTab="LastBottomTrayTab",e}(),oi=r.xb({encapsulation:2,styles:[],data:{}});function ai(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,7,"button",[["class","bottom-tray__tab-button ms-fcl-nd"]],[[8,"id",0]],[[null,"click"]],(function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.navigateTo(e.context.$implicit)&&i),i}),null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Qb(131072,Je.b,[r.h]),r.Rb(3,{"ms-fcl-tp":0}),(e()(),r.zb(4,0,null,null,1,"ohp-icon-font",[["size","16"]],null,null,null,et.b,et.a)),r.yb(5,638976,null,0,tt.a,[K.a],{iconFontName:[0,"iconFontName"],size:[1,"size"]},null),(e()(),r.zb(6,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),r.Yb(7,null,["",""]))],(function(e,t){var n=t.component,i=e(t,3,0,t.context.$implicit.id===r.Zb(t,1,1,r.Ob(t,2).transform(n.activeTabId)));e(t,1,0,"bottom-tray__tab-button ms-fcl-nd",i),e(t,5,0,t.context.$implicit.iconClass,"16")}),(function(e,t){e(t,0,0,"bottom-tray-tab-"+t.context.$implicit.id),e(t,7,0,t.context.$implicit.title)}))}function si(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,5,"div",[["class","bottom-tray-container"],["role","navigation"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Qb(131072,Je.b,[r.h]),r.Rb(3,{"ms-bgc-w":0}),(e()(),r.ib(16777216,null,null,1,null,ai)),r.yb(5,278528,null,0,Je.j,[r.O,r.L,r.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],(function(e,t){var n=t.component,i=e(t,3,0,r.Zb(t,1,1,r.Ob(t,2).transform(n.isDarkMode)));e(t,1,0,"bottom-tray-container",i),e(t,5,0,n.tabs,n.trackByTabId)}),null)}r.vb("ohp-bottom-tray",ri,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,si,oi)),r.yb(1,49152,null,0,ri,[K.a,q.a,xe.b,Ne.a],null,null)],null,null)}),{},{},[]);var ci=n("qSxk"),li=function(){function e(e,t,n){this.elementRef=e,this.eventService=t,this.zone=n,this.eventName=this.eventName||"contentScrolled"}return e.prototype.ngDoCheck=function(){this.initialized||(this.initialized=!0,this.setScrollListener())},e.prototype.ngOnDestroy=function(){this.scrollEventSubscription&&this.scrollEventSubscription.unsubscribe()},e.prototype.setScrollListener=function(){var e=this;this.zone.runOutsideAngular((function(){e.scrollEventSubscription=Object(ci.a)(e.elementRef.nativeElement,"scroll").pipe(Object(Tn.a)(10)).subscribe((function(){e.eventService.broadcastEvent({name:e.eventName,args:[]})}))}))},e}(),ui=n("KoFE"),di=n("9c4X"),pi=n("y1jW"),fi=r.xb({encapsulation:2,styles:[],data:{}});function hi(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),r.zb(1,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(2,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,2,0,"left-nav-react#LeftNavReactModule")}),null)}function mi(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),r.zb(1,0,null,null,0,"div",[["class","ms-bgc-d appbar-placeholder"],["id","appBar"]],null,null,null,null,null)),(e()(),r.zb(2,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(3,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null)],(function(e,t){e(t,3,0,"appbar#AppBarModule")}),null)}function bi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feature-callout#FeatureCalloutModule")}),null)}function gi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"workspace-nav#WorkspaceNavModule")}),null)}function vi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"mobile-app-banner#MobileAppBannerModule")}),null)}function yi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{viewMetric:0}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.viewMetric);e(t,1,0,"banner#BannerModule",n)}),null)}function Si(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-hero",[],null,null,null,ii,Dn)),r.yb(1,12828672,null,0,Fn,[Q.a,Tt.a,pt,K.a,Ue.a,B.a,pe.b,H.a,kn.a,Ne.a,q.a,Te.a,xe.b,On,d.b,ut.a,p.b,_n.a],null,null)],(function(e,t){e(t,1,0)}),null)}function wi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{collapsed:0}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.showNewUserShelfCollapsed);e(t,1,0,"new-user-shelf#NewUserShelfModule",n)}),null)}function Ci(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"new-consumer-experience#NewConsumerExperienceModule")}),null)}function Ii(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"web-vitals#WebVitalsModule")}),null)}function Ti(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feature-tooltip-container#FeatureTooltipContainerModule")}),null)}function ki(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function _i(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"action-context-menu-react#ActionContextMenuReactModule")}),null)}function Ai(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{renderFluidDocument:0}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.onFluidContentPage);e(t,1,0,"fluid-content#FluidContentModule",n)}),null)}function Pi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"feedback#FeedbackModule")}),null)}function Ei(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"support-central-react#SupportCentralReactModule")}),null)}function Oi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"upload-dialog#UploadDialogModule")}),null)}function Fi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"error-dialog-react#ErrorDialogReactModule")}),null)}function Di(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"task-module-dialog-react#TaskModuleDialogReactModule")}),null)}function Ri(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"confirmation-dialog-react#ConfirmationDialogReactModule")}),null)}function Mi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"create-onenote-page-dialog-react#CreateOneNotePageDialogReactModule")}),null)}function xi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{showFASTBreadcrumb:0}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=e(t,2,0,t.component.showFASTBreadcrumb);e(t,1,0,"auto-suggest#AutoSuggestModule",n)}),null)}function Li(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"side-popup-menu#SidePopupMenuModule")}),null)}function Ui(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"toast-container-react#ToastContainerReactModule")}),null)}function Ni(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-bottom-tray",[],null,null,null,si,oi)),r.yb(1,49152,null,0,ri,[K.a,q.a,xe.b,Ne.a],null,null)],null,null)}function ji(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"first-run#FirstRunModule")}),null)}function Wi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{bottomAligned:0,viewMetric:1,bottomTrayEnabled:2}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,!0,n.viewMetric,n.bottomTrayEnabled);e(t,1,0,"banner#BannerModule",i)}),null)}function Bi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"context-menu#ContextMenuModule")}),null)}function zi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{mobileShareMenu:0,contentShareMenu:1}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadShareControlModuleForContentPage);e(t,1,0,"share-control#ShareControlModule",i)}),null)}function Vi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,2,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"],inputs:[1,"inputs"]},null),r.Rb(2,{mobileMoveToFolderMenu:0,contentMoveToFolderMenu:1}),(e()(),r.ib(0,null,null,0))],(function(e,t){var n=t.component,i=e(t,2,0,n.mobileMenusEnabled,n.loadMoveToFolderModuleForContentPage);e(t,1,0,"move-to-folder-control#MoveToFolderControlModule",i)}),null)}function Hi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"search-preload#SearchPreloadModule")}),null)}function qi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"wac-content#WacContentModule")}),null)}function Gi(e){return r.bc(0,[(e()(),r.zb(0,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(1,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(0,null,null,0))],(function(e,t){e(t,1,0,"fluent-theme-provider#FluentThemeProviderModule")}),null)}function Qi(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,92,"div",[["id","officeHomeRoot"]],null,null,null,null,null)),r.yb(1,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{ngClass:[0,"ngClass"]},null),(e()(),r.zb(2,0,null,null,73,"div",[["class","ms-fontWeight-regular ms-bgc-nla"],["id","officeHome"]],null,null,null,null,null)),r.yb(3,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),r.ib(16777216,null,null,1,null,hi)),r.yb(5,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,mi)),r.yb(7,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(8,16777216,null,null,1,"router-outlet",[["name","install-wizard"]],null,null,null,null,null)),r.yb(9,212992,null,0,Q.p,[Q.b,r.O,r.j,[8,"install-wizard"],r.h],null,null),(e()(),r.ib(16777216,null,null,1,null,bi)),r.yb(11,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(12,0,null,null,36,"div",[["class","o365cs-base o365cst"],["id","officeHome__container"]],null,null,null,null,null)),r.yb(13,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),r.Rb(14,{"office-box-sizing":0,"left-nav-offset":1,"appbar-offset":2,"bottom-tray-navigation":3,"ms-bgc-nla":4,"fluent-background-color":5,"fluentvnext-background":6,"fluentvnext-background-shadow":7}),(e()(),r.ib(16777216,null,null,1,null,gi)),r.yb(16,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(17,0,[[1,0],["scrollElement",1]],null,31,"div",[["id","officeHome__scroll-content"],["ohpScrollListener",""]],null,[[null,"dragover"],[null,"drop"]],(function(e,t,n){var i=!0,r=e.component;return"dragover"===t&&(i=!1!==r.dragoverHandler(n)&&i),"drop"===t&&(i=!1!==r.dropHandler(n)&&i),i}),null,null)),r.yb(18,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{ngClass:[0,"ngClass"]},null),r.Rb(19,{"scroll-content":0,"scroll-content--transform":1,"app-gallery-workspace-nav-offset":2,"scroll-content--hide":3}),r.yb(20,409600,null,0,li,[r.l,H.a,r.z],null,null),(e()(),r.zb(21,0,null,null,27,"div",[["id","officeHome__wrapper"]],null,null,null,null,null)),r.yb(22,278528,null,0,Je.i,[r.s,r.t,r.l,r.D],{ngClass:[0,"ngClass"]},null),r.Rb(23,{"fluent-background":0}),r.yb(24,278528,null,0,Je.n,[r.l,r.t,r.D],{ngStyle:[0,"ngStyle"]},null),(e()(),r.zb(25,0,null,null,23,"div",[["id","officeHome__content"]],null,[[null,"ohpResize"]],(function(e,t,n){var i=!0;return"ohpResize"===t&&(i=!1!==e.component.onResize(n)&&i),i}),null,null)),r.yb(26,4407296,null,0,ui.a,[di.a,r.l,At.a],null,{resize:"ohpResize"}),(e()(),r.ib(16777216,null,null,1,null,vi)),r.yb(28,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,yi)),r.yb(30,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Si)),r.yb(32,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,wi)),r.yb(34,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ci)),r.yb(36,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ii)),r.yb(38,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(39,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),r.yb(40,212992,null,0,Q.p,[Q.b,r.O,r.j,[8,null],r.h],null,null),(e()(),r.ib(16777216,null,null,1,null,Ti)),r.yb(42,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,ki)),r.yb(44,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,_i)),r.yb(46,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ai)),r.yb(48,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,2,null,Pi)),r.yb(50,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),r.Qb(131072,Je.b,[r.h]),(e()(),r.ib(16777216,null,null,1,null,Ei)),r.yb(53,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Oi)),r.yb(55,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.zb(56,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(57,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.zb(58,16777216,null,null,1,null,null,null,null,null,null,null)),r.yb(59,475136,null,0,Ht.a,[qt.a,r.O,c.b,p.b,Oe.a,Gt.a,At.a,r.z,G.a],{ngModulePath:[0,"ngModulePath"]},null),(e()(),r.ib(16777216,null,null,1,null,Fi)),r.yb(61,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Di)),r.yb(63,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ri)),r.yb(65,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Mi)),r.yb(67,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,xi)),r.yb(69,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Li)),r.yb(71,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ui)),r.yb(73,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Ni)),r.yb(75,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,ji)),r.yb(77,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Wi)),r.yb(79,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Bi)),r.yb(81,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,zi)),r.yb(83,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Vi)),r.yb(85,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,1,null,Hi)),r.yb(87,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),(e()(),r.ib(16777216,null,null,2,null,qi)),r.yb(89,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null),r.Qb(131072,Je.b,[r.h]),(e()(),r.ib(16777216,null,null,1,null,Gi)),r.yb(92,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,1,0,n.themeRootCssClass),e(t,3,0,"ms-fontWeight-regular ms-bgc-nla",n.officeHomeClass),e(t,5,0,n.leftNavReact&&!n.onWacContentPage),e(t,7,0,n.appBarEnabled&&!n.onWacContentPage),e(t,9,0),e(t,11,0,n.loadFeatureCalloutModule);var i=e(t,14,0,!n.onFeedPage,n.leftNavReact&&!n.onWacContentPage,n.appBarEnabled&&!n.onWacContentPage,n.bottomTrayEnabled,!n.fluentThemeRefreshEnabled,!n.fluentThemeRefreshEnabled,n.fluentThemeRefreshEnabled,n.fluentHeaderEnabled);e(t,13,0,"o365cs-base o365cst",i),e(t,16,0,n.showWorkspaceNav);var o=e(t,19,0,!n.onContentPage,!n.onContentPage&&!n.onMyContentPage,n.showWorkspaceNav,n.onM365AppsPage||n.onAppGallery&&n.appGalleryReactEnabled);e(t,18,0,o),e(t,20,0);var a=e(t,23,0,n.showBackgroundImage);e(t,22,0,a),e(t,24,0,n.showBackgroundImage?n.backgroundStyle:""),e(t,26,0),e(t,28,0,n.showMobileAppBanner),e(t,30,0,!n.onContentPage&&!n.onAppGallery),e(t,32,0,!n.onContentPage&&!n.onMyContentPage&&!n.onFeedPage),e(t,34,0,(n.showNewCommercialUserShelfExpanded||n.showNewUserShelfCollapsed)&&n.onHomePage),e(t,36,0,n.showNewConsumerExperiences&&n.onHomePage),e(t,38,0,n.webVitalsEnabled||n.memoryProfilingEnabled),e(t,40,0),e(t,42,0,!n.newOfficeHomePageExperience),e(t,44,0,!n.mobileMenusEnabled&&!n.actionContextMenuEnabled),e(t,46,0,!n.mobileMenusEnabled&&n.actionContextMenuEnabled),e(t,48,0,n.fluidSupportEnabled&&!n.isIE),e(t,50,0,n.shouldShowFeedbackButton()&&!r.Zb(t,50,0,r.Ob(t,51).transform(n.isStandalone))),e(t,53,0,n.supportCentralEnabled&&!n.onContentPage),e(t,55,0,n.uploadEnabled&&!n.newOfficeHomePageExperience),e(t,57,0,"error-dialog#ErrorDialogModule"),e(t,59,0,"input-dialog#InputDialogModule"),e(t,61,0,n.stayingAware||n.onMyContentPage),e(t,63,0,n.taskModule),e(t,65,0,n.customPivots),e(t,67,0,n.createOneNotePageEnabled),e(t,69,0,n.searchEnabled&&!n.hideCustomSearch),e(t,71,0,n.sidePopUpEnabled),e(t,73,0,n.toastContainer),e(t,75,0,n.bottomTrayEnabled&&!n.onFluidContentPage),e(t,77,0,n.firstRunEnabled||n.showPremiumUpsellModal),e(t,79,0,!n.onContentPage),e(t,81,0,n.mobileMenusEnabled),e(t,83,0,n.mobileMenusEnabled||n.loadShareControlModuleForContentPage),e(t,85,0,n.loadMoveToFolderModuleForContentPage),e(t,87,0,n.nativeSearchEnabled),e(t,89,0,r.Zb(t,89,0,r.Ob(t,90).transform(n.wacHostEnabled))),e(t,92,0,n.fluentThemeRefreshEnabled)}),null)}function Zi(e){return r.bc(0,[r.Ub(671088640,1,{scrollElement:0}),(e()(),r.ib(16777216,null,null,1,null,Qi)),r.yb(2,16384,null,0,Je.k,[r.O,r.L],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.viewInitializationCompleted)}),null)}var Ki=r.vb("ohp-app",Ke,(function(e){return r.bc(0,[(e()(),r.zb(0,0,null,null,1,"ohp-app",[],null,[["window","resize"],["window","focus"],["window","beforeinstallprompt"],["window","appinstalled"]],(function(e,t,n){var i=!0;return"window:resize"===t&&(i=!1!==r.Ob(e,1).onWindowResize()&&i),"window:focus"===t&&(i=!1!==r.Ob(e,1).onWindowFocus()&&i),"window:beforeinstallprompt"===t&&(i=!1!==r.Ob(e,1).onBeforeInstall(n)&&i),"window:appinstalled"===t&&(i=!1!==r.Ob(e,1).onAppInstalled()&&i),i}),Zi,fi)),r.yb(1,507904,null,0,Ke,[l.a,H.a,pi.h,d.b,Q.n,r.r,r.h],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Xi=n("ZJrL"),Ji=function(){function e(e){this.windowService=e,this.initialize()}return e.prototype.getShellAndConfigPromise=function(){return window.queuedMarks=window.queuedMarks||[],window.performance&&window.performance.mark&&window.performance.mark("App_Initialization_Complete"),window.queuedMarks.push({markName:"App_Initialization_Complete",measureFrom:"App_Begin_Bootstrap"}),this.shellAndConfigResponse},e.prototype.reset=function(){this.setShellAndConfigPromise()},e.prototype.initialize=function(){this.initialized||(this.initialized=!0,this.setShellAndConfigPromise())},e.prototype.fetchShellAndConfig=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.windowService.nativeWindow.shellAndConfigResponse];case 1:if(e=t.sent())try{this.shellAndConfigData=JSON.parse(e)}catch(t){this.shellAndConfigData=e}return[2]}}))}))},e.prototype.setShellAndConfigPromise=function(){this.shellAndConfigResponse=this.fetchShellAndConfig()},e.ɵprov=r.cc({factory:function(){return new e(r.dc(d.b))},token:e,providedIn:"root"}),e}(),Yi=function(){function e(e,t){this.apiConfigurationDataService=e,this.globalErrorHandler=t,this.configMap=new Map(Object.entries(this.apiConfigurationDataService.shellAndConfigData))}return e.prototype.parse=function(e,t){void 0===t&&(t=!1);try{if(this.configMap.has(e)){if(t){var n=Xi.a.decodeJsonString(this.configMap.get(e));return JSON.parse(n)}return JSON.parse(this.configMap.get(e))}return Xi.a.parseJsonElementWithId(e)}catch(t){var i=new c.a("Failure to parse "+e+" from ShellConfig response",t);this.globalErrorHandler.handleError(i)}},e}(),$i=function(e){return Object(s.a)()?new Ji(e):null},er=function(e){return Object(s.a)()?function(){return e.getShellAndConfigPromise()}:function(){return Promise.resolve()}},tr=function(e,t){return Object(s.a)()?new Yi(e,t):new z.a(t)},nr=function(e,t,n){return Object(s.a)()?function(){var i=e.get(je.a).reactShellConfig,r=e.get(K.a).capabilities,o=document.createElement("script");o.src=i.resourceUrl,o.crossOrigin="anonymous",o.async=!0,o.type="text/javascript",o.onload=function(){if(HomePage.ShellUtil.BootstrapReactShell("IWApp",i,r),n.config.authType===p.a.OrgId){var e=t.parse("navBarData");HomePage.ShellUtil.HydrateCommercialReactShell(e,!1,i)}},document.body.appendChild(o)}:function(){}},ir=function(){return function(){}}();function rr(e,t){return t.open(e,"login_window","width=483,height=600,top="+(t.innerHeight/2-300+t.screenY)+",left="+(t.innerWidth/2-241.5+t.screenX))}function or(e,t,n){var i=t.setInterval((function(){e&&!e.closed&&void 0!==e.closed||(t.clearInterval(i),n())}),100);return i}var ar=n("MFXD"),sr=n("EYcb"),cr=function(e){function t(t,n,i){var r=this;try{r=e.call(this,n.config.puid,i.getStorage(d.a.SessionStorage))||this,i.isStorageAvailable(d.a.SessionStorage)||(t.logGenericEvent("Session_Storage_Unavailable"),Object(Pe.a)({eventName:"Session_Storage_Unavailable"}))}catch(e){}return r}return Object(i.__extends)(t,e),t.ɵprov=r.cc({factory:function(){return new t(r.dc(T.a),r.dc(p.b),r.dc(d.b))},token:t,providedIn:"root"}),t}(n("XV2T").a),lr=function(){function e(e,t,n,i,r,o,a,s){this.windowService=e,this.documentService=t,this.contextService=n,this.capabilitiesService=i,this.sessionStorageService=r,this.instrumentationService=o,this.clientStartupConfigService=a,this.errorDialogService=s,this._responses=new ar.a,this.supportedTokens=new Map,this.handlerErrorId="handler_error",this.init()}return e.prototype.supportsToken=function(e){return this.supportedTokens.has(e)},e.prototype.requiresInteractiveLogin=function(e){var t;if(this.capabilitiesService.capabilities.isPwaInUwp)return!1;var n=this.getTokenFromCache(e);return!(n&&n.success&&n.token&&n.expiryMs>Date.now())&&n&&!n.success&&this.isInteractiveErrorMessage(null===(t=n.error)||void 0===t?void 0:t.message)},e.prototype.fetchTokenInteractive=function(e){var t=this;return new Promise((function(n,i){t.showLoginDialog((function(){var r=t.supportedTokens.get(e),o=t.getState("popup"),a=t.windowService.nativeWindow,s=t.getTokenFetchUrl(r,o,"login"),c=k.a.now(),l=rr(s,a);if(!l){var u="Could not create login popup";return t.logFetchRequest(!1,!0,!1,-1,u),void i(u)}var d=or(l,a,(function(){var e=k.a.now(),n="Popup closed by user";t.logFetchRequest(!1,!0,!1,Math.ceil(e-c),n),i(n)}));t.waitForToken(e,o,c,!1,!0).catch().then((function(e){a.clearInterval(d),l.close(),e&&e.success?n(e):i("Failed to fetch token through popup")}))}),(function(){var e="Verify dialog closed by user";t.logFetchRequest(!1,!0,!1,-1,e),i(e)}))}))},e.prototype.getAccessTokenResponse=function(e,t,n){var i=this;if(void 0===t&&(t=!1),void 0===n&&(n=!1),!this.supportsToken(e))return Promise.reject("token not supported");if(t&&this.requiresInteractiveLogin(e))return this.fetchTokenInteractive(e);var r=k.a.now();if(!n){var o=this.getTokenFromCache(e);if(o&&o.success&&o.token&&o.expiryMs>Date.now()){var a=k.a.now();return this.logFetchRequest(!0,!1,!0,Math.ceil(a-r)),Promise.resolve(o)}}var s=this.getState("iframe"),c=this.supportedTokens.get(e),l=this.getTokenFetchUrl(c,s,"none"),u=this.getIframeId(e),d=this.documentService.nativeDocument.getElementById(u);return d?d.setAttribute("src",l):this.documentService.addIframeToPage(l,u),this.waitForToken(e,s,r,!0,!1).then((function(n){var r;return!n.success&&t&&i.isInteractiveErrorMessage(null===(r=n.error)||void 0===r?void 0:r.message)?i.fetchTokenInteractive(e):n}))},e.prototype.waitForToken=function(e,t,n,i,r){var s=this,c=null,l=[];if(i){var u=new Promise((function(e){c=setTimeout((function(){e({success:!1,token:null,format:"RPSDelegation",error:new N.a("timeout"),source:"MSA"})}),s.contextService.sharedContext.msaTokenTimeoutMs)}));l.push(u)}var d=this.responses.withScope(1).pipe(Object(o.a)((function(e){return e.state===t||e.state===s.handlerErrorId})),Object(a.a)(1),Object(tn.a)((function(e){return e&&e.state!==s.handlerErrorId&&e.token&&e.token.TokenValue&&!e.error?{success:!0,token:e.token.TokenValue,format:"RPSDelegation",source:"MSA",expiryMs:e.token.ExpiryMs}:{success:!1,token:null,format:"RPSDelegation",error:new N.a(T.a.filterPii(e.error)),source:"MSA"}}))).toPromise();return l.push(d),Promise.race(l).then((function(t){var i,o=k.a.now();return s.logFetchRequest(!1,r,t.success,Math.ceil(o-n),null===(i=t.error)||void 0===i?void 0:i.message),c&&clearTimeout(c),s.saveTokenToCache(e,t),t}))},e.prototype.getTokenFromCache=function(e){var t=this.sessionStorageService.get(this.getCacheKey(e));try{var n=JSON.parse(t.error),r=new N.a(n.message,n.statusCode);return r.stack=n.stack,Object(i.__assign)(Object(i.__assign)({},t),{error:r})}catch(e){return t}},e.prototype.saveTokenToCache=function(e,t){var n,r=Object(i.__assign)(Object(i.__assign)({},t),{error:t.error?JSON.stringify({message:null===(n=t.error)||void 0===n?void 0:n.message,stack:t.error.stack,statusCode:t.error.statusCode}):void 0});this.sessionStorageService.set(this.getCacheKey(e),r)},e.prototype.getCacheKey=function(e){return"_msatoken_"+e},e.prototype.isInteractiveErrorMessage=function(e){return e&&(-1!==e.indexOf("login_required")||-1!==e.indexOf("interaction_required"))},Object.defineProperty(e.prototype,"responses",{get:function(){return this._responses.asScopableObservable()},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.capabilitiesService.capabilities.msaClientTokensEnabled&&(this.windowService.nativeWindow.addEventListener("message",(function(t){var n=t.data;e.windowService.sameOriginRegex.test(t.origin)&&e._responses.next(n)})),this.clientStartupConfigService.config.isV2Auth&&this.capabilitiesService.capabilities.graphApiForV2ConsumerEnabled||(this.supportedTokens.set("OneDrive","onedrive_implicit.access"),this.supportedTokens.set("Graph","Family.Read Files.ReadWrite People.Read User.Read Contacts.Read")),this.supportedTokens.set("Forms","Forms.ReadWrite"),this.supportedTokens.forEach((function(t,n){e.documentService.addIframeToPage(null,e.getIframeId(n))})))},e.prototype.getIframeId=function(e){return"ohpMSAToken_"+e},e.prototype.getInstrumentationParams=function(e,t){var n={};return n.State=e?"FromCache":"FromNetwork",n.Action=t?"interactive":"silent",n},e.prototype.logFetchRequest=function(e,t,n,i,r){var o=this.getInstrumentationParams(e,t);this.instrumentationService.logRequestEvent("Msa_Token_Fetch",n?200:500,i,r,e,o)},e.prototype.getTokenFetchUrl=function(e,t,n){var i=this.contextService.sharedContext.msaAppId,r=this.contextService.sharedContext.msaTokenRedirectUrl;return(this.contextService.sharedContext.inMockMode?this.contextService.sharedContext.officeHomeApiRoot+"/getMsaToken?mockmode="+this.getMockMode()+"&":"https://login.live.com/oauth20_authorize.srf?")+"client_id="+i+"&response_type=token&redirect_uri="+encodeURIComponent(r)+"&response_mode=fragment&scope="+encodeURIComponent(e)+"&state="+encodeURIComponent(t)+"&prompt="+n+"&username="+encodeURIComponent(this.clientStartupConfigService.config.userPrincipalName)},e.prototype.getState=function(e){return e+"|"+He.a.createGuid()},e.prototype.showLoginDialog=function(e,t){this.errorDialogService.showErrorDialog({category:"VerifyIdentity",error:"LoginRequired",onActionClicked:e,onClose:t})},e.prototype.getMockMode=function(){return dt.a.getQueryParams(this.windowService.nativeWindow.location.search).mockmsatoken||"default"},e.ɵprov=r.cc({factory:function(){return new e(r.dc(d.b),r.dc(l.a),r.dc(B.a),r.dc(K.a),r.dc(cr),r.dc(T.a),r.dc(p.b),r.dc(sr.a))},token:e,providedIn:"root"}),e}(),ur=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m){var b=e.call(this)||this;b.authStateService=t,b.contextService=n,b.capabilitiesService=i,b.instrumentedHttp=r,b.eventService=o,b.configParserService=a,b.instrumentationService=c,b.msaTokenService=l,b.windowService=u,b.reactShellConfigService=d,b.userContextService=p,b.errorDialogService=f,b.locService=h,b.clientStartupConfigService=m,b.tokensRequiringResourceUrl=new Set(["OneDrive","SharePoint","MetaOS"]),b._messageResponses=new ar.a,b.capDialogStartTime=0,b.init(s,"JWT","OfficeHome"),b.refreshApiUrls=new Map,b.accessTokens=new Map,b.pendingRefreshRequests=new Map,b.secondaryTokensEnabled=b.capabilitiesService.capabilities.secondaryTokensEnabled,b.msaClientTokensEnabled=b.capabilitiesService.capabilities.msaClientTokensEnabled,b.defaultResourceUrls=new Map,b.defaultResourceUrls.set("OneDrive",b.contextService.sharedContext.oneDriveResourceId),b.defaultResourceUrls.set("SharePoint",b.contextService.sharedContext.sharePointResourceId),b.msaClientTokensEnabled&&(b.clientStartupConfigService.config.isV2Auth&&b.capabilitiesService.capabilities.graphApiForV2ConsumerEnabled||(b.initializeAccessToken("OneDrive","",null),b.initializeAccessToken("Graph","",null))),b.capabilitiesService.capabilities.clientTokenFetchEnabled?(b.initializeSecondaryTokensPromise=Promise.resolve(),b.secondaryTokensEnabled&&b.initializeSecondaryTokens(null),b.initializePrimaryTokensPromise=new Promise((function(e){var t=b.contextService.sharedContext.officeHomeApiRoot+"/api/primaryTokens?pageUrl="+encodeURIComponent(b.windowService.nativeWindow.location.href),n={responseType:"json",headers:new Map};b.instrumentedHttp.get("Primary_Token_Fetch_Request","Primary_Token_Fetch",t,n,"network-only").then((function(t){var n=t.data;n&&n.ReauthRequired&&n.LoginUrl?b.windowService.nativeWindow.location.href=n.LoginUrl:(b.initializePrimaryTokens(n&&n.Tokens),e())})).catch((function(t){b.errorHandler.handleError(t,"Pno9F"),b.initializePrimaryTokens(null),e()}))}))):(b.initializePrimaryTokensPromise=b.initializeTokensPromise("primaryTokensInfo","primaryTokensLoaded",(function(e){e||b.instrumentationService.logGenericEvent("Tokens_Config_Missing",{ElementId:"primaryTokensInfo"}),b.initializePrimaryTokens(e),b.secondaryTokensEnabled||b.msaClientTokensEnabled||b.initializeSecondaryTokens(e)})),b.initializeSecondaryTokensPromise=b.secondaryTokensEnabled?b.initializeTokensPromise("secondaryTokensInfo","secondaryTokensLoaded",(function(e){e||b.instrumentationService.logGenericEvent("Tokens_Config_Missing",{ElementId:"secondaryTokensInfo"}),b.initializeSecondaryTokens(e)})):Promise.resolve());var g=b.windowService.nativeWindow.shellTokenRequestDictionary;return b.reactShellConfigService.reactShellConfig.consumerShellServiceEnabled&&g&&(g[b.contextService.sharedContext.consumerShellServiceEndpoint]=function(){return b.getAccessTokenResponse("ConsumerShellService").then((function(e){return e.token}))}),b.windowService.nativeWindow.addEventListener("message",(function(e){var t=e.data;b.windowService.sameOriginRegex.test(e.origin)&&b._messageResponses.next(t)})),b}return Object(i.__extends)(t,e),t.prototype.hasPermanentAuthError=function(){var e=this;return new Promise((function(t){e.initializePrimaryTokensPromise.then((function(){var n=e.accessTokens.size>0;e.accessTokens.forEach((function(e){n&&e.token&&!e.token.HasPermanentError&&(n=!1)})),t(n)}))}))},t.prototype.hasOneDriveToken=function(){var e=this.accessTokens.get(this.getTokenKey("OneDrive",null));return!!e&&!!e.token&&!!e.token.TokenValue},t.prototype.hasCAPError=function(e,t){var n=this.getTokenKey(e,t),i=this.accessTokens.get(n);return i&&i.token&&i.token.HasCAPError},t.prototype.getAccessTokenResponse=function(e,t,n,i,r,o,a,s){var c=this;void 0===t&&(t=!1),void 0===n&&(n=""),void 0===i&&(i=!1),void 0===r&&(r=null);var l=this.getTokenKey(e,n,a,s),u=this.pendingRefreshRequests.get(l);if(u&&u.pending&&(!i||u.allowInteractive))return u.result;var d={pending:!1,result:null,allowInteractive:i},f=new Promise((function(o,u){c.getInitializationPromise(e,i).then((function(){var d=c.accessTokens.get(l);if(d||(d={refreshEndpoint:c.refreshApiUrls.get(e),token:{TokenValue:"",ExpiryMs:c.getDefaultExpiry()},resourceUrl:n},c.accessTokens.set(l,d)),(t=t||d.forceRefresh)||!c.tokenIsValid(d)){var f=function(e,t,n,i,o){c.startCAPFlow(e,t,n,r).then((function(){c.accessTokens.forEach((function(e){e.forceRefresh=!0,e.token.TokenValue="",e.token.HasCAPError=!1,e.token.HasPermanentError=!1,e.token.CAPSubErrorCode=null})),o(!0,!0),c._reauth.next()})).catch(i)},h=0,m=function(t,l){var p=function(e,n,i){var r="string"==typeof e?new N.a(e,i):e;n&&h<c.contextService.sharedContext.accessTokenMaxRetryAttempts?(++h,m(t,l)):u(r)};if(c.useMsaTokenService(e))c.msaTokenService.getAccessTokenResponse(e,i).then((function(e){!e.error&&e.token?(c.refreshToken(d,e.token,e.expiryMs),o(e)):p(e.error,!1)})).catch((function(e){p(e,!1)}));else if(n||(n=d.resourceUrl),n||!c.tokensRequiringResourceUrl.has(e)){var b={responseType:"json",headers:new Map};n&&b.headers.set("X-OfficeHome-ResourceUrl",n);var g=void 0===a?"":"&scope="+a,v=void 0===s||0===s.length?"":"&claims="+s.join("_"),y=null==r?void 0:r.category;c.instrumentedHttp.get("Refresh_Access_Token_Request","Refresh_Access_Token",c.contextService.sharedContext.officeHomeApiRoot+"/"+d.refreshEndpoint+(t?"?bypassCache=true":"?bypassCache=false")+g+v,b,"network-only").instrument((function(i,r){if(r.Action=l?"CAP_Retry":"Regular",r.State=t?"Bypass_Cache":"Regular",r.Consumer=e,r.Retry=h.toString(),n){r.ResourceUrl=new T.d(n);var o=_e.a.referralFromFileLocation(n);!o&&_e.a.isConsumerDocument(n)&&(o="Consumer"),r.DocumentType=o}})).then((function(e){var t=e.data;t&&t.TokenValue?(c.refreshToken(d,t.TokenValue,t.ExpiryMs),l&&c.logCAPDialogEvent("token refresh succeeded",y),o({success:!0,token:t.TokenValue,expiryMs:t.ExpiryMs,format:"JWT",source:"OfficeHome"})):(l&&c.logCAPDialogEvent("token refresh empty token",y),p("Response did not contain valid token",!0))})).catch((function(e){if(c.errorHandler.handleError(e,"SgxOi"),l&&c.logCAPDialogEvent("token refresh failed",y),e){var t=e.data,n=e.status;if(t&&t.HasCAPError){var o=function(){return p("CAP_Error",!1)};i&&c.capabilitiesService.capabilities.capPopupEnabled&&!l&&t.CAPSubErrorCode&&t.ResourceId&&r?f(t.ResourceId,t.Scopes,t.CAPSubErrorCode,o,m):o()}else p("Request failed with error code: "+n,n>=500&&n<600||0===n||707===n||706===n,n)}else p("Request failed",!0)}))}else p("Missing resource url, but is required for <"+e+">.",!1)};if(d.token&&d.token.HasCAPError){var b=function(){return u(new N.a("CAP_Error"))};return void(i&&c.capabilitiesService.capabilities.capPopupEnabled&&d.token.CAPSubErrorCode&&d.token.ResourceId&&r?(c.clientStartupConfigService.config.authType===p.a.OrgId||c.clientStartupConfigService.config.authType===p.a.MSA&&"Graph"===e)&&f(d.token.ResourceId,d.token.Scopes,d.token.CAPSubErrorCode,b,m):b())}if(d.token&&d.token.HasPermanentError)return void u(new N.a("Permanent auth error has been detected; refresh token for <"+e+"> is aborted."));if("SignedIn"!==c.authStateService.getCurrentState())return void u(new N.a("User has to be signed in; refresh token for <"+e+"> is aborted."));if("OfficeHome"===e)return void u(new N.a("Not refreshing OfficeHome token"));m(t||!!d.token.TokenValue,!1)}else o({success:!0,token:d.token.TokenValue,expiryMs:d.token.ExpiryMs,format:"JWT",source:"OfficeHome"})})).catch((function(t){c.errorHandler.handleError(t,"FZWPi"),u(new N.a("Token for <"+e+"> does not have initialization info."))}))})).then((function(e){return d.pending=!1,e})).catch((function(e){throw d.pending=!1,e}));return d.pending=!0,d.result=f,this.pendingRefreshRequests.set(l,d),f},t.prototype.useMsaTokenService=function(e){return this.msaClientTokensEnabled&&this.msaTokenService.supportsToken(e)},t.prototype.getTokenKey=function(e,t,n,i){return void 0===n&&(n=".default"),!t&&this.defaultResourceUrls.has(e)&&(t=this.defaultResourceUrls.get(e)),i&&i.length>0?e+(t?"_"+t:"")+"_"+n+"_"+i.join("_"):e+(t?"_"+t:"")+"_"+n},t.prototype.tokenIsValid=function(e){return e&&e.token&&e.token.TokenValue&&e.token.ExpiryMs>(new Date).getTime()},t.prototype.refreshToken=function(e,t,n){e.token.TokenValue=t,e.token.ExpiryMs=n||this.getDefaultExpiry(),e.forceRefresh=!1},t.prototype.startCAPFlow=function(e,t,n,i){var r=this;return this.pendingInteractiveRequest=new Promise((function(o,a){var s=function(){r.pendingInteractiveRequest=null,o()},c=function(){r.pendingInteractiveRequest=null,a()};r.errorDialogService.showErrorDialog({category:null==i?void 0:i.category,error:r.clientStartupConfigService.config.authType===p.a.MSA?"MSAGraphCapError":"ConditionalAccess",fileType:null==i?void 0:i.fileType,errorInfo:{capErrorCode:n},onActionClicked:function(){return r.openCAPPopup(e,t,null==i?void 0:i.category,s,c)},onClose:c})})),this.pendingInteractiveRequest},t.prototype.openCAPPopup=function(e,t,n,i,r){var s=this,c=this.clientStartupConfigService.config.isV2Auth?encodeURIComponent(this.createResourceWithScopes(e,t)):e,l=this.locService.format(this.contextService.sharedContext.tokenLoginUrlTemplate,c);this.capDialogStartTime=k.a.now();var u=rr(l,this.windowService.nativeWindow);if(!u)return this.logCAPDialogEvent("Could not open popup",n),void r();this.logCAPDialogEvent("Popup opened",n);var d=or(u,this.windowService.nativeWindow,(function(){s.logCAPDialogEvent("Popup closed by user",n),r()}));this.messageResponses.withScope(1).pipe(Object(o.a)((function(e){return!!e&&!!e.capLoginMessage})),Object(a.a)(1)).toPromise().then((function(e){s.windowService.nativeWindow.clearInterval(d),u.close(),s.logCAPDialogEvent(e.capLoginMessage,n),"CAP_LoginComplete"===e.capLoginMessage?i():r()}))},t.prototype.logCAPDialogEvent=function(e,t){var n={};n.ItemCategory=t,n.State=e,n.Latency=Math.ceil(k.a.now()-this.capDialogStartTime).toString(),this.instrumentationService.logGenericEvent("CAP_Popup",n)},t.prototype.getInitializationPromise=function(e,t){return this.useMsaTokenService(e)?Promise.resolve():(n=!this.secondaryTokensEnabled||"OneDrive"!==e&&"SharePoint"!==e&&"Exchange"!==e?this.initializePrimaryTokensPromise:this.initializeSecondaryTokensPromise,t&&this.pendingInteractiveRequest?Promise.all([n,this.pendingInteractiveRequest]).catch().then():n);var n},t.prototype.initializeTokensPromise=function(e,t,n){var i=this;return new Promise((function(r){var s=N.c.NotInitialized,c=function(t){if(s!==N.c.NotInitialized)return!1;if(t&&!document.getElementById(e))return!1;s=N.c.Initializing;var o=i.configParserService.parse(e);return n(o),r(),s=N.c.Initialized,!0};c(!0)||(i.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return e.name===t})),Object(a.a)(1)).toPromise().then((function(){return c(!1)})),X.a.shellAndConfigsReady().then((function(){return c(!1)})))}))},t.prototype.initializePrimaryTokens=function(e){this.initializeAccessToken("BingAnswers","api/refreshBingAnswersToken/v2",e&&e.BingAnswers),this.initializeAccessToken("Graph","api/refreshGraphAccessToken/v2",e&&e.Graph),this.initializeAccessToken("Loki","api/refreshLokiToken/v2",e&&e.Loki),this.initializeAccessToken("MruPlusPlus","api/refreshMruPlusPlusToken/v2",e&&e.Mru),this.initializeAccessToken("OneNote","api/refreshOneNoteToken/v2",e&&e.OneNote),this.initializeAccessToken("Portal","api/refreshPortalToken/v2",e&&e.Portal),this.initializeAccessToken("QueryFormulation","api/refreshQueryFormulationToken/v2",e&&e.QueryFormulation),this.initializeAccessToken("Substrate","api/refreshSubstrateToken/v2",e&&e.Substrate),this.initializeAccessToken("Sway","api/refreshSwayToken/v2",e&&e.Sway),this.initializeAccessToken("Forms","api/refreshFormsToken/v2",e&&e.Forms),this.initializeAccessToken("MyApps","api/refreshMyAppsToken/v2",e&&e.MyApps),this.initializeAccessToken("ConsumerShellService","api/refreshConsumerShellServiceToken/v2",e&&e.ConsumerShellService),this.initializeAccessToken("FluidPushChannel","api/refreshFluidPushChannelToken/v2",e&&e.FluidPushChannel),this.initializeAccessToken("AugLoop","api/refreshAugLoopToken/v2",e&&e.AugLoop),!this.userContextService.user.isGcc&&this.initializeAccessToken("Ods","api/refreshOdsToken/v2",e&&e.Ods),this.initializeAccessToken("TenantFeedback","api/refreshTenantFeedbackToken/v2",e&&e.TenantFeedback),this.initializeAccessToken("Notify","api/refreshNotifyToken/v2",e&&e.Notify),this.initializeAccessToken("Yammer","api/refreshYammerToken/v2",e&&e.Yammer),this.initializeAccessToken("MetaOS","api/refreshMetaOSToken/v2",null),this.initializeAccessToken("MfsService","api/refreshMfsServiceToken/v2",e&&e.MfsService),this.initializeAccessToken("OfficeHome",null,e&&e.OfficeHome)},t.prototype.initializeSecondaryTokens=function(e){this.initializeAccessToken("OneDrive","api/refreshOneDriveToken/v2",e&&e.OneDrive,this.contextService.sharedContext.oneDriveResourceId),this.initializeAccessToken("SharePoint","api/refreshSharePointToken/v2",e&&e.SharePoint,this.contextService.sharedContext.sharePointResourceId),this.initializeAccessToken("Exchange","api/refreshExchangeToken/v2",e&&e.Exchange)},t.prototype.initializeAccessToken=function(e,t,n,i){void 0===i&&(i=""),(n=n||{TokenValue:""}).TokenValue&&!n.ExpiryMs&&(n.ExpiryMs=this.getDefaultExpiry());var r={refreshEndpoint:t,token:n,resourceUrl:i};this.accessTokens.set(this.getTokenKey(e,i),r),t&&this.refreshApiUrls.set(e,t)},Object.defineProperty(t.prototype,"messageResponses",{get:function(){return this._messageResponses.asScopableObservable()},enumerable:!0,configurable:!0}),t.prototype.createResourceWithScopes=function(e,t){return t&&0!==t.length?t.map((function(t){return e+"/"+t})).join(" "):e},t}(N.b),dr=n("xoWf"),pr=n("Dpxn"),fr=n("n826"),hr=n("Brer");function mr(e,t,n){return e.capabilities.useVroomForOneDriveApis?n:t}var br,gr,vr=function(){return function(){}}(),yr=n("fuFU"),Sr=n("Aqby"),wr=new r.q("DISK_PRELOAD_URL_PATTERNS"),Cr=n("aQ3G"),Ir=window.diskPreloadRequestMap,Tr=function(e,t,n,i){var r;if(e.sharedContext.inMockMode)return[{pattern:new RegExp("/mock/v2/recent/docs","i"),markerName:"MRU"},{pattern:new RegExp("/mock/docs/recent","i"),markerName:"MRU"},{pattern:new RegExp("/mock/sites","i"),markerName:"SharePointSites"},{pattern:new RegExp("/mock/recommended/api","i"),markerName:"RecommendedDocs"},{pattern:new RegExp("/mock/(.*)/me/drive/root","i"),markerName:"OneDriveRoot"},{pattern:new RegExp("/mock/PeoplePredictionsB2/api","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("/mock/PeoplePredictionsB2/MicrosoftFeed","i"),markerName:"OfficeFeedV2Docs"}];var o=[],a=!!(null===(r=null==i?void 0:i.capabilities)||void 0===r?void 0:r.edgeworthEnabled);if(t&&t.config){var s=t.config,c=s.substrateApiEndpoint,l=s.officeFeedApiRootPath,u=s.recommendedB2ApiFilesPath,d=s.recommendedB2ApiRootPath;a||o.push({pattern:new RegExp("^"+s.mruServiceRoot+"/v2/recent/docs","i"),markerName:"MRU"}),o.push({pattern:new RegExp("^"+c+"/"+d+"/"+u,"i"),markerName:"RecommendedDocsV1"},{pattern:new RegExp("^"+c+"/"+l+"/(.*)/insights/query\\(context=null,scenario='(.*)',target=null,section='(.*)'\\)","i"),markerName:"OfficeFeedDocs"},{pattern:new RegExp("^"+c+"/PeoplePredictionsB2/MicrosoftFeed\\?section=(.*)&rs=(.*)&forceNewSchema=true","i"),markerName:"OfficeFeedV2Docs"})}return a||(n&&n.config&&o.push({pattern:new RegExp("^"+n.config.sharePointServiceRoot,"i"),markerName:"SharePointSites"}),e&&e.sharedContext&&o.push({pattern:new RegExp("^"+e.sharedContext.graphApiRoot+"/("+Cr.a.graphBeta+"|"+Cr.a.graphV1+")/"+fr.a.myDriveEndpoint+"root$","i"),markerName:"OneDriveRoot"})),o},kr=window.diskPreloadUrlStorageKey,_r=window.diskPreloadUserIdStorageKey,Ar=function(){return function(){}}(),Pr=n("/6za"),Er=n("9h0M");function Or(e){return function(){return br||(br=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){return[2,(t=e.config).tenantId+"_"+t.puid]}))}))}(e)),br}}var Fr,Dr,Rr=function(e,t,n){return n&&function(e,t){if(!Object(Je.t)(t))return!1;try{var n=e.nativeWindow,i=n.navigator;if(!("serviceWorker"in i))return!1;var r=i.serviceWorker;return!(!r.getRegistration||!r.getRegistrations)&&"URL"in n&&URL.prototype.hasOwnProperty("searchParams")}catch(e){return!1}}(e,t)},Mr=function(e,t){return function(){return gr||(gr=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Or(e)()];case 1:return n=i.sent(),[2,t.saltedHash(n)]}}))}))}(e,t)),gr}},xr=function(){return function(){}}(),Lr=n("oHg+"),Ur=function(e,t){return t&&e.config.enabled},Nr=function(){return function(){}}(),jr=n("DTNF"),Wr=n("kMgc"),Br=n("FHrx"),zr=n("COYM"),Vr=function(){function e(e,t,n){this.webCryptoService=e,this.encryptionConfigService=t,this.textEncodingService=n}return e.prototype.saltedHash=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(n){return[2,ie(this.webCryptoService.crypto.subtle,e,this.encryptionConfigService.config.digestSaltBase64,(function(e){return t.textEncodingService.encode(e)}))]}))}))},e.ɵprov=r.cc({factory:function(){return new e(r.dc(zr.b),r.dc(Br.a),r.dc(Wr.a))},token:e,providedIn:"root"}),e}(),Hr=n("OPPn"),qr=n("cZRF"),Gr=function(){function e(e){this.encryptionService=e}return e.prototype.decryptResponse=function(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s,c,l,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if("arraybuffer"===n||"blob"===n)throw this.generateError(Ee.a.NotImplemented,"Unsupported Encrypted Cached Body Type: "+n);i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.encryptionService.decryptData(t)];case 2:return r=i.sent(),[3,4];case 3:throw i.sent(),this.generateError(Ee.a.DecryptionError,"Failed to decrypt response.");case 4:if(o=r.body,a=r.headers,c=r.statusText,l=r.status,!(s=r.requestUrl)||s.toLowerCase()!==e.toLowerCase())throw this.generateError(Ee.a.UnexpectedResponse,"Resource read from cache does not match the resource being used");if(!o)throw this.generateError(Ee.a.EmptyResponse,"Received an empty response from cache. Cannot decrypt.");try{return u="json"===n?JSON.parse(o):o,[2,new Er.l({body:u,headers:new Er.i(JSON.parse(a)),statusText:c,status:l,url:e})]}catch(e){throw this.generateError(Ee.a.UnexpectedResponse,"Failed to parse response")}return[2]}}))}))},e.prototype.generateError=function(e,t){return new Er.f({error:t,status:e,statusText:t})},e}(),Qr=n("Qj1g"),Zr=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.intercept=function(e,t){return this.serviceWorkerEnabled&&"cache-only"===e.headers.get(te.a)?t.handle(e).pipe(Object(Qr.a)((function(e){if(!(e instanceof Er.f))throw e;if(e.status!==Ee.a.Unknown)throw e;throw new Er.f({error:e.error,headers:e.headers,status:Ee.a.CacheMiss,statusText:Ee.a[Ee.a.CacheMiss],url:e.url})}))):t.handle(e)},e}(),Kr=n("pIkI"),Xr=n("ro+v"),Jr=n("NLr0"),Yr=n("JYvP"),$r=n("2dXW"),eo=function(){function e(e,t,n){this.errorHandler=e,this.windowService=t,this.serviceWorkerApiAvailable=n,this._messages=new $r.a,this.initialized=this.initialize()}return e.prototype.waitForTransactionalMessageAndRespond=function(e,t){var n=this;if(e&&t&&this.initialized)return this._messages.pipe(Object(o.a)(e)).subscribe((function(e){t(e).then((function(t){e.ports&&e.ports.length?e.ports[0].postMessage(t):e.source.postMessage(t)})).catch((function(e){n.errorHandler.handleError(e)}))}))},e.prototype.initialize=function(){var e=this;if(!this.serviceWorkerApiAvailable)return!1;try{this.serviceWorkerContainer=this.windowService.nativeWindow.navigator.serviceWorker,this.serviceWorkerContainer.addEventListener("message",(function(t){e._messages.next(t)}))}catch(e){return!1}return!0},e.ɵprov=r.cc({factory:function(){return new e(r.dc(r.m),r.dc(d.b),r.dc(v.a))},token:e,providedIn:"root"}),e}(),to=function(){function e(e,t,n,i,r){this.encryptionService=e,this.serviceWorkerInitiatedMessageService=t,this.serviceWorkerUserIdFactory=n,this.serviceWorkerEnabled=i,this.decryptResponseService=r,this.initialize()}return e.prototype.intercept=function(e,t){var n=this;if(!this.decryptResponseService||"cache-only"!==e.headers.get(te.a))return t.handle(e);var i=e.clone({responseType:"arraybuffer"});return t.handle(i).pipe(Object(Yr.a)((function(t){if(t instanceof Er.l){var i=t,r=new Uint8Array(i.body);if(!r.length)return Object(Kr.a)(n.generateError(Ee.a.UnexpectedResponse,"Received an empty response from cache. Cannot decrypt."));if("application/octet-stream"!==i.headers.get("Content-Type"))return Object(Kr.a)(n.generateError(Ee.a.UnexpectedResponse,"Data is not binary. Cannot decrypt."));var o=void 0;try{o=Object(oe.b)(r)}catch(e){return Object(Kr.a)(n.generateError(Ee.a.DecryptionError,e.message))}return Object(Xr.a)(n.decryptResponseService.decryptResponse(i.url,o,e.responseType))}return Object(Jr.a)(t)})))},e.prototype.initialize=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this.serviceWorkerEnabled?[4,this.serviceWorkerUserIdFactory()]:[2];case 1:return e=n.sent(),this.serviceWorkerInitiatedMessageService.waitForTransactionalMessageAndRespond((function(t){var n=t.data;if(!n||"encrypt"!==n.type||"request"!==n.meta)return!1;var i=n.payload;return i.userId===e&&i.encryptionVersion===oe.a}),(function(e){return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=(t=e.data.payload).requestId,[4,this.encryptionService.encryptData(t.data)];case 1:return r=i.sent(),[2,{type:"encrypt",meta:"response",payload:{requestId:n,encryptedData:r,encryptionVersion:oe.a}}]}}))}))})),[2]}}))}))},e.prototype.generateError=function(e,t){return new Er.f({error:t,status:e,statusText:t})},e}(),no=n("Jcv4"),io=n("2q5z"),ro=new r.q("DISK_PRELOAD_USER_ID_STORAGE_KEY"),oo=new r.q("DISK_PRELOAD_STORAGE_KEY"),ao=new r.q("DISK_PRELOAD_REQUEST_MAP"),so=function(){function e(e,t,n,i,r,o,a,s){this.localStorageService=e,this.userIdStorageKey=t,this.urlPatternStorageKey=n,this.urlPatternEntries=i,this.serviceWorkerUserIdFactory=r,this.diskPreloadRequestMap=o,this.serviceWorkerEnabled=a,this.serviceWorkerConfigService=s,this.diskPreloadEnabled=!0,this.diskPreloadStorageEntries=[],this.initialized=this.init()}return e.prototype.tryAddToPreloadList=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.initialized];case 1:return n.sent(),this.diskPreloadEnabled?(!(t=this.getMarkerName(e))||this.hasUrl(e)||this.updateStorageEntries(Object(i.__spread)(this.diskPreloadStorageEntries,[{url:e,markerName:t}])),[2]):[2]}}))}))},e.prototype.loadPreloadResponse=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.initialized];case 1:return t.sent(),this.diskPreloadEnabled?[2,this.diskPreloadRequestMap.get(e)]:[2,null]}}))}))},e.prototype.init=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(this.initialized)throw new Error("`init()` can only be called once.");return this.serviceWorkerConfigService.config.diskPreloadEnabled&&this.serviceWorkerEnabled?(e=this.localStorageService.getGlobal(this.userIdStorageKey),[4,this.serviceWorkerUserIdFactory()]):(this.diskPreloadEnabled=!1,[2]);case 1:return t=i.sent(),e!==t?(this.diskPreloadEnabled=!1,this.localStorageService.setGlobal(this.userIdStorageKey,t),this.updateStorageEntries([]),[2]):(n=this.localStorageService.getGlobal(this.urlPatternStorageKey))?(this.updateStorageEntries(n.filter((function(e){return!!r.getMarkerName(e.url)}))),[2]):[2]}}))}))},e.prototype.getMarkerName=function(e){try{return this.urlPatternEntries.find((function(t){return t.pattern.test(e)})).markerName}catch(e){return}},e.prototype.hasUrl=function(e){return this.diskPreloadStorageEntries.map((function(e){return e.url})).indexOf(e)>=0},e.prototype.updateStorageEntries=function(e){this.diskPreloadStorageEntries=e,this.localStorageService.setGlobal(this.urlPatternStorageKey,this.diskPreloadStorageEntries)},e.ɵprov=r.cc({factory:function(){return new e(r.dc(Ot.a),r.dc(ro),r.dc(oo),r.dc(wr),r.dc(jr.a),r.dc(ao),r.dc(g.a),r.dc(m.a))},token:e,providedIn:"root"}),e}(),co=function(){function e(e){this.diskPreloadService=e}return e.prototype.intercept=function(e,t){var n=this;return"cache-only"===e.headers.get(te.a)?Object(Xr.a)(this.diskPreloadService.loadPreloadResponse(e.urlWithParams)).pipe(Object(no.a)((function(i){return i?i.ok?Object(Xr.a)(n.convertToAngularHttpResponse(i,e.responseType)):Object(Kr.a)(n.convertToAngularHttpErrorResponse(i)):t.handle(e)}))):t.handle(e).pipe(Object(io.a)((function(t){t instanceof Er.l&&t.ok&&n.diskPreloadService.tryAddToPreloadList(e.urlWithParams)})))},e.prototype.convertToAngularHttpResponse=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:switch(t){case"json":return[3,1];case"text":return[3,3];case"arraybuffer":return[3,5];case"blob":return[3,7]}return[3,9];case 1:return[4,e.json()];case 2:return n=i.sent(),[3,9];case 3:return[4,e.text()];case 4:return n=i.sent(),[3,9];case 5:return[4,e.arrayBuffer()];case 6:return n=i.sent(),[3,9];case 7:return[4,e.blob()];case 8:return n=i.sent(),[3,9];case 9:return[2,new Er.l({body:n,headers:this.convertToAngularHeaders(e.headers),status:e.status,statusText:e.statusText,url:e.url})]}}))}))},e.prototype.convertToAngularHttpErrorResponse=function(e){return new Er.f({error:e.statusText,status:e.status,statusText:e.statusText,headers:this.convertToAngularHeaders(e.headers),url:e.url})},e.prototype.convertToAngularHeaders=function(e){var t=new Er.i;return e.forEach((function(e,n){t=t.append(n,e)})),t},e}(),lo=function(){function e(){}return e.prototype.getLicenses=function(){return null},e}(),uo=n("rBEp"),po=function(){function e(){}return e.prototype.registerRecommendedJumpList=function(){},e.prototype.registerRecentJumpList=function(){},e.prototype.getJumpListItemById=function(){return null},e}(),fo=n("Bc8L"),ho=function(){function e(){}return e.prototype.launchOfficeApp=function(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.launchOfficeAppWithTemplate=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.openPathInExplorer=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.reject()]}))}))},e.prototype.shouldOpenInOfficeApp=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,Promise.resolve(!1)]}))}))},e}(),mo=function(){return function(){}}(),bo=function(){function e(){}return e.prototype.isEligibleToPin=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,new Promise((function(e){return e(!1)}))]}))}))},e.prototype.pinToTaskbar=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return[2,new Promise((function(e){return e(!1)}))]}))}))},e}(),go=n("TIi1"),vo=function(){function e(e,t,n){this.capabilitiesService=e,this.contextService=t,this.windowService=n}return e.prototype.openUrl=function(e,t,r,o,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(i){return this.capabilitiesService.capabilities.contentLauncherEnabled?(Promise.all([n.e(0),n.e(1),n.e(2)]).then(n.bind(null,"DZQ9")).then((function(n){n.launchUrl(e,{action:t,linkTarget:r})})),[2,Promise.resolve()]):(this.windowService.nativeWindow.open(e,r||this.contextService.sharedContext.defaultLinkTarget,"number"==typeof o&&"number"==typeof a?"width="+o+",height="+a:""),[2,Promise.resolve()])}))}))},e.prototype.supportsProtocol=function(e){return Promise.reject("Method not implemented.")},e.ɵprov=r.cc({factory:function(){return new e(r.dc(K.a),r.dc(B.a),r.dc(d.b))},token:e,providedIn:"root"}),e}(),yo=n("enhM"),So=n("Ionu"),wo=n("GWL1"),Co=n("H90i"),Io=n("ZBli"),To=function(e){function t(t,n,r,o,a,s,c,l,u,d,p){var f=e.call(this)||this;return f.appTilesConfigService=t,f.capabilitiesService=n,f.configParserService=r,f.contextService=o,f.dateService=a,f.globalErrorHandler=s,f.startupConfigService=c,f.userDataStorageService=l,f.scheduler=u,f.shellShimService=d,f.officeStartBootstrapperService=p,f.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled&&(f.context=f.officeStartBootstrapperService.bootstrapOfficeStart()),f.nativeWorkloads=new Array,f.allWorkloads=f.configParserService.parse("workloadsData")||{nonCoreAndSegmentApps:[],coreAndSegmentApps:[],pinnedApps:[]},f.shellPinEnabled=f.capabilitiesService.capabilities.shellPinEnabled,f.allWorkloads.pinnedApps&&f.populateWorkloadFields(f.allWorkloads.pinnedApps),f.allWorkloads.coreAndSegmentApps=f.allWorkloads.coreAndSegmentApps.filter((function(e){return f.filterLocalOnlyApps(e)})),f.usedThirdPartyWorkloads=[],f.thirdPartyWorkloads=[],f.thirdPartyWorkloadsSubject=new Pn.a([]),f.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled?f.subscribeToThirdPartyAppUpdates().then((function(){var e=f.thirdPartyWorkloads.map((function(e){return Object(i.__assign)(Object(i.__assign)({},e),{id:e.Id})}));Object(yo.a)(e,f.context).then((function(){return Object(So.a)(f.context)}))})):(f.subscribeToThirdPartyAppUpdates(),f.getWorkloads().then((function(e){f.usedThirdPartyWorkloads=e.filter((function(e){return e.IsThirdParty})),f.cleanUnusedThirdPartyWorkloads()}))),f}return Object(i.__extends)(t,e),t.prototype.getProvisionedWorkloads=function(){var e=this;return new Promise((function(t,n){e.getWorkloads().then((function(e){var n=e.filter((function(e){return!!e.Url}));n.forEach((function(e){e.IsThirdParty||(e.AppId=e.Id.slice(5),e.CollectorId="FirstParty")})),t(n)})).catch((function(t){e.globalErrorHandler.handleError(t,"Dnsgi"),n("Failed to get workloads list")}))}))},t.prototype.getCoreSegmentAndFrequentApps=function(){var e=this;return this.coreSegmentAndOtherAppsPromise||(this.coreSegmentAndOtherAppsPromise=new Promise((function(t){var n=e.allWorkloads,i=e.getFrequentAppsWithAnyClicks(n.nonCoreAndSegmentApps),r=n.coreAndSegmentApps.concat(i);e.populateWorkloadFields(r),e.startupConfigService.config.authType===p.a.MSA?e.getMsaWorkloadsData(r).then(t):t(r)}))),this.coreSegmentAndOtherAppsPromise.then((function(e){return Object(i.__spread)(e)}))},t.prototype.getPinnedWorkloads=function(){return this.allWorkloads.pinnedApps},t.prototype.unpinWorkload=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this.allWorkloads.pinnedApps=this.allWorkloads.pinnedApps.filter((function(t){return!(t.AppId===e.AppId&&t.CollectorId===e.CollectorId)})),[4,this.shellShimService.getShellShim()];case 1:return(t=n.sent())&&t.Apps.Unpin(e.CollectorId,e.AppId),[2]}}))}))},t.prototype.getWorkloads=function(){var e=this;return this.workloadsPromise||(this.workloadsPromise=new Promise((function(t){var n,i=e.allWorkloads;n=i.coreAndSegmentApps.concat(i.nonCoreAndSegmentApps),e.populateWorkloadFields(n),e.startupConfigService.config.authType===p.a.MSA?e.getMsaWorkloadsData(n).then(t):t(n)}))),this.workloadsPromise.then((function(e){return Object(i.__spread)(e)}))},t.prototype.getWorkloadId=function(e){return t.fileTypeToIdMap.has(e)?t.fileTypeToIdMap.get(e):""},t.prototype.getReferralType=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.ClickCount?e.LastOccurrence<t.getTime()?T.c.ResurrectedReferral:e.LastOccurrence>=t.getTime()?T.c.RepeatReferral:T.c.NotDetected:T.c.FirsttimeReferral},t.prototype.getDisplayedApps=function(e){var t,n,r,o,a,s,c=this.appTilesConfigService.config,l=c.coreAppIds&&c.segmentSpecificAppIds?c.coreAppIds.concat(c.segmentSpecificAppIds):c.coreAppIds||c.segmentSpecificAppIds,u=new Array;if(l&&l.length){var d=e.filter((function(e){return l.indexOf(e.Id)>-1})),p=e.filter((function(e){return l.indexOf(e.Id)<0})),f=c.coreAppIds?e.filter((function(e){return c.coreAppIds.indexOf(e.Id)>-1})):[];if(!d.length||!p.length||f.length<3)try{for(var h=Object(i.__values)(e),m=h.next();!m.done;m=h.next())u.push(m.value.Id)}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}else{var b=this.getFrequentAppsWithAnyClicks(p);try{for(var g=Object(i.__values)(d),v=g.next();!v.done;v=g.next())u.push(v.value.Id)}catch(e){r={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}if(b.length)try{for(var y=Object(i.__values)(b),S=y.next();!S.done;S=y.next())u.push(S.value.Id)}catch(e){a={error:e}}finally{try{S&&!S.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}}return u.toString()}},t.prototype.getFrequentAppsWithAnyClicks=function(e){var t=this.dateService.addDays(this.dateService.getCurrentDate(),-45);return e.filter((function(e){return e.ClickCount>0&&e.LastOccurrence>=t.getTime()}))},t.prototype.getThirdPartyWorkloads=function(){return this.thirdPartyWorkloadsSubject.asObservable()},t.prototype.updateUsedThirdPartyApps=function(e){if(this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled){var t=Object(i.__assign)(Object(i.__assign)({},e),{id:e.Id});Object(wo.d)(t,this.context)}else{var n=this.usedThirdPartyWorkloads.findIndex((function(t){return t.Id.toLowerCase()===e.Id.toLowerCase()})),r=n>=0?this.usedThirdPartyWorkloads[n]:void 0;r?this.areThirdPartyAppsEqual(r,e)||(this.usedThirdPartyWorkloads[n]=e,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)):(this.usedThirdPartyWorkloads.push(e),this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}},t.prototype.populateWorkloadFields=function(e){var n=this;e.forEach((function(e){e.getId=function(){return e.Id},e.Referral=e.IsThirdParty?e.Id:t.referralFromWorkloadId(e.Id),e.FileType=n.getFileType(e.Id),e.Url=n.getWorkloadCustomUrl(e.FileType,e.Url)}))},t.prototype.getAdditionalWorkloads=function(){return Promise.resolve([])},t.prototype.pinWorkload=function(e){this.shellPinEnabled&&this.shellShimService.getShellShim().then((function(t){var n=e.AppId,i=e.CollectorId;i&&n&&!t.Apps.IsPinned(i,n)&&t.Apps.Pin(i,n)}))},t.prototype.getInAppNav=function(e){var t=this.allWorkloads.coreAndSegmentApps.concat(this.allWorkloads.nonCoreAndSegmentApps).concat(this.allWorkloads.pinnedApps).find((function(t){return t.Id===e}));return!!t&&t.InAppNav},t.prototype.getFileType=function(e){return t.idToFileTypeMap.has(e)?t.idToFileTypeMap.get(e):_e.b.Unknown},t.prototype.getMsaWorkloadsData=function(e){var t=this;return this.getShellWorkloadsData().then((function(n){return t.populateMSAWorkloadFields(e,n),e}))},t.referralFromWorkloadId=function(e){return e&&e.length&&0===e.lastIndexOf(t.AppTileElementIdPrefix,t.AppTileElementIdPrefixLength)?e.substring(t.AppTileElementIdPrefixLength):null},t.prototype.filterLocalOnlyApps=function(e){return!e.IsNativeClientOnlyApp||(this.nativeWorkloads.push(e),!1)},t.prototype.populateMSAWorkloadFields=function(e,t){var n=this;e.forEach((function(e){for(var i=e.Id.toLowerCase(),r=0;r<t.length;r++){var o=t[r];if(o.Id.toLowerCase()===i){e.Color=o.BackgroundColor,e.FileType=n.getFileType(e.Id),e.Url&&(e.Url=n.getWorkloadCustomUrl(e.FileType,o.LaunchUrl));break}}}))},t.prototype.getWorkloadCustomUrl=function(e,t){switch(e){case _e.b.Forms:t=Io.a.appendAndReplaceQueryParams(t,{origin:Co.a,lang:this.contextService.sharedContext.officeMarket,sessionId:this.startupConfigService.config.sharedClientStartupContext.sessionId},!1,!0)}return t},t.prototype.getShellWorkloadsData=function(){var e=this;return new Promise((function(t,n){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return(e=i.sent())?e.Apps.OnAppsUpdated((function(e){if(e&&e.Apps){var i=e.Apps.map((function(e){return{BackgroundColor:e.BackgroundColor,FontIconCss:e.FontIconCss,Id:e.Id,LaunchUrl:e.LaunchFullUrl}}));t(i)}else n("Shell shim apps not available.")})):n("Shell shim is not available"),[2]}}))}))}))},t.prototype.subscribeToThirdPartyAppUpdates=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.shellShimService.getShellShim()];case 1:return e=r.sent(),[4,this.shellShimService.afterShellPlusLoaded];case 2:return r.sent(),[4,new Promise((function(r){var o=0,a=0,s=!1;e.Apps.OnAppsUpdated((function(c){if(c&&c.Apps){var l=c.Apps.filter((function(e){return"FirstParty"!==e.CollectorId&&!n.thirdPartyWorkloads.find((function(t){return t.Id===e.Id}))}));l=l.filter((function(e){return"LineOfBusiness"!==e.CollectorId})),n.capabilitiesService.capabilities.showBusinessApps||(l=l.filter((function(e){return"Dynamics"!==e.CollectorId}))),l.forEach((function(t){var c=t.LaunchFullUrl;n.thirdPartyWorkloads.push({ChangeColorInDarkMode:"Dynamics"===t.CollectorId,Color:t.BackgroundColor,Id:t.Id,AppId:t.Id,CollectorId:t.CollectorId,Title:t.AriaLabel?t.AriaLabel:"",SubText:t.Subtitle,Text:t.Title,IsNativeClientOnlyApp:t.isNativeClientOnlyApp,Url:c?c.trim():"",IconUnicodeCodepointCssClass:"ms-fcl-tp ms-Icon ms-Icon--OfficeAddinsLogo",ThirdPartyIcon:t.IconAnonymousUrl?t.IconAnonymousUrl:null,Referral:t.Id,IsThirdParty:!0,getId:function(){return t.Id}}),t.IconAnonymousUrl||(++o,n.scheduler.scheduleWork((function(){e.Apps.GetAuthenticatedAppIcon(t,(function(e){if(++a,e){var c=n.thirdPartyWorkloads.findIndex((function(e){return e.Id.toLowerCase()===t.Id.toLowerCase()})),l=n.thirdPartyWorkloads[c];n.thirdPartyWorkloads[c]=Object(i.__assign)(Object(i.__assign)({},l),{ThirdPartyIcon:"data:"+e.MimeType+";base64,"+e.Base64EncodedImage}),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads)}s&&o===a&&r()}))}),3))})),n.thirdPartyWorkloadsSubject.next(n.thirdPartyWorkloads),(s=c.DataSource===t.AppsShimDataSourceAppCollectors||c.DataSource===t.AppsShimDataSourceShellDataComplete)&&o===a&&r()}}))}))];case 3:return r.sent(),this.capabilitiesService.capabilities.officeStartUsedThirdPartyAppsEnabled||this.invalidateThirdPartyAppCache(),[2]}}))}))},t.prototype.cleanUnusedThirdPartyWorkloads=function(){if(0!==this.usedThirdPartyWorkloads.length){var e=this.dateService.addDays(this.dateService.getCurrentDate(),-45).getTime(),t=this.usedThirdPartyWorkloads.length;this.usedThirdPartyWorkloads=this.usedThirdPartyWorkloads.filter((function(t){return t.LastOccurrence>=e})),t!==this.usedThirdPartyWorkloads.length&&this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads)}},t.prototype.areThirdPartyAppsEqual=function(e,t){return e.Text===t.Text&&e.Url===t.Url&&e.ThirdPartyIcon===t.ThirdPartyIcon&&e.Title===t.Title},t.prototype.invalidateThirdPartyAppCache=function(){var e=this;if(0!==this.usedThirdPartyWorkloads.length){var t=[],n=!1;this.usedThirdPartyWorkloads.forEach((function(i){var r=e.thirdPartyWorkloads.find((function(e){return e.Id===i.Id}));r?e.areThirdPartyAppsEqual(r,i)?t.push(r):(t.push(r),n=!0):n=!0})),n&&(this.usedThirdPartyWorkloads=t,this.userDataStorageService.set("UsedThirdPartyApps",this.usedThirdPartyWorkloads))}},t.AppTileElementIdPrefixLength=(t.AppTileElementIdPrefix="Shell").length,t.AppsShimDataSourceAppCollectors=3,t.AppsShimDataSourceShellDataComplete=4,t.idToFileTypeMap=new Map([["ShellWordOnline",_e.b.Word],["ShellExcelOnline",_e.b.Excel],["ShellPowerPointOnline",_e.b.PowerPoint],["ShellOneNoteOnline",_e.b.OneNote],["ShellClassNotebook",_e.b.OneNoteClassNoteBook],["ShellVisioOnline",_e.b.Visio],["ShellSway",_e.b.Sway],["ShellOfficeForms",_e.b.Forms],["ShellDocuments",_e.b.OneDrive],["ShellSites",_e.b.SharePoint],["ShellMicrosoftStream",_e.b.Stream]]),t.fileTypeToIdMap=new Map([[_e.b.Word,"ShellWordOnline"],[_e.b.Excel,"ShellExcelOnline"],[_e.b.PowerPoint,"ShellPowerPointOnline"],[_e.b.OneNote,"ShellOneNoteOnline"],[_e.b.Visio,"ShellVisioOnline"],[_e.b.Sway,"ShellSway"],[_e.b.Forms,"ShellOfficeForms"],[_e.b.OneDrive,"ShellSway"],[_e.b.SharePoint,"ShellOfficeForms"],[_e.b.Stream,"ShellMicrosoftStream"]]),t}(ut.a),ko=n("Xc4i"),_o=n("UWom"),Ao=n("SQAW");!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Fr||(Fr={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(Dr||(Dr={}));var Po=n("idgT"),Eo=n("IBRu"),Oo=n("y9oG"),Fo=function(e){function t(t,n,i,r,o,a,s,c){var l=e.call(this,t,n,i,"Graph",r,o,a,c)||this;return l.globalErrorHandler=s,l.requestConfig={headers:new Map([["content-type","application/x-www-form-urlencoded"]])},l}return Object(i.__extends)(t,e),t.prototype.postPreboot=function(t,n,i,r){var o=this;return new Promise((function(a,s){e.prototype.post.call(o,t,n,i,r,(function(e){e.instrument((function(e,t){t.RequestId=o.getRequestIdFromResponse(e)})).then((function(){return a(null)}))}),(function(e){s(e)}),o.requestConfig,void 0,void 0,void 0,void 0,"None")}))},t.ɵprov=r.cc({factory:function(){return new t(r.dc(N.b),r.dc(T.a),r.dc(W.a),r.dc(B.a),r.dc(u.a),r.dc(Je.q),r.dc(c.b),r.dc(Oe.a))},token:t,providedIn:"root"}),t}(n("pOWU").a),Do=function(e){function t(t,n,i,r,o,a,s,c,l,u,d){var p=e.call(this,t,n,i,r,o,a,s,c)||this;return p.webPwaService=l,p.windowService=u,p.wacPrebootService=d,p.prebootedApplications=new Map,p.bootstrappedDocuments=new Map,p.prebootedDocuments=new Map,p.prebootedWopiFetchData=new Map,p.prebootedSessionId=new Map,p.webPwaService.isStandalone.subscribe((function(e){p.isStandalone=e,p.uihit=p.getUihit(e),p.uih="officecom"+p.uihit})),p}return Object(i.__extends)(t,e),t.prototype.prebootDocument=function(e){var t=this;if(e.driveId&&e.docId&&!this.prebootedDocuments.has(this.getPrebootKey(e))){var n=this.getWopiData(e,!1,!1,!0);n.then((function(i){var r=He.a.createGuid(),o=t.index++,a=t.getPrebootKey(e);t.prebootedDocuments.set(a,o),t.prebootedWopiFetchData.set(a,n),t.prebootedSessionId.set(a,r);var s="access_token="+encodeURIComponent(i.wopiHostData.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(i.wopiHostData.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(i.wopiHostData.bundleUrl)+"&fileExtension="+encodeURIComponent(_e.a.getFileExtension(i.wopiHostData.fileName))+"&user_id="+encodeURIComponent(i.wopiHostData.wac.userId);t.wacPrebootService.postPreboot("WacDocument_Preboot","WacDocument_Preboot",t.getPrebootUrl(i.wopiHostData.wac.applicationUrl)+"?op=preboot&usid="+encodeURI(r),s)}))}},t.prototype.bootstrapItem=function(e,t,n){var r,o,a,s=this;this.prebootedApplications.clear();var c=!1;if(this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e.fileType)&&e.driveId&&e.docId){var l=this.getPrebootKey(e);o=this.prebootedDocuments.get(l),r=this.prebootedWopiFetchData.get(l),a=this.prebootedSessionId.get(l),(c=Number.isInteger(o))&&(this.prebootedDocuments.delete(l),this.prebootedSessionId.delete(l))}var u=Object(i.__read)(this.generateCorrelationAndBootId(o),2),d=u[0],p=u[1];this.logPerformanceBootStart(p,d,e.wdOrigin,e.fileType);var f=new _o.a;this.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_Start",e.fileType);var h=null!=r?r:n||this.getWopiData(e,!1,!1,!0);h.then((function(n){s.logPerformanceEventFromClick(p,"WacContent_Document_Wopi_Fetch_End",e.fileType),s.bootstrapFile(f,p,e,n.wopiHostData,d,t,n.fetchDiagnostics,!0,c?a:void 0)})).catch((function(e){s.sendBootError("WacDocument_Vroom_Error",e,f)}));var m=e.fileName,b={correlationId:d,bootstrapperObservable:f.asObservable(),fileNamePromise:m?Promise.resolve(_e.a.fileNameWithoutExtension(m)):h.then((function(e){return _e.a.fileNameWithoutExtension(e.wopiHostData.fileName)})),documentIdentifierPromise:h.then((function(e){return e.fetchedDocumentInfo}))},g={correlationId:d,bootedDocumentInfo:{bootId:p,documentInfo:e},data:b};return this.bootstrappedDocuments.set(p,g),g},t.prototype.bootstrapZeroByteDocument=function(e,t,n,r,o){var a=this,s=this.prebootedApplications.get(e.fileType);Date.now()>(null==s?void 0:s.expirationTime)&&(s=void 0,this.prebootedApplications.clear());var c=Object(i.__read)(s?s.correlationAndBoot:this.generateCorrelationAndBootId(),2),l=c[0],u=c[1];this.logPerformanceBootStart(u,l,e.wdOrigin,e.fileType);var d=s?s.loadFunctionSubject:new _o.a,p=n.then((function(t){return a.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_Start",e.fileType),a.getWopiData(t,!0,!1,!0)}));p.then((function(n){return Object(i.__awaiter)(a,void 0,void 0,(function(){var a,c;return Object(i.__generator)(this,(function(p){switch(p.label){case 0:return this.logPerformanceEventFromClick(u,"WacContent_Document_Wopi_Fetch_End",e.fileType),[4,n.fetchedDocumentInfo];case 1:return a=p.sent(),c=o?Object(i.__assign)(Object(i.__assign)({},a.applicationUrlParams),{templateItemId:r,templateDriveId:o}):r?Object(i.__assign)(Object(i.__assign)({},a.applicationUrlParams),{wdTpl:r}):a.applicationUrlParams,s?s.finishLoad(n.wopiHostData,a.newFileInfo):this.bootstrapFile(d,u,Object(i.__assign)(Object(i.__assign)({},a),{applicationUrlParams:c}),n.wopiHostData,l,t,Object(i.__assign)(Object(i.__assign)({},n.fetchDiagnostics),{endTime:Date.now()})),[2]}}))}))})).catch((function(e){a.sendBootError("WacDocument_Vroom_Error",e,d)}));var f=p.then((function(e){return e.fetchedDocumentInfo})),h={bootstrapperObservable:d.asObservable(),fileNamePromise:f.then((function(e){return _e.a.fileNameWithoutExtension(e.fileName)})),documentIdentifierPromise:f},m={bootId:u,documentInfo:Object(i.__assign)(Object(i.__assign)({},e),{newFile:!0,templateId:r})},b={correlationId:l,bootedDocumentInfo:m,data:h};return this.bootstrappedDocuments.set(u,b),s&&this.prebootedApplications.clear(),b},t.prototype.bootstrapApplication=function(e,t){var n=this;if(this.capabilitiesService.capabilities.wacHostPrebootApps.has(e)&&!this.prebootedApplications.has(e)){var r=Object(i.__read)(this.getOfficeBootstrapper(e),2),o=r[0];if(o&&!r[1]){var a=Object(i.__read)(this.generateCorrelationAndBootId(),2),s=a[0],c=a[1],l=new _o.a,u=Object(i.__read)(Object(Eo.a)(),3),d=u[0],p=u[1],f=u[2];l.next((function(r){var a=r.container,s=r.flushTime,l=r.loadCorrelationId;return new Ao.a((function(r){var u=n.getInitParams(e,l,t,a.nativeElement,s,s,(function(t){return Object(i.__awaiter)(n,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return this.logPerformanceEventFromClick(c,"WacContent_Document_Load_End",e),[4,d];case 1:return n=i.__read.apply(void 0,[o.sent(),1]),r.next({wopiHostData:n[0],officeApplication:t}),r.complete(),[2]}}))}))}),(function(e){n.sendBootError("WacDocument_JsApi_Error",e,r)}),void 0,void 0,void 0,void 0,void 0,{wdasp:1});n.logPerformanceEventFromClick(c,"WacContent_Document_InitializeWopiPending",e);var p=o.Application.InitializeWopiPending(u);p?d.then((function(e){var t=Object(i.__read)(e,2),r=t[1],o=n.getWopiInfo(t[0].wac);p.Complete(o,r)})).catch((function(){})):n.sendBootError("Initialize_Wopi_Pending_Failed",fail,r)}))})),l.complete();var h=f,m={bootstrapperObservable:l.asObservable(),fileNamePromise:d.then((function(e){return Object(i.__read)(e,1)[0].fileName}))},b={finishLoad:function(e,t){return p([e,t])},cancelLoad:h,loadData:{correlationId:s,bootedDocumentInfo:{bootId:c,documentInfo:{fileType:e,wdOrigin:t}},data:m},loadFunctionSubject:l,expirationTime:Date.now()+this.contextService.sharedContext.wacHostAppPrebootTimeout,correlationAndBoot:[s,c]};return this.prebootedApplications.set(e,b),b}}},t.prototype.bootstrapFile=function(e,t,n,r,o,a,s,c,l){var u=this;void 0===c&&(c=!0);var d=n.fileType,p=null==r?void 0:r.wac,f=0;try{f=(null==p?void 0:p.accessTokenExpiry)?parseInt(p.accessTokenExpiry):0}catch(e){}if(!(null==p?void 0:p.bootstrapperUrl)||f<Date.now())c?this.getWopiData(n,n.newFile,!0).then((function(i){i?u.bootstrapFile(e,t,n,i.wopiHostData,o,a,i.fetchDiagnostics,!1):u.sendBootError("WacDocument_Generic_Boot_Error","Error occurred while trying to fetch wopi data",e)})).catch((function(t){u.sendBootError("WacDocument_Vroom_Error",t,e)})):this.sendBootError("WacDocument_Vroom_Error","Failed to get wopi data for the item",e);else{var h=r.wac.bootstrapperUrl,m=r.wac.applicationUrl;this.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_Start",d),this.loadBootstrapper(h,m,d).then((function(){var c=Object(i.__read)(u.getOfficeBootstrapper(d),2),p=c[0],f=c[1];if(f)u.sendBootError("WacHost_Bootstrapper_Load_Error",f,e);else{u.logPerformanceEventFromClick(t,"WacContent_Document_Bootstrapper_Load_End",d);var m=u.getWopiInfo(r.wac);e.next((function(e){var i=e.container,c=e.flushTime,f=e.loadCorrelationId;return new Ao.a((function(e){var b=setTimeout((function(){u.logError(o,n,"WacDocument_JsApi_Timeout")}),15e4),g=u.getInitParams(n.fileType,f,n.wdOrigin,i.nativeElement,o!==f?c:a,c,(function(i,s){clearTimeout(b),u.logPerformanceEventFromClick(t,"WacContent_Document_Load_End",d),u.logBootPerformance(o,n,s,a),e.next({wopiHostData:r,officeApplication:i}),e.complete()}),(function(t){clearTimeout(b),u.sendBootError("WacDocument_JsApi_Error",t,e)}),n.docId,r,m,h,s,n.applicationUrlParams,n.rebootOverrideData);u.logPerformanceEventFromClick(t,"WacContent_Document_InitializeWopiPending",d);var v=p.Application.InitializeWopiPending(g,void 0,l);v?v.Complete(m):u.sendBootError("Initialize_Wopi_Pending_Failed",fail,e)}))})),e.complete()}})).catch((function(){u.sendBootError("WacHost_Bootstrapper_Load_Error","Failed to load the bootstrapper",e)}))}},t.prototype.getOfficeBootstrapper=function(e){var t=this.windowService.nativeWindow.Microsoft;if(void 0===t)return[null,"Microsoft is undefined"];var n=t.Office,i=_e.b[e];return n&&n[i]?[n[i],null]:[null,"Failed to find bootstrapper for app: "+i]},t.prototype.getSessionContext=function(){return{pmo:this.windowService.nativeWindow.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:this.windowService.nativeWindow.location.href}},t.prototype.getSessionInformation=function(e,t,n){void 0===n&&(n={});var i=this.contextService.sharedContext.officeMarket,r=this.capabilitiesService.capabilities;return{HostName:"office.com",HostSessionId:t,UserId:e,OwnerId:void 0,UiLocale:i,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:n,DisableFocusOnBoot:!1,SessionContext:JSON.stringify(this.getSessionContext()),HideHeader:this.capabilitiesService.capabilities.isEmbedMode,SupportsDocReboot:Fr.AnyDoc|Fr.OtherMode,SupportsCreateNewDocument:!0,SupportsAuthToken:r.wacHostGetAuthTokenEnabled,UiHostIntegrationType:this.uihit,SupportsAtMentions:!0,SupportsCustomAuthConfig:r.wacHostGetCustomAuthConfigEnabled,SupportsExcelExternalLinks:r.wacHostExternalLinkEnabled,SupportsMoveToFolder:r.wacHostMoveToFolderEnabled}},t.prototype.getOrCreateDefaultPrecheckInfo=function(e,t){var n,r;return e?Object(i.__assign)({FileName:e.fileName,FileGetUrl:e.downloadUrl||e.wac.fileGetUrl,FileSize:e.fileSize,BundleInfo:{Url:e.bundleUrl,MajorVersion:e.bundleVersion},ReadOnly:null!==(n=e.readOnly)&&void 0!==n&&n,IrmEnabled:null!==(r=e.irmEnabled)&&void 0!==r&&r,ETag:e.eTag,ClientThrottlingProtection:e.wac.clientThrottlingProtection,RequestedCallThrottling:e.wac.requestedCallThrottling,IsNewFile:e.isNewFile},t&&{DocUniqueId:t}):{FileName:""}},t.prototype.getWopiInfo=function(e){return{WopiSrc:e.wopiSrc,AccessToken:e.accessToken,AccessTokenExpiry:new Date(parseInt(e.accessTokenExpiry))}},t.prototype.getDiagnostics=function(e,t,n,i,r){void 0===i&&(i={startTime:0,endTime:0});var o=r?this.bootstrapperDiagnostics.get(r):{startTime:0,endTime:0},a=Math.max(this.performanceService.navigationStart,e),s=Math.max(i.startTime?i.startTime:0,a),c=Math.max(i.endTime?i.endTime:0,s),l=Math.max(t,c),u=Math.max(o?o.startTime:0,l);return{entryPoint:n,userClickTime:e,hostPageNavigationStartTime:a,hostPageFetchStartTime:s,hostPageFetchEndTime:c,hostPageFirstFlushTime:l,officeBootstrapperStartTime:u,officeBootstrapperEndTime:Math.max(o?o.endTime:0,u),officeInitializationTime:Date.now()}},t.prototype.getInitParams=function(e,t,n,r,o,a,s,c,l,u,d,p,f,h,m){var b=this.applicationUrls.get(e),g=b.bootstrapperUrl,v=u?u.wac.applicationUrl||u.wac.editUrl:Io.a.removeQueryParams(b.applicationUrl,["wopisrc"],!1),y=Object(i.__assign)(Object(i.__assign)({},h),{uiEmbed:1,uih:this.uih}),S=Io.a.appendQueryParams(v,y),w={},C=this.capabilitiesService.capabilities.scenarioId;return C&&(w.wdscenarioId=C),Object(i.__assign)({BootstrapperUrl:p||g,Container:r,SessionInformation:this.getSessionInformation(u?u.wac.userId:this.clientStartupConfigService.config.puid,t,w),ApplicationUrl:S,WopiPrecheckInfo:this.getOrCreateDefaultPrecheckInfo(u,l),ApplicationCustomSettings:{HostUIControls:[{id:"close",visibility:0},{id:"share",visibility:1}]},Diagnostics:this.getDiagnostics(o,a,n,f,g),FnOnInitializeSuccess:s,FnOnInitializeFailure:c,FnIsFeatureEnabled:this.createIsFeatureEnabledCallback(e),RebootOverrideData:m},d?{WopiInfo:d}:{})},t.prototype.createIsFeatureEnabledCallback=function(e){var t=this;return function(n){switch(n){case"OfficeComUiHost":return!t.isStandalone&&!t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeHwaUiHost":return t.capabilitiesService.capabilities.isPwaInUwp;case"OfficeComPreboot":return!(!t.capabilitiesService.wacHostEnabledForFileType(e)||!t.capabilitiesService.wacHostHoverPrebootEnabledForFileType(e))||!t.capabilitiesService.capabilities.wacHostHoverPrebootControlFlight&&void 0;default:return}}},t.prototype.logError=function(e,t,n,i){var r,o=((r={}).Error=i,r);this.instrumentationService.logErrorEvent(n,Object(Oo.a)(e,t,o))},t.prototype.sendBootError=function(e,t,n){n.error({instrumentationEvent:e,error:t})},t.prototype.getUihit=function(e){return void 0===e&&(e=!1),this.capabilitiesService.capabilities.isPwaInUwp?t.uihitOfficeComHwa:e?t.uihitOfficeComPwa:""},t.prototype.getPrebootUrl=function(e){if(!e)return null;var t=dt.a.getLocation(e),n=t.path.substring(0,t.path.lastIndexOf("/"))+"/preboot.ashx";return dt.a.getOrigin(e)+n},t.prototype.getPrebootKey=function(e){return e.driveId+"_"+e.docId},t.uihitOfficeComPwa="pwa",t.uihitOfficeComHwa="hwa",t}(ko.a),Ro=function(e){function t(t,n,i,r,o,a,s){var c=e.call(this,o)||this;return c.errorHandler=t,c.contextService=n,c.serviceWorkerEnabled=i,c.serviceWorkerUserIdFactory=r,c.officeHomeApiConfigService=a,c.clientStartupConfigService=s,c.messageSent=!1,c}return Object(i.__extends)(t,e),t.prototype.handleRegistration=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(i.__generator)(this,(function(i){if(!this.serviceWorkerEnabled)return[2];try{t=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,n=function(){e.addEventListener("updatefound",(function(){r.postAuthorizedInstallMessage(e.installing)}))},e.installing?(this.postAuthorizedInstallMessage(e.installing),t&&n()):n()}catch(e){this.errorHandler.handleError(e,"OGBGO")}return[2]}))}))},t.prototype.postAuthorizedInstallMessage=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.messageSent?[2]:(n={token:null},[4,this.serviceWorkerUserIdFactory()]);case 1:return n.userId=i.sent(),n.apiPath="api/shellandconfigdata",n.apiHeaders=((r={})[this.officeHomeApiConfigService.config.userIdHeader]=this.clientStartupConfigService.config.puid,r),t=n,this.contextService.sharedContext.inMockMode&&(this.addParamFromWindow(t,"mockauth"),this.addParamFromWindow(t,"envType")),this.addParamFromWindow(t,"flight"),e.postMessage({type:"OFFICECOM_AUTH_WARMUP",meta:"installation-credentials",payload:t}),this.messageSent=!0,[2]}}))}))},t}(function(){function e(e){this.windowService=e}return e.prototype.addParamFromWindow=function(e,t){var n,i=new URL(this.windowService.nativeWindow.location.href).searchParams.get(t);i&&(e.apiQsParams?e.apiQsParams[t]=i:e.apiQsParams=((n={})[t]=i,n))},e}()),Mo=function(){function e(e){this.serviceWorkerEnabled=e}return e.prototype.handleRegistration=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.serviceWorkerEnabled?[3,2]:[4,e.unregister()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e}(),xo=function(){function e(e,t){this.windowService=e,this.serviceWorkerApiAvailable=t}return e.prototype.sendTransactionalMessage=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable&&"undefined"!=typeof MessageChannel?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)?[2,new Promise((function(n){var i=new MessageChannel;i.port1.onmessage=function(e){n(e),i.port1.close(),i.port2.close()},t.postMessage(e,[i.port2])}))]:[2]}}))}))},e.prototype.sendUnidirectionMessage=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return this.serviceWorkerApiAvailable?(n=t)?[3,2]:[4,this.getServiceWorker()]:[2];case 1:n=i.sent(),i.label=2;case 2:return(t=n)&&t.postMessage(e),[2]}}))}))},e.prototype.getServiceWorker=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.windowService.nativeWindow.navigator.serviceWorker.ready];case 1:return[2,e.sent().active];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))},e.ɵprov=r.cc({factory:function(){return new e(r.dc(d.b),r.dc(v.a))},token:e,providedIn:"root"}),e}(),Lo=function(){function e(e,t,n,i,r){this.errorHandler=e,this.contextService=t,this.instrumentationService=n,this.serviceWorkerEnabled=i,this.serviceWorkerMessageService=r}return e.prototype.handleRegistration=function(e){var t=this;if(this.serviceWorkerEnabled)try{var n=this.contextService.sharedContext.serviceWorkerIntervalUpdateEnabled,i=function(){e.addEventListener("updatefound",(function(){t.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing)}))};e.installing?(this.subscribeToInstallingServiceWorkerActivationTelemetry(e.installing),n&&i()):i()}catch(e){this.errorHandler.handleError(e)}},e.prototype.subscribeToInstallingServiceWorkerActivationTelemetry=function(e){var t=this;this.serviceWorkerMessageService.sendTransactionalMessage({type:"OFFICECOM_SW_TELEMETRY",meta:"activation"},e).then((function(e){var n=e.data;"OFFICECOM_SW_TELEMETRY"===n.type&&"activation"===n.meta&&t.instrumentationService.logGenericEvent(n.payload.eventName,n.payload.params)}))},e}(),Uo=n("PZOQ"),No=n("1Bt+"),jo=n("uH9+"),Wo=n("jidT"),Bo=n("qfyf"),zo=n("x+6c"),Vo=n("ZtId"),Ho=function(){function e(e){void 0===e&&(e=!1),this.id=He.a.createGuid(),this.startTime=k.a.now(),e&&this.complete()}return e.prototype.complete=function(){this.endTime=k.a.now()},e.prototype.timeSinceUpdate=function(){return this.endTime?k.a.now()-this.endTime:0},e}(),qo=function(){function e(t,n,i){this.globalErrorHandler=n,this.officeRouteService=i,this.updates=new Map,this.defaultUpdateTimeout=t.sharedContext.dataUpdateTimeoutInSeconds*e.MsPerSecond,this.defaultUpdateCooldown=t.sharedContext.dataUpdateCooldownInSeconds*e.MsPerSecond,this.defaultUpdateFailures=t.sharedContext.dataUpdateMaxConsecutiveFailures}return e.prototype.getOrAddUpdateStream=function(e,t,n,i,r,o){void 0===o&&(o=!1);var a=this.officeRouteService.getRouteItemForCurrentLocation();return this.updates.has(e)||this.updates.set(e,{consecutiveFailures:0,cooldown:i||this.defaultUpdateCooldown,lastUpdate:o?null:new Ho(!0),maxFailures:n||this.defaultUpdateFailures,operation:t,route:a,subject:new $r.a,timeout:r||this.defaultUpdateTimeout}),this.updates.get(e).subject.asObservable()},e.prototype.pushUpdate=function(e){return this.updates.has(e)?this.safeUpdate(this.updates.get(e),e):Promise.resolve()},e.prototype.updateAllowed=function(e){if(!e.lastUpdate)return!0;var t=e.lastUpdate.timeSinceUpdate();return t>0?t>e.cooldown:e.timeout&&e.lastUpdate.startTime+e.timeout<=k.a.now()},e.prototype.safeUpdate=function(e,t){var n=this;if(!this.updateAllowed(e))return Promise.resolve();var i=new Ho;return e.lastUpdate=i,e.operation().then((function(t){i.id===e.lastUpdate.id&&(e.subject.next(t),e.consecutiveFailures=0)})).catch((function(r){n.globalErrorHandler.handleError(r,"my2Kq"),i.id===e.lastUpdate.id&&(e.consecutiveFailures++,e.consecutiveFailures>=e.maxFailures&&n.updates.delete(t))})).then((function(){i.complete()}))},e.MsPerSecond=1e3,e}(),Go=function(e){function t(t,n,i,r,o,a,s,c,l,u,d,p,f,h,m){var b=e.call(this,t,n,i,r,o,a,s,c,l,u,d,p,h,m)||this;return b.ngZone=f,b.init(),b}return Object(i.__extends)(t,e),t.prototype.createThemeChangeObservable=function(){var e=this;return Ao.a.create((function(t){e.eventService.events.withScope(0).pipe(Object(o.a)((function(e){return"themeChanged"===e.name&&e.args&&2===e.args.length&&e.args[0]}))).subscribe((function(n){var i=n.args,r=i[0];!r.IsDarkMode||"base"!==r.ThemeId||r.PreferOfficeTheme&&e.capabilitiesService.capabilities.fluentHeader||(r.Primary=r.Accent);var o=[r.Darker||r.Primary,r.Dark||r.Primary,r.DarkAlt||r.Primary,r.Primary||r.Primary,r.Secondary||r.Primary,r.Tertiary||r.Primary,r.Light||r.Primary,r.Lighter||r.Primary,r.LighterAlt||r.Primary],a=e.showDarkMode();e.ngZone.run((function(){return t.next({theme:{shades:o,reactShellTheme:r,themeType:r.ThemeType,themeId:r.ThemeId,grayscaleThemeShades:a?xe.b.grayscaleThemeShadesDark:xe.b.grayscaleThemeShades},userSelected:i[1]})}))}))}))},t.prototype.showDarkMode=function(){return this.capabilitiesService.capabilities.darkModeEnabled&&!!(this.userTheme&&this.userTheme.reactShellTheme&&this.userTheme.reactShellTheme.IsDarkMode)&&this.darkModeSupported()},t.prototype.showContrastMode=function(){return!1},t.prototype.getInitialUserTheme=function(){var e=this.themeConfig;if(this.capabilitiesService.capabilities.darkModeEnabled)if(this.capabilitiesService.capabilities.isPwaInUwp){var t=(new Windows.UI.ViewManagement.UISettings).getColorValue(Windows.UI.ViewManagement.UIColorType.background);if(255===t.a&&0===t.b&&0===t.g&&0===t.r)return this.getDefaultDarkTheme()}else if(e.isDarkMode||this.capabilitiesService.capabilities.darkModeOverride)return this.getDefaultDarkTheme();if(e.preferOfficeTheme){var n,r=this.defaultTheme;return{shades:n=this.getThemeShades(r),reactShellTheme:r,themeType:"App",themeId:this.userContext.user.themeId}}return{shades:n=(this.themeConfig&&this.themeConfig.userThemeShades||[]).map((function(e){return"#"+e})),reactShellTheme:Object(i.__assign)(Object(i.__assign)({},this.defaultTheme),this.getAppBrandTheme(n)),themeType:this.themeConfig.useTenantTheme?"Tenant":"User",themeId:this.userContext.user.themeId}},t.prototype.getStartingTheme=function(){var e=this.themeConfig.appPageTypeOnLoad;if(e){var t=_e.a.fileTypeNameToFileType(e);if(this.supportedAppThemes.has(t)){var n=this.supportedAppThemes.get(t),r=this.showDarkMode()&&n.darkTheme||n.theme;if(r){var o=this.getThemeShades(r);return{theme:{shades:o,reactShellTheme:Object(i.__assign)(Object(i.__assign)({},this.defaultTheme),this.getAppBrandTheme(o)),themeType:"App",themeId:this.userContext.user.themeId},userSelected:!1,appPage:t}}}}return{theme:this.userTheme,userSelected:!0}},t}(xe.b),Qo=function(e){function t(){return e.call(this)||this}return Object(i.__extends)(t,e),t.prototype.parse=function(t){var n=t.split("?");n[0]=n[0].toLowerCase();var i=n.join("?").replace(/\+/g,"%20");return e.prototype.parse.call(this,i)},t.prototype.serialize=function(t){return e.prototype.serialize.call(this,t).replace(/%20/g,"+")},t}(Q.c),Zo=n("tv+F"),Ko=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.localStorageService=i,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){var t=this.capabilitiesService.capabilities.bottomTrayEnabled?this.getStickyTab():void 0;return t?this.checkEnabledAndRedirect("home"===t,t,e.queryParams):this.checkEnabledAndRedirect(!0)},t.prototype.getStickyTab=function(){return this.router.navigated?void 0:this.localStorageService.get(ri.LastBottomTrayTab)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(Q.n),r.dc(K.a),r.dc(Ot.a))},token:t,providedIn:"root"}),t}(Zo.a),Xo=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.searchEnabled=t.capabilities.showSearch&&!!i.config,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.searchEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n),r.dc(Te.a))},token:t,providedIn:"root"}),t}(Zo.a),Jo=function(e){function t(t,n,i){var r=e.call(this,i,n)||this;return r.appGalleryConfigService=t,r.appGalleryEnabled=!!r.appGalleryConfigService.config,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.appGalleryEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(Tt.a),r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),Yo=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.unsupportedBrowsers=new Map,r.setupUnsupportedBrowsers(),r.fluidSupportEnabled=t.capabilities.fluidSupportEnabled,r.isSupportedBrowser=r.supportedBrowserCheck(i.getDeviceInfo()),r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.canLoad=function(){return this.isSupportedBrowser?this.checkEnabledAndRedirect(this.fluidSupportEnabled):this.checkEnabledAndRedirect(!1,"launch/fluid/unsupported",void 0,!0)},t.prototype.supportedBrowserCheck=function(e){var t=this.unsupportedBrowsers.get(e.browser.browserType);return!(null==t?void 0:t.includes(e.platform.platformType))},t.prototype.setupUnsupportedBrowsers=function(){this.unsupportedBrowsers.set(pe.a.Edge,[pe.d.Chromebook]),this.unsupportedBrowsers.set(pe.a.EdgeLegacy,[pe.d.PC,pe.d.Mac,pe.d.Chromebook,pe.d.iPhone,pe.d.iPad,pe.d.AndroidPhone,pe.d.AndroidTablet,pe.d.Linux]),this.unsupportedBrowsers.set(pe.a.Firefox,[pe.d.Chromebook]),this.unsupportedBrowsers.set(pe.a.Safari,[pe.d.PC,pe.d.Chromebook,pe.d.AndroidTablet,pe.d.AndroidPhone,pe.d.Linux]),this.unsupportedBrowsers.set(pe.a.IE,[pe.d.PC,pe.d.Mac,pe.d.Chromebook,pe.d.iPhone,pe.d.iPad,pe.d.AndroidPhone,pe.d.AndroidTablet,pe.d.Linux]),this.unsupportedBrowsers.set(pe.a.Opera,[pe.d.Chromebook]),this.unsupportedBrowsers.set(pe.a.WebView,[pe.d.PC,pe.d.Mac,pe.d.Chromebook,pe.d.iPhone,pe.d.iPad,pe.d.AndroidPhone,pe.d.AndroidTablet,pe.d.Linux])},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n),r.dc(pe.b))},token:t,providedIn:"root"}),t}(Zo.a),$o=n("EUVs"),ea=function(e){function t(t,n,i){var r=e.call(this,n,t)||this;return r.wacContentService=i,r}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.wacContentService.bootstrapDocumentFromLoader(this.wacContentService.getDocumentInfoFromParams(e.queryParams,_e.a.fileTypeNameToFileType(e.params.app)),Date.now(),!0)];case 1:return t.sent(),[2,this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())]}}))}))},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.capabilitiesService.wacHostEnabled())},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n),r.dc($o.a))},token:t,providedIn:"root"}),t}(Zo.a),ta=function(e){function t(t,n,i,r,o,a){var s=e.call(this,i,t)||this;return s.shellService=n,s.urlLauncherService=r,s.workloadService=o,s.instrumentationService=a,s}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){return this.provisioningCheckHelper(e.data.fileType)},t.prototype.canLoad=function(e){return this.provisioningCheckHelper(e.data.fileType)},t.prototype.provisioningCheckHelper=function(e){var t=this,n=this.router.navigated?"_blank":"_self";return!!this.checkEnabledAndRedirect(this.capabilitiesService.capabilities.startPageApps.has(e))&&new Promise((function(i){t.shellService.checkInAppNavEnabled(e).then((function(r){r?t.shellService.getOdspProvisioningStatus(0,1e3).then((function(r){var o=e===_e.b.OneDrive?r.OneDriveUrl:r.SharepointUrl;o?(i(!1),t.instrumentationService.logGenericEvent("ODSP_Insta_Provisioned_Redirect"),Object(j.a)({featureName:"ODSP",eventName:"ODSP_Insta_Provisioned_Redirect"}),t.urlLauncherService.openUrl(o,"ODSP_Redirect",n)):i(!0)})).catch((function(){i(!0)})):t.workloadService.getWorkloads().then((function(r){var o=r.find((function(t){return t.FileType===e}));t.urlLauncherService.openUrl(o.Url,"ODSP_Redirect",n),i(!1)}))}))}))},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(lt.a),r.dc(Q.n),r.dc(go.a),r.dc(ut.a),r.dc(T.a))},token:t,providedIn:"root"}),t}(Zo.a),na=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.createCenterEnabled=i.capabilitiesService.capabilities.createCenterEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.createCenterEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),ia=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.feedEnabled=i.capabilitiesService.capabilities.feedEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.feedEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.feedEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),ra=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.m365AppsNavigationEnabled=i.capabilitiesService.capabilities.leftNavReact&&i.capabilitiesService.capabilities.m365AppsEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.m365AppsNavigationEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),oa=n("OWzB"),aa=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.createDocumentService=i,o.instrumentationService=r,o.modernStartEnabled=n.capabilities.modernStartPageEnabled,o.startEnabled=n.capabilities.wacStartPageEnabled,o.startPageAppsArray=n.capabilities.startPageAppsArray,o}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){var t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):!this.modernStartEnabled&&this.startEnabled&&this.startPageAppsArray&&this.startPageAppsArray.some((function(t){return t===e.params.app}))?this.checkEnabledAndRedirect(!1,"launch/"+e.url[1].path,e.queryParams,!0):this.checkEnabledAndRedirect(this.modernStartEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.checkAndNavigateToCreateNew=function(e,n){var i=this;return e=e.toLowerCase(),new Promise((function(r){var o=t.CREATE_NEW_REDIRECTS[e];if(o){var a=void 0;0===e.lastIndexOf("templates.")&&n&&(a={AssetId:n}),i.createDocumentService.createItem(o,null,a,(function(t){var n,o=((n={}).MsNewParam=e,n.Action=t&&t.type||"",n);t&&"Error"!==t.type&&"CreatePending"!==t.type?(i.instrumentationService.logGenericEvent("Create_New_Redirect_Success",o),r(!1)):(i.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",o),r(!0))}),null,null,"_self")}}))},t.CREATE_NEW_REDIRECTS={"word.new":_e.b.Word,"templates.word.new":_e.b.Word,"powerpoint.new":_e.b.PowerPoint,"templates.powerpoint.new":_e.b.PowerPoint,"excel.new":_e.b.Excel,"templates.excel.new":_e.b.Excel,"sway.new":_e.b.Sway},t.ɵprov=r.cc({factory:function(){return new t(r.dc(Q.n),r.dc(K.a),r.dc(oa.a),r.dc(T.a))},token:t,providedIn:"root"}),t}(Zo.a),sa=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.myContentPageEnabled=i.capabilitiesService.capabilities.myContentEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.myContentPageEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),ca=function(e){function t(t,n){var i=e.call(this,n,t)||this;return i.templatesEnabled=t.capabilities.templatesEnabled&&t.capabilities.wacStartPageEnabled,i}return Object(i.__extends)(t,e),t.prototype.canActivate=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.templatesEnabled)},t.ɵprov=r.cc({factory:function(){return new t(r.dc(K.a),r.dc(Q.n))},token:t,providedIn:"root"}),t}(Zo.a),la=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.createDocumentService=i,o.instrumentationService=r,o.startEnabled=n.capabilities.wacStartPageEnabled,o.modernStartEnabled=n.capabilities.modernStartPageEnabled,o.modernStartAppsArray=n.capabilities.modernStartAppsArray,o}return Object(i.__extends)(t,e),t.prototype.canActivate=function(e){var t=e.queryParams["ms.url"];return t?this.checkAndNavigateToCreateNew(t,e.queryParams.templateId):this.modernStartEnabled&&this.modernStartAppsArray&&this.modernStartAppsArray.some((function(t){return t===e.params.app}))?this.checkEnabledAndRedirect(!1,"modernlaunch/"+e.url[1].path,e.queryParams,!0):this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.canLoad=function(){return this.checkEnabledAndRedirect(this.startEnabled)},t.prototype.checkAndNavigateToCreateNew=function(e,n){var i=this;return e=e.toLowerCase(),new Promise((function(r){var o=t.CREATE_NEW_REDIRECTS[e];if(o){var a=void 0;0===e.lastIndexOf("templates.")&&n&&(a={AssetId:n}),i.createDocumentService.createItem(o,null,a,(function(t){var n,o=((n={}).MsNewParam=e,n.Action=t&&t.type||"",n);t&&"Error"!==t.type&&"CreatePending"!==t.type?(i.instrumentationService.logGenericEvent("Create_New_Redirect_Success",o),r(!1)):(i.instrumentationService.logGenericEvent("Create_New_Redirect_Fail",o),r(!0))}),null,null,"_self")}}))},t.CREATE_NEW_REDIRECTS={"word.new":_e.b.Word,"templates.word.new":_e.b.Word,"powerpoint.new":_e.b.PowerPoint,"templates.powerpoint.new":_e.b.PowerPoint,"excel.new":_e.b.Excel,"templates.excel.new":_e.b.Excel,"sway.new":_e.b.Sway},t.ɵprov=r.cc({factory:function(){return new t(r.dc(Q.n),r.dc(K.a),r.dc(oa.a),r.dc(T.a))},token:t,providedIn:"root"}),t}(Zo.a),ua={fileType:_e.b.SharePoint},da={fileType:_e.b.OneDrive},pa=function(){return function(){}}(),fa=function(){function e(){}return e.prototype.shouldReuseRoute=function(e,t){return e.routeConfig===t.routeConfig&&e.paramMap.get("app")===t.paramMap.get("app")&&e.paramMap.get("spaceId")===t.paramMap.get("spaceId")&&e.paramMap.get("appId")===t.paramMap.get("appId")&&e.paramMap.get("entityId")===t.paramMap.get("entityId")&&e.paramMap.get("subEntityId")===t.paramMap.get("subEntityId")},e.prototype.shouldDetach=function(e){return!1},e.prototype.store=function(e,t){},e.prototype.shouldAttach=function(e){return!1},e.prototype.retrieve=function(e){return null},e}(),ha=n("xIlw"),ma=n("+a0u"),ba=n("lQwO"),ga=n("sCgQ"),va=n("izKO"),ya=n("D6F8"),Sa=n("+5ti"),wa=n("+P5Z"),Ca=n("CfLe"),Ia=n("ej7j"),Ta=n("VY7U"),ka=n("GPFm"),_a=new r.q("INSTRUMENTATION_QUEUE"),Aa=n("AXqk"),Pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"securityLevel",{get:function(){return 3},enumerable:!0,configurable:!0}),t}(Aa.a),Ea=function(){return function(){}}(),Oa=n("EuUe"),Fa=function(){return function(){}}(),Da=n("+I3G"),Ra=n("Bmgn"),Ma=n("32VK"),xa=n("L9A/"),La=n("T6pR"),Ua=n("T/SX"),Na=n("up2P"),ja=n("D8EG"),Wa=n("9InZ"),Ba=n("upmJ"),za=n("ci1G"),Va=n("M3TP"),Ha=n("XQbr"),qa=function(){return function(){}}(),Ga=n("vW6f"),Qa=r.wb(Se,[Ke],(function(e){return r.Lb([r.Mb(512,r.j,r.Z,[[8,[Xe.a,bn,Ki]],[3,r.j],r.x]),r.Mb(5120,Q.a,Q.z,[Q.n]),r.Mb(4608,Q.f,Q.f,[]),r.Mb(6144,Q.i,null,[Q.f]),r.Mb(135680,Q.q,Q.q,[Q.n,r.w,r.i,r.r,Q.i]),r.Mb(4608,Q.h,Q.h,[]),r.Mb(5120,Q.E,Q.v,[Q.n,Je.s,Q.j]),r.Mb(5120,Q.k,Q.C,[Q.A]),r.Mb(5120,z.a,tr,[Ji,r.m]),r.Mb(5120,r.b,(function(e,t,n,i){return[e,nr(t,n,i),be()]}),[Q.k,r.r,z.a,p.b]),r.Mb(5120,r.u,r.mb,[[3,r.u]]),r.Mb(4608,Je.m,Je.l,[r.u]),r.Mb(4608,N.b,ur,[Z,B.a,K.a,W.a,H.a,z.a,c.b,T.a,lr,d.b,je.a,Be.a,sr.a,Ne.a,p.b]),r.Mb(4608,dr.a,De,[N.b,B.a,T.a,W.a,Z,u.a,Fe,z.a,c.b,Oe.a]),r.Mb(5120,pr.a,mr,[K.a,fr.a,hr.a]),r.Mb(5120,r.pb,r.nb,[r.z]),r.Mb(5120,r.c,r.jb,[]),r.Mb(5120,r.s,r.kb,[]),r.Mb(5120,r.t,r.lb,[]),r.Mb(4608,pi.b,pi.l,[Je.d]),r.Mb(6144,r.G,null,[pi.b]),r.Mb(4608,pi.e,pi.g,[]),r.Mb(5120,pi.c,(function(e,t,n,i,r,o,a,s){return[new pi.j(e,t,n),new pi.o(i),new pi.n(r,o,a,s)]}),[Je.d,r.z,r.B,Je.d,Je.d,pi.e,r.ab,[2,pi.f]]),r.Mb(4608,pi.d,pi.d,[pi.c,r.z]),r.Mb(135680,pi.m,pi.m,[Je.d]),r.Mb(4608,pi.k,pi.k,[pi.d,pi.m,r.c]),r.Mb(5120,de.a,me,[p.b]),r.Mb(5120,de.c,yr.e,[]),r.Mb(4608,de.b,yr.d,[Je.d,de.a,de.c]),r.Mb(5120,r.E,yr.f,[pi.k,de.b,r.z]),r.Mb(6144,pi.p,null,[pi.m]),r.Mb(4608,r.M,r.M,[r.z]),r.Mb(4608,Sr.b,yr.c,[r.E,Je.d]),r.Mb(5120,wr,Tr,[B.a,Xt.a,Pr.a,K.a]),r.Mb(4608,Er.n,Er.t,[Je.d,r.B,Er.r]),r.Mb(4608,Er.u,Er.u,[Er.n,Er.s]),r.Mb(5120,v.a,Rr,[d.b,r.B,Lr.a]),r.Mb(5120,g.a,Ur,[m.a,v.a]),r.Mb(5120,jr.a,Mr,[p.b,Vr]),r.Mb(4608,Hr.a,Gr,[qr.a]),r.Mb(5120,Er.a,(function(e,t,n,i,r,o,a,s,c,l,u,d){return[e,new Zr(t),new ee.a(n,i,r,o),new to(a,s,c,l,u),new co(d)]}),[Er.u,g.a,g.a,jr.a,b.a,c.b,qr.a,eo,jr.a,g.a,[2,Hr.a],so]),r.Mb(4608,Er.q,Er.q,[]),r.Mb(6144,Er.o,null,[Er.q]),r.Mb(4608,Er.m,Er.m,[Er.o]),r.Mb(6144,Er.b,null,[Er.m]),r.Mb(4608,Er.h,Er.p,[Er.b,r.r]),r.Mb(4608,Er.c,Er.c,[Er.h]),r.Mb(4608,Pt.a,lo,[]),r.Mb(4608,uo.a,po,[]),r.Mb(4608,fo.a,ho,[]),r.Mb(4608,mo,bo,[]),r.Mb(6144,go.a,null,[vo]),r.Mb(4608,ut.a,To,[pt,K.a,z.a,B.a,En.a,c.b,p.b,dr.a,Oe.a,Me.a,U.a]),r.Mb(4608,ko.a,Do,[K.a,p.b,B.a,l.a,T.a,k.b,Po.a,hr.a,Le.a,d.b,Fo]),r.Mb(5120,h,(function(e,t,n,i,r,o,a,s,c,l,u,d,p){return[new Ro(e,t,n,i,r,o,a),new Mo(s),new Lo(c,l,u,d,p)]}),[c.b,B.a,g.a,jr.a,d.b,u.a,p.b,g.a,r.m,B.a,T.a,g.a,xo]),r.Mb(4608,Uo.a,Uo.a,[Ne.a]),r.Mb(4608,No.a,No.a,[En.a,Ne.a,jo.a]),r.Mb(4608,Wo.a,Wo.a,[Je.d,r.B]),r.Mb(5120,Bo.a,ve,[]),r.Mb(5120,zo.a,ye,[p.b,pe.b,r.z]),r.Mb(4608,Vo.a,qo,[B.a,c.b,q.a]),r.Mb(4608,xe.b,Go,[l.a,H.a,K.a,z.a,p.b,B.a,T.a,Be.a,q.a,Oe.a,Ne.a,d.b,r.z,Me.a,Le.a]),r.Mb(1024,Q.t,Q.x,[[3,Q.n]]),r.Mb(512,Q.s,Qo,[]),r.Mb(512,Q.b,Q.b,[]),r.Mb(256,Je.a,"/",[]),r.Mb(256,Q.j,{enableTracing:!1,initialNavigation:!1,useHash:!1},[]),r.Mb(1024,Je.h,Q.w,[Je.q,[2,Je.a],Q.j]),r.Mb(512,Je.g,Je.g,[Je.h,Je.q]),r.Mb(512,r.i,r.i,[]),r.Mb(512,r.w,r.J,[r.i,[2,r.K]]),r.Mb(1024,Q.l,(function(){return[[{path:"",component:ln,canActivate:[Ko]},{path:"home",redirectTo:""},{path:"search",loadChildren:"./search-results/search-results.module#SearchResultsModule",canActivate:[Xo],canLoad:[Xo]},{outlet:"install-wizard",path:"",children:[{path:"open",loadChildren:"./install/install-wizard/install-wizard.module#InstallWizardModule"}]},{path:"apps",loadChildren:"./app-gallery-wrapper/app-gallery-wrapper.module#AppGalleryWrapperModule",canActivate:[Jo],canLoad:[Jo]},{path:"launch/fluid/content",children:[],canActivate:[Yo],canLoad:[Yo]},{path:"launch/fluid/unsupported",loadChildren:"./fluid-unsupported-page/fluid-unsupported-page.module#FluidUnsupportedPageModule"},{path:"launch/:app/content",loadChildren:"./wac-content/wac-content.module#WacContentModule",canActivate:[ea],canLoad:[ea]},{path:"launch/sharepoint",loadChildren:"./odsp-start/sharepoint-start/sharepoint-start.module#SharePointStartModule",canActivate:[ta],canLoad:[ta],data:ua},{path:"launch/onedrive",loadChildren:"./odsp-start/onedrive-start/onedrive-start.module#OnedriveStartModule",canActivate:[ta],canLoad:[ta],data:da},{path:"launch/:app",loadChildren:"./wac-start/wac-start.module#WacStartModule",canActivate:[la],canLoad:[la]},{path:"modernlaunch/:app",loadChildren:"./modern-start/modern-start.module#ModernStartModule",canActivate:[aa],canLoad:[aa]},{path:"template/:app",loadChildren:"./templates/templates.module#TemplatesModule",canActivate:[ca],canLoad:[ca]},{path:"m365apps",loadChildren:"./m365-apps/m365-apps.module#M365AppsModule",canActivate:[ra],canLoad:[ra]},{path:"feed",loadChildren:"./feed/feed.module#FeedModule",canActivate:[ia],canLoad:[ia]},{path:"create",loadChildren:"./create-center/create-center.module#CreateCenterModule",canActivate:[na],canLoad:[na]},{path:"mycontent",loadChildren:"./my-content/my-content.module#MyContentModule",canActivate:[sa],canLoad:[sa]}]]}),[]),r.Mb(512,Q.m,fa,[]),r.Mb(1024,Q.n,Q.y,[Q.s,Q.b,Je.g,r.r,r.w,r.i,Q.l,Q.j,[2,Q.r],[2,Q.m]]),r.Mb(1073742336,Q.o,Q.o,[[2,Q.t],[2,Q.n]]),r.Mb(1073742336,pa,pa,[]),r.Mb(1073742336,Je.c,Je.c,[]),r.Mb(1073742336,ha.a,ha.a,[]),r.Mb(1073742336,ma.a,ma.a,[]),r.Mb(1073742336,ba.a,ba.a,[]),r.Mb(1073742336,ga.a,ga.a,[]),r.Mb(1073742336,va.a,va.a,[]),r.Mb(1073742336,ya.a,ya.a,[]),r.Mb(1073742336,Ct.a,Ct.a,[]),r.Mb(1073742336,Sa.b,Sa.b,[]),r.Mb(1073742336,wt.g,wt.g,[]),r.Mb(1073742336,wa.a,wa.a,[]),r.Mb(1073742336,Ca.a,Ca.a,[]),r.Mb(1073742336,Ia.a,Ia.a,[]),r.Mb(1073742336,Ta.a,Ta.a,[]),r.Mb(1073742336,ka.a,ka.a,[]),r.Mb(1073742336,vr,vr,[]),r.Mb(1024,_a,ge,[]),r.Mb(512,Aa.a,Pa,[]),r.Mb(512,T.a,x.a,[[2,_a],Aa.a,pe.b]),r.Mb(512,r.m,c.b,[T.a,d.b]),r.Mb(512,Q.A,Q.A,[r.r]),r.Mb(1024,r.y,(function(){return[Q.u()]}),[]),r.Mb(1024,Ji,$i,[d.b]),r.Mb(1024,r.d,(function(e,t,n){return[Q.B(e),pi.q(t),er(n)]}),[Q.A,[2,r.y],Ji]),r.Mb(512,r.e,r.e,[[2,r.d]]),r.Mb(131584,r.g,r.g,[r.z,r.ab,r.r,r.m,r.j,r.e]),r.Mb(1073742336,r.f,r.f,[r.g]),r.Mb(1073742336,pi.a,pi.a,[[3,pi.a]]),r.Mb(1073742336,yr.b,yr.b,[]),r.Mb(1073742336,Ea,Ea,[]),r.Mb(1073742336,Ar,Ar,[]),r.Mb(1073742336,Oa.a,Oa.a,[]),r.Mb(1073742336,Fa,Fa,[]),r.Mb(1073742336,Da.b,Da.b,[]),r.Mb(1073742336,Ra.a,Ra.a,[]),r.Mb(1073742336,Ma.a,Ma.a,[]),r.Mb(1073742336,xa.a,xa.a,[]),r.Mb(1073742336,La.a,La.a,[]),r.Mb(1073742336,Ua.a,Ua.a,[]),r.Mb(1073742336,Na.a,Na.a,[]),r.Mb(1073742336,ja.a,ja.a,[]),r.Mb(1073742336,Wa.a,Wa.a,[]),r.Mb(1073742336,Ba.a,Ba.a,[]),r.Mb(1073742336,za.a,za.a,[]),r.Mb(1073742336,Va.a,Va.a,[]),r.Mb(1073742336,Ha.a,Ha.a,[]),r.Mb(1073742336,Er.e,Er.e,[]),r.Mb(1073742336,Er.d,Er.d,[]),r.Mb(1073742336,qa,qa,[]),r.Mb(1073742336,Nr,Nr,[]),r.Mb(1073742336,xr,xr,[]),r.Mb(1073742336,ir,ir,[]),r.Mb(1073742336,Se,Se,[]),r.Mb(256,r.k,r.ob,[]),r.Mb(256,r.cb,"root",[]),r.Mb(256,yr.a,"BrowserAnimations",[]),r.Mb(256,ao,Ir,[]),r.Mb(256,oo,kr,[]),r.Mb(256,ro,_r,[]),r.Mb(256,Er.r,"XSRF-TOKEN",[]),r.Mb(256,Er.s,"X-XSRF-TOKEN",[]),r.Mb(256,Ga.a,50,[]),r.Mb(256,y.a,"officehome",[])])}));try{window.ohpAppBundleParsingSuccessFlag=!0;var Za=function(){return pi.i().bootstrapModuleFactory(Qa,{preserveWhitespaces:!1})};Object(s.a)()?function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o,a,s,c,l,u,d,p,f,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,20,,22]),function(e,t){void 0===t&&(t=[]),new URLSearchParams(window.location.search).forEach((function(n,i){t.includes(i)||e.searchParams.set(i,n)}))}(e=new URL(window.location.origin+"/api/identity")),[4,fetch(e.toString())];case 1:return(t=i.sent()).ok?[3,3]:[4,ce()];case 2:return i.sent(),[2];case 3:return[4,t.json()];case 4:return n=i.sent(),r=n.puid,o=n.encryptionConfig,[4,ie(window.crypto.subtle,n.tenantId+"_"+r,o.digestSaltBase64,(function(e){return Object(re.b)(e,window)}))];case 5:return[4,ue(a=i.sent(),"cache-only",r)];case 6:if(!(s=i.sent()))return[3,14];i.label=7;case 7:return i.trys.push([7,13,,14]),[4,s.arrayBuffer()];case 8:return c=i.sent(),(l=Object(oe.b)(new Uint8Array(c)))?[4,Object(se.a)(o.cryptoKey,window.crypto.subtle)]:[3,12];case 9:return u=i.sent(),[4,Object(ae.a)(l,u,window.crypto,(function(e){return Object(re.a)(e,window)}))];case 10:return d=i.sent(),[4,new Response(d.body,{headers:new Headers(JSON.parse(d.headers)),status:d.status,statusText:d.statusText}).json()];case 11:h=i.sent(),window.shellAndConfigResponse=Promise.resolve(h),i.label=12;case 12:return[3,14];case 13:return i.sent(),s=null,[3,14];case 14:return p=ue(a,"network-first",r),s?[3,19]:[4,p];case 15:return(f=i.sent())?[3,17]:[4,ce()];case 16:return i.sent(),[3,19];case 17:return[4,f.json()];case 18:h=i.sent(),window.shellAndConfigResponse=Promise.resolve(h),i.label=19;case 19:return document.getElementById("splash-screen").remove(),[3,22];case 20:return i.sent(),[4,ce()];case 21:return i.sent(),[3,22];case 22:return[2]}}))}))}().then(Za).then($).catch(ce):(function(){(E=Object(p.c)()).angularDebugInfoEnabled||Object(r.T)(),A=k.a.now()}(),Za().then($).catch((function(e){return _(e,Object(p.c)())})))}catch(e){Object(s.a)()?ce():_(e,Object(p.c)())}},hZW2:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("keVe"),r=n("dFxn"),o=function(){function e(e){this.configParserService=e}return e.prototype.getConfig=function(){return this.config||(this.config=this.configParserService.parse("documentConfig")),this.config||{mockUploadFile:null}},e.ɵprov=i.cc({factory:function(){return new e(i.dc(r.a))},token:e,providedIn:"root"}),e}(),a=function(){function e(e){this.documentConfigService=e}return e.prototype.addScriptToPage=function(e,t,n,i,r,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var a=this.getDocument();if(a)if(this.findScript(r))t&&t();else{var s=a.createElement("script");if(s.src=e,s.id=r,t&&(s.onload=t),n&&(s.onerror=n),i){var c=a.getElementsByTagName("script")[0];if(c&&c.parentNode)return void c.parentNode.insertBefore(s,c)}o&&(s.crossOrigin="anonymous"),a.body.appendChild(s)}},e.prototype.addIframeToPage=function(e,t){if(e||t){var n=this.getDocument();if(!(!n||t&&n.getElementById(t)||n.querySelector('iframe[src="'+e+'"]'))){var i=n.createElement("iframe");e&&i.setAttribute("src",e),t&&(i.id=t),i.style.display="none",n.body.appendChild(i)}}},e.prototype.selectFile=function(t){var n=this;this.selectFilePromiseRejector&&this.selectFilePromiseRejector();var i=this.getDocument();this.fileInputElement&&i.body.removeChild(this.fileInputElement);var r=this.documentConfigService.getConfig().mockUploadFile;if(r){var o=this.createMockFileList(r.name,r.size);return Promise.resolve(o)}return this.fileInputElement=i.createElement("input"),this.fileInputElement.type="file",this.fileInputElement.id=e.fileInputId,this.fileInputElement.accept=t.join(","),i.body.appendChild(this.fileInputElement),new Promise((function(e,t){n.selectFilePromiseRejector=t;var r=function(o){var a=o.target.files;a&&a.length?e(a):t(),n.selectFilePromiseRejector=null,n.fileInputElement&&(n.fileInputElement.removeEventListener("change",r),i.body.removeChild(n.fileInputElement),n.fileInputElement=null)};n.fileInputElement.addEventListener("change",r),n.fileInputElement.click()}))},e.prototype.updateFavicon=function(e){this.addOrUpdateLink(e,"shortcut icon","image/x-icon",'link[rel="shortcut icon"]')},e.prototype.addOrUpdateStylesheet=function(e,t){this.addOrUpdateLink(e,"stylesheet","text/css","#"+t,t)},e.prototype.addCssClassToElement=function(e,t){e&&e.classList.add(t)},e.prototype.removeCssClassFromElement=function(e,t){e&&e.classList.remove(t)},e.prototype.addOrUpdateStyleTag=function(e,t){var n=this.getDocument();if(n){var i=n.getElementById(e);i&&i.parentNode&&i.parentNode.removeChild(i),(i=n.createElement("style")).id=e,i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(n.createTextNode(t)),n.head.appendChild(i)}},e.prototype.addLinkTag=function(e){var t=this.getDocument();if(t){var n=t.createElement("link");e.forEach((function(e,t){return n.setAttribute(t,e)})),t.head.appendChild(n)}},e.prototype.appendHTMLToElement=function(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)},e.prototype.getOffset=function(e){var t=(e instanceof i.l?e.nativeElement:e).getBoundingClientRect();return{top:t.top+this.nativeDocument.body.scrollTop,left:t.left+this.nativeDocument.body.scrollLeft}},e.prototype.disableTouchMove=function(){this.getDocument().addEventListener("touchmove",this.preventDefault,{passive:!1})},e.prototype.enableTouchMove=function(){this.getDocument().removeEventListener("touchmove",this.preventDefault)},e.prototype.updateThemeColor=function(e){var t=this.getDocument();if(t){var n=t.querySelector('meta[name="theme-color"]');if(n)n.content!==e&&(n.content=e);else{var i=t.createElement("meta");i.name="theme-color",i.content=e,t.head.appendChild(i)}}},e.prototype.preventDefault=function(e){e.preventDefault()},Object.defineProperty(e.prototype,"nativeDocument",{get:function(){return this.getDocument()},enumerable:!0,configurable:!0}),e.prototype.getDocument=function(){return document},e.prototype.findScript=function(e){if(!e)return!1;var t=this.getDocument();return!!t&&!!t.getElementById(e)},e.prototype.addOrUpdateLink=function(e,t,n,i,r){if(e){var o=this.getDocument();if(o){var a=o.querySelector(i);a?a.href!==e&&(a.href=e):((a=o.createElement("link")).rel=t,a.type=n,a.href=e,r&&(a.id=r),o.head.appendChild(a))}}},e.prototype.createMockFileList=function(e,t){var n=new Blob([new Uint8Array(t)],{type:""});return n.name=e,[n]},e.fileInputId="select-file",e.ɵprov=i.cc({factory:function(){return new e(i.dc(o))},token:e,providedIn:"root"}),e}()},hhzZ:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return s}));var i=n("31lE"),r=function(){function e(){}return e.FirsttimeReferral="First time",e.ResurrectedReferral="Resurrected",e.RepeatReferral="Repeat",e.NotDetected="NotDetected",e}(),o=function(){function e(){}return e.AllMyDocuments="AllMyDocuments",e.AppCategory="AppCategory",e.AppGalleryHero="AppGalleryHero",e.AppList="AppList",e.AppTiles="AppTiles",e.BackstageMru="BackstageMru",e.Banner="Banner",e.Calendar="Calendar",e.CreateCenter="CreateCenter",e.CreateFlyOut="CreateFlyOut",e.CreateGallery="CreateGallery",e.CreateModal="CreateModal",e.CreateOnHome="CreateOnHome",e.Documents="Documents",e.DocumentTitleComponent="DocumentTitleComponent",e.Edgeworth="Edgeworth",e.EnterpriseTemplates="EnterpriseTemplates",e.ErrorDialog="ErrorDialog",e.FeaturedDocs="FeaturedDocs",e.Feedback="Feedback",e.FirstRun="FirstRun",e.FluidContent="FluidContent",e.Folders="Folders",e.FormsGroups="FormsGroups",e.Hero="Hero",e.InputDialog="InputDialog",e.InstallWizard="InstallWizard",e.LeftNav="LeftNav",e.LeftNavCallout="LeftNavCallout",e.MobileAppBanner="MobileAppBanner",e.NewConsumerExperience="NewConsumerExperience",e.PeopleCard="PeopleCard",e.PwaDialog="PwaDialog",e.Recommended="Recommended",e.SearchResults="SearchResults",e.SearchSuggestions="SearchSuggestions",e.Shell="Shell",e.SideMenu="SideMenu",e.Sites="Sites",e.SuggestedActions="SuggestedActions",e.Templates="Templates",e.UploadDialog="UploadDialog",e.Upsell="Upsell",e}(),a=function(){return function(e,t){void 0===t&&(t=i.AWTPiiKind.GenericData),this.value=e,this.kind=t}}(),s=function(){function e(){}return e.filterPii=function(e){return e?(e.replace("\n","").replace("\r","").replace("\t","").replace("\b",""),e.replace(this.emailRegex,"email_removed").replace(this.localFileRegex,"file_removed").replace(this.searchQueryRegex,"$1query_removed")):e},e.emailRegex=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,63}","gm"),e.localFileRegex=new RegExp("file(:|%3A|%253A).*","gim"),e.searchQueryRegex=new RegExp("([&?]q=)(.+?)(?=[&].*| |, |$)","gmi"),e}()},hoyd:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},iPRk:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v}));var i,r=n("8/lW"),o=n("AGMK"),a=n("z0B0"),s=n("Ihso"),c=n("cenr"),l=n("a3FV"),u=n("CMIS"),d=n("1rn/"),p=n("Cin9"),f=n("VV8N"),h=new Set,m=!1;function b(e,t,n,i){if(void 0===t&&(t=2),void 0===n&&(n=r.a.Security),function(){var e=window.performance;return!!(e&&e.now&&e.mark&&e.timing&&e.timing.navigationStart&&e.measure&&e.getEntriesByType)}()){var o=e,a=Object(f.b)();a&&(o=e+"_"+a);var s=o,h=f.d.get(s);if(h){var m=h+1;f.d.set(s,m),s=o+"."+m}else f.d.set(s,1);window.performance.mark(s);var b=Object(f.c)()||"navigationStart";"App_Navigation_Start"===e&&Object(f.g)(s);var g="navigationStart";return 2===t?g=b:0===t?g="":"string"==typeof t&&(g=t),function(e,t,n,i,o,a){if(n&&!f.e.has(e)){f.e.add(e);try{window.performance.measure(e,n,t)}catch(i){return void function(e,t){var n,i=((n={}).Error=e,n.DebugInfo=t,n);Object(c.a)(l.a.PerformanceMarkFailure,i),Object(u.a)({eventName:"Performance_Mark_Failure",errorType:"Other",message:e,debugInfo:t})}(e,"Failed to record <"+e+"> for <"+t+"> starting from <"+n+">: exception is thrown")}!function(e,t,n,i){var o=window.performance.getEntriesByName(e,"measure");o&&function(e,t,n,i){void 0===i&&(i=r.a.Security),Object(d.a)(e,t,n,i),Object(p.a)({eventName:e,latency:t},i)}(t,Math.ceil(o[0].duration),i,n)}(e,o||e,i,a)}}(o,s,g,n,e,i),s}}function g(e){return new Promise((function(t){Object(s.b)((function(){t(b(e))}))}))}function v(e){m||(function(){Object(a.a)((function(e){"hidden"===e&&function(){i&&Object(s.a)(i),y()}()}))}(),m=!0),h.add(e),i||(i=Object(s.b)((function(){Object(o.a)()&&h.forEach((function(e){b(e)})),y()})))}function y(){h.clear(),i=null}},"iX+N":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("dFxn"),r=n("keVe"),o=function(){function e(e){this.config=e.parse("wacStartPageConfig")||{featuredDocumentsEnabled:!1,maxInitialDocuments:0,maxTotalDocuments:0,startPageNumTemplatesToShow:0,visioMoreTemplatesUrl:null,moreTemplatesRedirectionEnabled:!1,streamCrossLinkUrl:null,streamDocumentationUrl:null,resources:null,streamPreviewString:"StreamCrossLinkString"}}return e.ɵprov=r.cc({factory:function(){return new e(r.dc(i.a))},token:e,providedIn:"root"}),e}()},idgT:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("QjXU"),r=n("zvoD"),o=n("3Vsh"),a=n("BaAg"),s=n("dFxn"),c=n("hZW2"),l=n("7Gwk"),u=n("/I02"),d=n("uWZl"),p=n("ZBli"),f=n("keVe"),h=function(){function e(t,n,i,r){var o=this;this.configParserService=t,this.contextService=n,this.documentService=i,this.eventService=r;var s=this.configParserService.parse(e.configElementId);this.config=s||{createLcidEnabled:!1,enterpriseTemplatesEnabled:!1,exploreTemplatesUrlFormat:null,exploreTemplatesUrlLocale:null,numTemplates:0,numVisioTemplates:0,premiumTemplatesDiamondCorner:null,premiumTemplatesUpsellEnabled:!1,sharePointAuthFrameUrl:null,templatesApiEndpoint:null,excelOrgTemplatesEnabled:!1,templatesFormsEnabled:!1,createTemplatesEnabled:!1,wordOrgTemplatesEnabled:!1,templatesRecommendedApps:[],templatesCollectionsCommercial:[],templatesCollectionsConsumer:[],templatesCollectionsEdu:[],templatesRecommendedApiEnabled:!1,visioUnsupportedTemplatesLocales:[]},this.commonResources=s&&s.appResources?s.appResources.common:{},this.resourceVariants=new Map,s&&s.appResources&&s.appResources.variants&&s.appResources.variants.forEach((function(e){var t=a.a.fileTypeNameToFileType(e.app);t&&o.resourceVariants.set(t,e.resources)})),this.resourceMap=new Map}return e.prototype.resources=function(e){void 0===e&&(e=a.b.Word);var t=a.a.fileTypeToApp(e);if(this.resourceMap.has(t))return this.resourceMap.get(t);if(!this.resourceVariants.has(t))return this.commonResources;var n=this.resourceVariants.get(t),r=Object(i.__assign)(Object(i.__assign)({},this.commonResources),n);return this.resourceMap.set(t,r),r},e.prototype.getTemplatesInfoPromise=function(){var e=this;if(!this.templatesInfoPromise){var t=this.eventService.events.withScope(0).pipe(Object(r.a)((function(e){return"primaryTokensLoaded"===e.name})),Object(o.a)(1)).toPromise(),n=d.a.fullPageReady();this.templatesInfoPromise=Promise.race([t,n]).then((function(){return e.configParserService.parse("templatesInfo")}))}return this.templatesInfoPromise},e.prototype.prefetchStaticResources=function(e){var t=this.resources(e);(null==t?void 0:t.PrefetchUrl)&&this.documentService.addIframeToPage(p.a.appendQueryParam(t.PrefetchUrl,"ui",this.contextService.sharedContext.officeMarket))},e.configElementId="templatesPageConfig",e.ɵprov=f.cc({factory:function(){return new e(f.dc(s.a),f.dc(u.a),f.dc(c.a),f.dc(l.a))},token:e,providedIn:"root"}),e}()},izKO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},"j7b/":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var i=864e5,r=7*i,o=30*i},jCfB:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),function(e){e.ItemId="item",e.DriveId="drive",e.DocUrl="file",e.ContentUri="contenturi",e.NewFile="newfile",e.BootId="bootid",e.Nav="nav"}(i||(i={}));var r="WacContent_Document_Boot_Diagnostics"},jrGV:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("2dXW"),r=n("zvoD"),o=n("f0qX"),a=n("keVe"),s=function(){function e(){this.actionContextMenu=new i.a}return e.prototype.closeMenu=function(e){this.updateNext(e,0)},e.prototype.openMenu=function(e){this.updateNext(e,1)},e.prototype.subscribeToCloseEvents=function(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&0===e.type})),Object(o.a)((function(e){return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.subscribeToOpenEvents=function(e){return this.actionContextMenu.asObservable().pipe(Object(r.a)((function(e){return e&&1===e.type})),Object(o.a)((function(e){return{id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement}}))).subscribe(e)},e.prototype.updateNext=function(e,t){e&&this.actionContextMenu.next({type:t,id:e.id,itemIndex:e.itemIndex,actions:e.actions,groupInfo:e.groupInfo,mouseEvent:e.mouseEvent,targetElement:e.targetElement})},e.ɵprov=a.cc({factory:function(){return new e},token:e,providedIn:"root"}),e}()},jsgn:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU");function r(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return[2,t.importKey("jwk",e,"AES-GCM",!1,["encrypt","decrypt"])]}))}))}},"k+kJ":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o}));var i,r,o,a=n("QjXU"),s=n("AlWG"),c=n("Uqr9"),l=n("IAGz"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t,n,r,o,a,u,d,p){void 0===r&&(r=null),void 0===o&&(o=0),void 0===a&&(a=i.Started),void 0===u&&(u=null),void 0===d&&(d=null),void 0===p&&(p=null),this.sessionId=e,this.file=t,this.uploadSource=n,this.cancellationToken=r,this.bytesUploaded=o,this.state=a,this.error=u,this.sessionUrl=d,this.markCompletedAndOpenedInOfficeHome=p,this.startTime=c.a.now(),this.fileSize=t.size,this.lastLoaded=o,this.progress=new s.a(this.progressState()),this.cancellationToken=r||new l.a}return e.prototype.finished=function(){return this.state===i.Completed||this.state===i.Cancelled||this.state===i.Failed||this.state===i.CompletedAndOpened},e.prototype.updateProgress=function(e){void 0!==e&&(this.lastLoaded=Math.min(Math.max(this.lastLoaded,e),this.fileSize),this.progress.next(this.progressState()))},e.prototype.getProgress=function(){return this.progress.asObservable()},Object.defineProperty(e.prototype,"duration",{get:function(){return c.a.now()-this.startTime},enumerable:!0,configurable:!0}),e.prototype.progressState=function(){return{percentage:Math.floor(100*this.lastLoaded/this.fileSize),loaded:this.lastLoaded,total:this.fileSize}},e}());!function(e){e[e.Unknown=0]="Unknown",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.CompletedAndOpened=3]="CompletedAndOpened",e[e.Cancelled=4]="Cancelled",e[e.Failed=5]="Failed"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.FileTooLarge=1]="FileTooLarge",e[e.OutOfSpace=2]="OutOfSpace",e[e.InvalidFileType=3]="InvalidFileType",e[e.BadConnection=4]="BadConnection",e[e.Timeout=5]="Timeout",e[e.Auth=6]="Auth",e[e.MultipleFiles=7]="MultipleFiles"}(r||(r={})),function(e){e[e.Button=0]="Button",e[e.DragAndDrop=1]="DragAndDrop",e[e.CreateMenu=2]="CreateMenu"}(o||(o={}))},kJkW:function(e,t,n){var i={"../app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",89],"../create-center/create-center.module.ngfactory":["V4ay",4,5,6,7,8,9,12,13,15,17,16,14,21,20,19,18,22,26,28,30,27,37,50,65,66,70,614,40,184],"../fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",3,206],"../home/home.module.ngfactory":["tGFC",297],"../install/install-wizard/install-wizard.module.ngfactory":["MPfF",562],"../m365-apps/m365-apps.module.ngfactory":["S91J",3,5,6,7,567],"../modern-start/modern-start.module.ngfactory":["JOfQ",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,575],"../my-content/my-content.module.ngfactory":["+ilh",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,569],"../odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",3,578],"../odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",3,579],"../search-results/search-results.module.ngfactory":["+OTV",4,42,53,39,592],"../templates/templates.module.ngfactory":["+eAU",40,63,604],"../wac-content/wac-content.module.ngfactory":["005W",3,78],"../wac-start/wac-start.module.ngfactory":["DLYR",52,40,63,643],"./app-gallery-wrapper/app-gallery-wrapper.module.ngfactory":["xPmN",89],"./create-center/create-center.module.ngfactory":["V4ay",4,5,6,7,8,9,12,13,15,17,16,14,21,20,19,18,22,26,28,30,27,37,50,65,66,70,614,40,184],"./feed/feed.module.ngfactory":["BVus",3,5,6,7,202],"./fluid-unsupported-page/fluid-unsupported-page.module.ngfactory":["OZAL",3,206],"./install/install-wizard/install-wizard.module.ngfactory":["MPfF",562],"./m365-apps/m365-apps.module.ngfactory":["S91J",3,5,6,7,567],"./modern-start/modern-start.module.ngfactory":["JOfQ",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,575],"./my-content/my-content.module.ngfactory":["+ilh",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,569],"./odsp-start/onedrive-start/onedrive-start.module.ngfactory":["1TjK",3,578],"./odsp-start/sharepoint-start/sharepoint-start.module.ngfactory":["MxpO",3,579],"./officeforms/group-forms.module.ngfactory":["2wU0",34,582],"./officeforms/my-forms.module.ngfactory":["1YR/",3,34,583],"./search-results/search-results.module.ngfactory":["+OTV",4,42,53,39,592],"./templates/templates.module.ngfactory":["+eAU",40,63,604],"./wac-content/wac-content.module.ngfactory":["005W",3,78],"./wac-start/wac-start.module.ngfactory":["DLYR",52,40,63,643],"action-context-menu-react.ngfactory":["JJsp",5,6,7,10,11,13,15,17,14,21,20,19,18,22,28,27,25,29,31,41,58,64,65,610,85],"app-gallery-angular.ngfactory":["6nNX",87],"app-gallery-react.ngfactory":["Z6FN",4,0,5,6,7,10,11,13,15,17,14,21,20,19,18,22,26,28,30,27,25,31,36,41,58,66,67,612,88],"appbar.ngfactory":["fdWd",0,5,6,7,10,11,13,15,17,14,21,20,19,18,22,26,30,27,29,36,41,64,68,613,91],"auto-suggest.ngfactory":["tDVW",4,42,39,92],"banner.ngfactory":["QOI9",3,94],"bread-crumb.ngfactory":["PaRP",3,4,42,39,95],"calendar.ngfactory":["q48a",34,96],"confirmation-dialog-react.ngfactory":["uaMB",4,0,5,6,7,8,9,12,16,71,187],"context-menu.ngfactory":["aBzG",188],"create-menu.ngfactory":["EA+W",3,40,191],"create-on-home.ngfactory":["6+a9",4,5,6,7,70,616,186],"create-onenote-page-dialog-react.ngfactory":["uENI",4,0,13,15,17,21,20,19,18,22,26,28,30,617,189],"edgeworth.ngfactory":["MZ9O",3,52,72,193],"error-dialog-react.ngfactory":["Lpnb",4,8,9,12,16,71,197],"error-dialog.ngfactory":["oDVq",3,196],"ew-react.ngfactory":["cjNM",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,198],"feature-callout.ngfactory":["6lH3",200],"feature-tooltip-container.ngfactory":["Vbec",201],"feedback.ngfactory":["UHVx",3,203],"first-run.ngfactory":["AzcM",204],"fluent-theme-provider.ngfactory":["wMw5",5,6,7,295],"fluid-content.ngfactory":["4Tvn",3,4,5,8,9,12,16,24,35,55,51,73,620,62,205],"forms-group.ngfactory":["oA+b",34,296],"input-dialog.ngfactory":["4csf",3,52,560],"install.ngfactory":["T4V2",3,561],"learning-shelf-react.ngfactory":["AIbW",0,5,6,7,14,19,37,50,74,621,565],"left-nav-react.ngfactory":["46Tl",4,622,566],"mobile-app-banner.ngfactory":["1jme",3,572],"move-to-folder-control.ngfactory":["PsH8",573],"mru.ngfactory":["GHXR",34,574],"new-consumer-experience.ngfactory":["VHqc",3,576],"new-user-shelf.ngfactory":["hPLh",3,577],"places.ngfactory":["wK/J",3,34,585],"quick-access.ngfactory":["leWi",4,0,5,6,7,8,9,10,12,11,13,15,17,16,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,587],"recommended-react.ngfactory":["+luH",4,0,6,8,9,10,12,11,13,15,17,14,21,20,19,18,22,26,1,23,28,30,27,25,29,31,37,36,41,588],"search-preload.ngfactory":["01Cu",3,4,42,633,39,591],"share-control.ngfactory":["Uv8L",62,593],"side-popup-menu.ngfactory":["8KAq",3,596],"support-central-react.ngfactory":["tbFl",4,0,637,602],"task-module-dialog-react.ngfactory":["C0gm",4,0,5,6,7,32,33,35,45,638,603],"toast-container-react.ngfactory":["G/jE",0,5,6,7,10,11,640,606],"upload-button.ngfactory":["WbHY",3,607],"upload-dialog.ngfactory":["ynE4",3,608],"wac-content.ngfactory":["005W",3,78],"web-vitals.ngfactory":["/Fzb",645],"welcome-badge-react.ngfactory":["tO7o",3,0,5,6,7,10,11,15,20,74,642,644],"workspace-nav.ngfactory":["r3HZ",3,646]};function r(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(i)},r.id="kJkW",e.exports=r},kMgc:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("QjXU"),r=n("Epfv"),o=n("BMb5"),a=n("keVe"),s=function(){function e(e){this.windowService=e}return e.prototype.decode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.a)(e,this.windowService.nativeWindow)]}))}))},e.prototype.encode=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(r.b)(e,this.windowService.nativeWindow)]}))}))},e.ɵprov=a.cc({factory:function(){return new e(a.dc(o.b))},token:e,providedIn:"root"}),e}()},kVgv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},kaEK:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Open=2]="Open",e[e.Edit=3]="Edit",e[e.Comment=4]="Comment",e[e.Mention=5]="Mention",e[e.Share=6]="Share",e[e.Attachment=7]="Attachment",e[e.SnoozeExpiry=8]="SnoozeExpiry",e[e.Trending=9]="Trending",e[e.News=10]="News",e[e.Meeting=11]="Meeting",e[e.Video=12]="Video",e[e.MyAnalytics=13]="MyAnalytics",e[e.Task=14]="Task"}(i||(i={}))},kb6k:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("yOLj"),r=n("tyUq"),o=n("JYsJ"),a=n("amPu"),s=[0,11,22,33];function c(e,t,n,i){e&&(e.headers=Object(a.a)(t,e.headers,n),i&&i(e,t))}function l(e,t,n,a,l,u,d,p,f,h,m,b,g,v){return void 0===v&&(v=!1),new Promise((function(y,S){var w=d||"None",C="None"===w||"OfficeHome"===w&&!l,I=m||new Set;I.add(401);var T=function(e){var o=e.status,a=Number.NaN;!C&&I.has(o)?a=701:b&&b(o)&&(a=703),a!==Number.NaN&&(Object(i.a)(t,a,-1,"",v),Object(r.a)({eventName:n,fromCache:v,httpCode:a,latency:-1,error:""})),S({httpResponse:e})};if(p){var k=Object(o.a)(p);k&&(a.headers||(a.headers={}),a.headers["ohp-mock"]=k)}(C?Promise.resolve(void 0):u(w,!1,f)).then((function(o){if(!C){if(!o||!o.success){var l=o?o.error:"";return Object(i.a)(t,702,-1,"string"==typeof l?l:"",v),Object(r.a)({eventName:n,fromCache:v,httpCode:702,latency:-1,error:"string"==typeof l?l:""}),void S({httpResponse:{data:"CAP_Error"===l?l:null,status:702,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}c(a,o,h,g)}e(a).then(y,(function(t){!C&&I.has(t.status)?u(w,!0,f).then((function(n){n.success?(c(a,n,h,g),e(a).then(y,T)):T(t)})):b&&b(t.status)?function(t){setTimeout((function(){e(t).then(y,T)}),function(){var e=Math.floor(1e3*Math.random())%s.length;return s[e]}())}(a):S({httpResponse:t})}))}))}))}},kfAr:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("QjXU"),r=n("lrJm"),o=n("Ry9Z"),a=n("BaAg"),s=n("QOOv"),c=n("fKR7"),l=n("pd4Y"),u=n("TDzr"),d=n("n826"),p=n("Dpxn"),f=n("m+UP"),h=n("BJbw"),m=n("Brer"),b=n("4/We"),g=n("/I02"),v=n("cgnd"),y=n("keVe"),S=function(){function e(e,t,n,i,r,o,a,s,c,l,u,d,p){this.capabilitiesService=e,this.dateService=n,this.formsService=i,this.oneDriveGraphService=o,this.oneDriveService=a,this.vroomService=s,this.swayService=c,this.analyticsService=l,this.urlAuthenticatorService=u,this.globalErrorHandler=d,this.clientStartupConfigService=p,this.config=r.config,this.lifecycleEventsEnabled=this.config.isNewLifecycleEventEnabled,this.inflationsInProgress=new Array,this.inMockMode=t.sharedContext.inMockMode,this.thumbnailApiEnabled=this.capabilitiesService.capabilities.thumbnailEndpointEnabled}return e.prototype.inflateItem=function(t,n,i,r){var o=this;if(t.isLocal||e.disableInflation.has(t.fileType))return Promise.resolve(t);var a=this.fetchItemInflationData(t,t.fromCache?"cache-only":"network-first",n,i,r);return this.inflationsInProgress.push(a.then((function(e){return e}),(function(){return null}))),this.waitOnInflations().then((function(){return o.inflationsInProgress.splice(0)})),a},e.prototype.inflateThumbnails=function(t){var n=this;if(!e.thumbnailFileTypes.has(t.fileType)||t.thumbnails)return Promise.resolve(t);var i=t.fromCache?"cache-only":"network-first";return new Promise((function(e){if(t.fileType!==a.b.Sway)return t.fileType===a.b.Forms?(t.thumbnails={},void n.formsService.fetchFormThumbnail(t).then((function(){return e(t)}))):void(t.driveId&&t.docId?n.thumbnailApiEnabled&&t.format!==c.a.News&&t.format!==c.a.StreamsVideo?(n.populateThumbnailWithUrl(t,n.getThumbnailUrlForItem(t.driveId,t.docId)),e(t)):n.oneDriveGraphService.getThumbnailsForItem(t.driveId,t.docId,i,2).then((function(e){e&&e.value&&e.value.length&&n.populateThumbnails(t,e.value[0])})).catch((function(e){n.globalErrorHandler.handleError(e,"ZYaIo")})).then((function(){return e(t)})):n.chooseSharesCall(t,i,!0).then((function(e){e&&e.thumbnails&&e.thumbnails.length&&n.populateThumbnails(t,e.thumbnails[0])})).catch((function(e){n.globalErrorHandler.handleError(e,"hKd6C")})).then((function(){return e(t)})));n.fetchSwayThumbnail(t,i).then((function(){e(t)}))}))},e.prototype.waitOnInflations=function(){var e=this,t=this.inflationsInProgress.length;return Promise.all(this.inflationsInProgress).then((function(){if(!(e.inflationsInProgress.length<=t))return e.waitOnInflations()}))},e.prototype.fetchItemInflationData=function(e,t,n,r,o){var s=this;return e.format===c.a.Recommended||e.format===c.a.OfficeFeedDocument||e.format===c.a.News?this.fetchRecommendedItemInflationData(e,t):new Promise((function(l){var u=[],d=s.config.shareControlEnabled&&e.fileType!==a.b.Sway,p=s.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!s.capabilitiesService.capabilities.isEmbedMode;if(e.format===c.a.Trending&&e.driveId&&e.docId)s.tileViewEnabledForItem(e)&&n&&u.push(p?s.oneDriveService.getItemWithWacDataAndThumbnails(e,t,!1,2).then((function(t){s.populateMruItemFromDriveItem(e,t),s.thumbnailApiEnabled&&e.format!==c.a.News&&e.format!==c.a.StreamsVideo&&s.populateThumbnailWithUrl(e,s.getThumbnailUrlForItem(e.driveId,e.docId))})).catch((function(e){s.globalErrorHandler.handleError(e,"WF9ix")})):s.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&s.populateThumbnails(e,t.value[0])})).catch((function(e){s.globalErrorHandler.handleError(e,"iZlQF")}))),e.fileType!==a.b.OneNote&&u.push(s.setupActivity(e,t)),(d||s.lifecycleEventsEnabled)&&u.push(s.oneDriveGraphService.getItemWithIds(e.driveId,e.docId,"sharepointIds,createdDateTime",t).then((function(t){s.setupShareControl(e,t),s.setupLifecycleEvents(e,t)})).catch((function(e){s.globalErrorHandler.handleError(e,"wUAkv")})));else if((s.tileViewEnabledForItem(e)||s.config.activityEnabled||s.config.permissionsEnabled||d||p)&&m.a.sharesFileTypes.has(e.fileType)&&(1===e.sharingType||4===e.sharingType||0===e.sharingType)){var f=s.checkAllDataIsPresentForInflation(e);if(f){s.setupLifecycleEvents(e,null);var h=(e.fileType!==a.b.OneNote?s.setupActivity(e,t):Promise.resolve()).then((function(){return Promise.resolve()}));u.push(h),n&&e.driveId&&e.docId&&u.push(s.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t,2).then((function(t){t&&t.value&&t.value.length&&s.populateThumbnails(e,t.value[0])})).catch((function(e){s.globalErrorHandler.handleError(e,"iZlQF")})))}f||u.push(s.chooseSharesCall(e,t,n).then((function(n){return n?(s.populateMruItemFromDriveItem(e,n),s.thumbnailApiEnabled&&e.format!==c.a.News&&e.format!==c.a.StreamsVideo&&s.populateThumbnailWithUrl(e,s.getThumbnailUrlForItem(e.driveId,e.docId)),s.setupShareControl(e,n),s.setupLifecycleEvents(e,n),e.docId=n.id,n.parentReference&&(e.driveId=n.parentReference.driveId),e.fileType!==a.b.OneNote?s.setupActivity(e,t):Promise.resolve()):Promise.resolve()})).catch((function(e){s.globalErrorHandler.handleError(e,"EgyA3")})))}if(s.config.analyticsEnabled&&r){var b=s.analyticsService.getAnalytics(e,t).then((function(t){e.analytics=t})).catch((function(e){s.globalErrorHandler.handleError(e,"gBfeR")}));u.push(b)}u.push.apply(u,Object(i.__spread)(s.setupSwayData(e,t,n))),u.push.apply(u,Object(i.__spread)(s.setupFormData(e,n,o))),Promise.all(u).then((function(){e.inflationCompleted(),l(e)}),(function(){e.inflationCompleted(),l(e)}))}))},e.prototype.fetchRecommendedItemInflationData=function(e,t){var n=this;return new Promise((function(i){e.driveId&&e.docId?n.fetchAndPopulateWacDataAndThumbnails(e,t).catch((function(e){n.globalErrorHandler.handleError(e,"rm3f5")})).then((function(){return i(e)})):i(e)}))},e.prototype.getThumbnailUrlForItem=function(e,t){if(e&&t){var n="drives/"+encodeURIComponent(e)+"/items/"+encodeURIComponent(t)+"/thumbnails/0/c400x99999/content?prefer=noredirect,closestavailablesize,extendCacheMaxAge";return this.inMockMode?"thumbnails?itemUrl="+encodeURIComponent(n):n}},e.prototype.fetchAndPopulateWacDataAndThumbnails=function(e,t){var n=this;return this.capabilitiesService.wacHostEnabledForFileType(e.fileType)&&!this.inMockMode?this.oneDriveService.getItemWithWacDataAndThumbnails(e,t).then((function(t){n.populateMruItemFromDriveItem(e,t),n.thumbnailApiEnabled&&e.format!==c.a.News&&e.format!==c.a.StreamsVideo&&n.populateThumbnailWithUrl(e,n.getThumbnailUrlForItem(e.driveId,e.docId))})):this.thumbnailApiEnabled&&e.format!==c.a.News&&e.format!==c.a.StreamsVideo?(this.populateThumbnailWithUrl(e,this.getThumbnailUrlForItem(e.driveId,e.docId)),Promise.resolve()):(e.driveId&&e.docId?this.oneDriveGraphService.getThumbnailsForItem(e.driveId,e.docId,t).then((function(e){return null==e?void 0:e.value})):this.chooseSharesCall(e,t,!0).then((function(e){return null==e?void 0:e.thumbnails}))).then((function(t){(null==t?void 0:t.length)&&n.populateThumbnails(e,t[0])}))},e.prototype.populateMruItemFromDriveItem=function(e,t){!this.thumbnailApiEnabled&&t&&t.thumbnails&&t.thumbnails.length&&this.populateThumbnails(e,t.thumbnails[0]),t&&t.openWith&&t.openWith.wac&&this.populateWopiHostData(e,t)},e.prototype.populateThumbnails=function(e,t){e.thumbnails={small:t.small?t.small.url:null,medium:t.medium?t.medium.url:null,large:t.large?t.large.url:null,recommendedThumbnail:e.format!==c.a.Recommended&&e.format!==c.a.News&&e.format!==c.a.OfficeFeedDocument||!t.large?null:this.getRecommendedThumbnail(t.large.url)}},e.prototype.populateThumbnailWithUrl=function(e,t){t&&(e.thumbnails={large:t,recommendedThumbnail:t})},e.prototype.populateWopiHostData=function(e,t){e.wopiData=m.a.getWopiHostDataFromItem(t)},e.prototype.getRecommendedThumbnail=function(e){return e.replace(/&width=\d+/,"&width=350").replace(/&height=\d+/,"&height=400")},e.prototype.setupActivity=function(e,t){var n=this;return!this.config.activityEnabled||e.format===c.a.Recent&&this.config.mruActivityEnabled&&this.config.onlyMruActivityEnabled?Promise.resolve():this.vroomService.getDocumentActivity(e,t,2).then((function(t){return e.activities=t})).catch((function(e){n.globalErrorHandler.handleError(e,"SluwI")}))},e.prototype.chooseSharesCall=function(e,t,n){var i=e.canonicalUrl;if(!i.match(a.e)&&!i.match(a.d))return Promise.resolve(void 0);var r=this.capabilitiesService.wacHostEnabledForFileType(e.fileType);return n?this.oneDriveService.getSharedItemWithThumbnail(i,e.fileType,c.a[e.format],t,r,!1,2):this.oneDriveService.getSharedItemWithoutThumbnail(i,e.fileType,c.a[e.format],t,r,void 0,!1,2)},e.prototype.setupShareControl=function(e,t){t&&t.sharepointIds&&t.sharepointIds.siteUrl&&(e.sharepointIds.siteUrl=t.sharepointIds.siteUrl)},e.prototype.setupLifecycleEvents=function(e,t){if(this.lifecycleEventsEnabled&&!this.config.mruActivityEnabled){var n=e.createdDate;!n&&t&&t.createdDateTime&&(n=new Date(t.createdDateTime)),n&&(e.isNew=this.dateService.addHours(this.dateService.getCurrentDate(),-1*this.config.isNewTimeWindowInHours).getTime()<=n.getTime())}},e.prototype.setupFormData=function(e,t,n){var i=this,r=[];return e.fileType!==a.b.Forms||(n===a.b.Forms&&r.push(new Promise((function(t,n){var r=function(t){void 0===t&&(t=0),e.metaData||(e.metaData={}),e.metaData.formsResponseCount=t};e.ownerId===i.clientStartupConfigService.config.objectId||i.clientStartupConfigService.config.authType===v.a.MSA?i.formsService.getMyFormsResponses().then((function(n){var i=n.find((function(t){return t.id===e.serverDocId}));r(null==i?void 0:i.responseCount),t()})).catch(n):i.formsService.getForm(e.serverDocId,e.ownerType,e.ownerId).then((function(e){r(e?e.rowCount:null),t()})).catch(n)}))),this.tileViewEnabledForItem(e)&&t&&r.push(this.inflateThumbnails(e).then((function(){})))),r},e.prototype.setupSwayData=function(e,t,n){var i=[];return e.fileType!==a.b.Sway||(this.tileViewEnabledForItem(e)&&this.swayService.swayConfig.thumbnailsEnabled&&n&&i.push(this.fetchSwayThumbnail(e,t)),e.url=this.urlAuthenticatorService.appendPvrAndUpnAuthParams(e.url)),i},e.prototype.fetchSwayThumbnail=function(e,t){var n=this;return this.swayService.getThumbnail(e.url,e.thumbnailInfo?e.thumbnailInfo.thumbnailId:null,t).then((function(t){t&&(e.thumbnails={small:t,medium:t,large:t,recommendedThumbnail:t})})).catch((function(e){n.globalErrorHandler.handleError(e,"cm5b1")}))},e.prototype.checkAllDataIsPresentForInflation=function(e){return!!(e.sharepointIds&&e.createdDate&&e.driveId&&e.docId)},e.prototype.tileViewEnabledForItem=function(e){return this.config.tileViewEnabled||e.fileType===a.b.Forms},e.thumbnailFileTypes=new Set([a.b.PowerPoint,a.b.Visio,a.b.Word,a.b.Sway,a.b.Pdf,a.b.Forms,a.b.Stream]),e.disableInflation=new Set([a.b.Project,a.b.ProjectOperations,a.b.Portfolio]),e.ɵprov=y.cc({factory:function(){return new e(y.dc(b.a),y.dc(g.a),y.dc(l.a),y.dc(u.a),y.dc(s.a),y.dc(d.a),y.dc(p.a),y.dc(m.a),y.dc(f.a),y.dc(o.a),y.dc(h.a),y.dc(r.b),y.dc(v.b))},token:e,providedIn:"root"}),e}()},kpuN:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var i,r=n("QjXU"),o=n("2dXW");!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(i||(i={}));var a=function(e){function t(t,n,i){void 0===i&&(i=!0);var r=e.call(this,t)||this;return r.statusCode=n,r.shouldSwallow=i,r}return Object(r.__extends)(t,e),t}(Error),s=function(){function e(){}return e.prototype.init=function(e,t,n){this.errorHandler=e,this.defaultTokenFormat=t,this.defaultTokenSource=n,this._reauth=new o.a,this.reauthComplete=this._reauth.asObservable()},e.prototype.getDefaultExpiry=function(){return(new Date).getTime()+36e5},e.prototype.getAccessToken=function(e,t,n,i,o,a,s,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l=this;return Object(r.__generator)(this,(function(r){return e?[2,this.getAccessTokenResponse(e,t,n,i,o,a,s,c).then((function(e){return e&&e.token?e:{success:!1,token:"",format:l.defaultTokenFormat,source:l.defaultTokenSource,error:new Error("Empty token returned")}})).catch((function(e){return l.errorHandler.handleError(e,"SuNwZ"),{success:!1,token:"",format:l.defaultTokenFormat,source:l.defaultTokenSource,error:e}}))]:[2,Promise.resolve({success:!1,token:"",format:this.defaultTokenFormat,source:this.defaultTokenSource,error:new Error("invalid tokenConsumer")})]}))}))},e}()},kq70:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("QjXU"),r=(n("EUVs"),n("4/We"),function(e){function t(t,n){var i=e.call(this,(function(){return i.wacContentService.prebootDocument(i.itemInfo.item,i.itemInfo.wdOriginType)}))||this;return i.capabilitiesService=t,i.wacContentService=n,i}return Object(i.__extends)(t,e),t.prototype.enabled=function(){return this.capabilitiesService.wacHostEnabledForFileType(this.itemInfo.item.fileType)&&this.capabilitiesService.wacHostHoverPrebootEnabledForFileType(this.itemInfo.item.fileType)},t}(n("adME").a))},ksTh:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var i="client-request-id",r="x-correlationid",o="_Edgeworth"+window.ewWorkload+"LastSyncTimestamp",a="rs="},kvyl:function(e,t,n){"use strict";function i(e){for(var t=[],n=0;n<e.length;++n){var i=("00"+e[n].toString(16)).slice(-2);t.push(i)}return t.join("")}function r(e){void 0===e&&(e="");for(var t=[],n=0;n<e.length;)t.push(parseInt(e.substring(n,n+2),16)),n+=2;return new Uint8Array(t)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}))},kxm0:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var i=n("TfV2"),r=n("ZBSS"),o=n("zGJG"),a=n("uqr+"),s=n("dSKW"),c=n("uV9m");function l(e,t){var n;void 0===t&&(t=i.a.Security);var o,s={};s[r.v]="PageView",s[r.w]=null!==(n=e.eventName)&&void 0!==n?n:"",(Object(c.c)()||e.pageName)&&(o=p(f(s=d(s,e.pageName)))),s[Object(a.a)([r.R,r.K])]=e.isIntentional,Object(c.d)(o,s,t)}function u(e){return"PageView"===e[r.v]}function d(e,t){if(e[Object(a.a)([r.R,r.P])])return e;var n=t||Object(s.a)(Object(c.a)());return e[Object(a.a)([r.R,r.P])]=n,e[Object(a.a)([r.R,r.Q])]=Object(s.c)(n),e[Object(a.a)([r.R,r.O])]=Object(s.b)(n),e}function p(e){return["PageView",e].join(o.a)}function f(e){return e[Object(a.a)([r.R,r.P])]}},l98w:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var i=n("9h0M"),r=n("ro+v"),o=n("pIkI"),a=n("NLr0"),s=n("f0qX"),c=n("Qj1g"),l=n("Jcv4"),u=(n("lrJm"),n("3GGT")),d=n("Ft/N"),p=(n("JWB6"),"X-SW-OHP-UserCacheId"),f=function(){function e(e,t,n,i){this.serviceWorkerEnabled=e,this.serviceWorkerUserIdFactory=t,this.serviceWorkerStateService=n,this.globalErrorHandler=i}return e.prototype.intercept=function(e,t){var n=this;if(!this.serviceWorkerEnabled)return t.handle(e);if("Controlled"!==this.serviceWorkerStateService.currentState)return t.handle(e);var f=e.headers.get(d.a);if(!f)return t.handle(e);if("network-only"===f)return t.handle(e.clone({headers:e.headers.delete(d.a)}));if(e.reportProgress){var h="Cannot report progress for non-NetworkOnly requests";throw new i.f({error:h,statusText:h,status:u.a.NotImplemented,url:e.urlWithParams})}return Object(r.a)(this.serviceWorkerUserIdFactory()).pipe(Object(s.a)((function(t){return e.clone({headers:e.headers.append(p,t)})})),Object(c.a)((function(t){return n.globalErrorHandler.handleError(t,"j9XG4"),"cache-only"===f?Object(o.a)(new i.f({error:"Could not send CacheOnly request without a service worker user cache ID",status:u.a.Cancelled,statusText:"CacheOnly request cancelled"})):Object(a.a)(e.clone({headers:e.headers.delete(d.a)}))})),Object(l.a)((function(e){return t.handle(e)})))},e}()},lAHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("c/bn"),r=n("JYsJ");function o(e,t,n,o,a,s,c,l,u,d,p){var f=o+"/";return n.url.startsWith("http")&&!f.startsWith("http")&&(f=window.location.origin+"/"+f),0===n.url.lastIndexOf(f,0)&&function(e,t){e.headers||(e.headers={}),e.headers["X-OfficeHome-CorrelationId"]=t;var n=Object(r.a)("testtraffic");n&&(e.headers["X-OfficeHome-TestTraffic"]=n)}(n,a),Object(i.a)(e,t,n,s,c,l,u,d,p)}},lQwO:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){return function(){}}()},lUkk:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("TfV2"),r=n("ZBSS"),o=n("zGJG"),a=n("uqr+"),s=n("dSKW"),c=n("uV9m");function l(e,t){void 0===t&&(t=i.a.Security);var n=function(e){return["Action",e.result,e.target].join(o.a)}(e);Object(c.d)(n,function(e){var t,n,i,o,l={};if(l[r.v]="Action",l[Object(a.a)([r.a,r.e])]=null!==(t=e.type)&&void 0!==t?t:"Click",l[Object(a.a)([r.a,r.C])]=e.id,l[Object(a.a)([r.a,r.i])]=e.area,l[Object(a.a)([r.a,r.Y])]=null!==(n=e.subArea)&&void 0!==n?n:"Other",l[Object(a.a)([r.a,r.b])]=e.result,l[Object(a.a)([r.a,r.c])]=e.target,l[Object(a.a)([r.a,r.d])]=null!==(i=e.targetId)&&void 0!==i?i:"",l[r.w]=null!==(o=e.eventName)&&void 0!==o?o:"",Object(c.c)()){var u=Object(s.a)(Object(c.a)());l[Object(a.a)([r.a,r.P])]=u,l[Object(a.a)([r.a,r.Q])]=Object(s.c)(u),l[Object(a.a)([r.a,r.O])]=Object(s.b)(u)}return l}(e),t)}},laSs:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("TfV2"),r=n("ZBSS"),o=n("uqr+"),a=n("dSKW"),s=n("uV9m");function c(e,t){void 0===t&&(t=i.a.Security),Object(s.d)("Impression",function(e){var t,n,i,c,l={};if(l[r.v]="Impression",l[r.w]=e.eventName,l[Object(o.a)([r.D,r.i])]=e.area,l[Object(o.a)([r.D,r.Y])]=null!==(t=e.subArea)&&void 0!==t?t:"Other",l[Object(o.a)([r.D,r.A])]=null!==(n=e.fromCac                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  